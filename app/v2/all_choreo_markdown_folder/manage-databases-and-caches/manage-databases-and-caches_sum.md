 # Add Choreo-Managed Databases and Caches to the Marketplace

When you create a Choreo-managed database or cache, you can add it to the Marketplace, making it available for consumption through a connection.

!!! note 
     To add a Choreo-managed database or cache to the Marketplace, you must import at least one credential for it.

## Step 1: Import credentials

To import credentials, you can either use the default super admin credentials or the credentials you create using the super admin credentials. When you create a database or cache server, super admin credentials are generated by default. You can use these super admin credentials to create new user credentials. The steps to create new user credentials depend on the type of database or cache you are using.

You can use the imported credentials to create a connection. During connection setup, you must select credentials for each database from the list of available credentials.

To import credentials for a database, follow these steps:

1. Sign in to the [Choreo Console](https://console.choreo.dev/).
2. Go to the Choreo Console header and select your organization from the **Organization** list.
3. In the left navigation menu, click **Dependencies** and then click **Databases**.
4. Click on a required database to view its details.
5. Click the **Databases** tab.
6. Click to expand the database for which you want to import credentials, then click **Import Credentials**.
7. In the **Import Credentials** dialog, do one of the following depending on your requirements:

    - Select **Use Created Credentials** and specify the following:
         - A display name for the credentials.
         - The database credentials you created to use when setting up database connections in Choreo. 
         - The environment where you want to use the credentials. 
         
         The steps to create new user credentials depend on the type of database or cache you are using. In general, you must log in to your database server as the super admin using a command-line interface or a database management tool. Then, create new database users with the required permission levels.

    - Select **Use Super Admin Credentials** and specify the following:
         - A display name for the credentials. 
         - The environment where you want to use the credentials.

8. Click **Save**.

!!! tip 
     Choreo allows you to delete imported credentials to prevent their use when establishing new connections. However, deleting credentials will not affect any existing database connections that are already using them.

## Step 2: Add the database or cache to the Marketplace

- On the **Databases** tab, click **+Add to Marketplace** corresponding to the database you want to add. 

Once the database is added to the Marketplace, it can be consumed via a connection. For details on creating a connection to a Choreo-managed database, see [Create a connection to a database](../develop-components/sharing-and-reusing/create-a-connection.md).

!!! note 
     To remove a database or cache that you added to the Marketplace, click the corresponding **Remove from Marketplace**. This action prevents new connections to the removed database, but existing connections remain unaffected.

For details on using a database connection in your component, see [Use a Database Connection in Your Component](../develop-components/sharing-and-reusing/use-a-database-connection-in-your-component.md).


# Choreo-Managed Cache

Fully compatible with legacy Redis® OSS.

Choreo-Managed Cache provides fully-managed in-memory NoSQL databases on AWS, Azure, GCP, and Digital Ocean and can be used as a cache, database, streaming engine, or message broker.

## Create a Choreo-Managed Cache

Follow the steps below to create a Choreo-Managed Cache:

1. Sign in to the Choreo Console at [https://console.choreo.dev/](https://console.choreo.dev).
2. In the header, click the **Organization** list. This opens the organization home page.
3. In the left navigation menu, click **Dependencies** and then click **Databases**.
4. Click **+ Create** and select **Choreo-Managed Cache** as the data store type. Provide a display name for this server and follow the instructions.
5. Select a preferred cloud provider (AWS, Azure, GCP, or Digital Ocean).
    - The cloud provider provisions the compute and storage infrastructure for your data store.
    - The functionality remains the same across cloud providers, though service plans and costs may differ.
6. Select a region for your data store.
    - Available regions depend on the selected cloud provider. Choreo currently supports US and EU regions across all providers.
7. Select a service plan.
    - Service plans vary in terms of dedicated CPU, memory (RAM), and storage space allocated for your data store, as well as high-availability configurations for production use cases.
8. Click **Create**.

## Connect to your Choreo-Managed Cache

To connect to your Choreo-Managed Cache, follow these guidelines:

- Use any legacy Redis® OSS compatible driver (in any programming language) to connect to your Choreo-Managed Cache.
- You can find the connection parameters in the **Overview** section in the Choreo Console under the relevant database. Note that Choreo-Managed Cache enforces TLS.
- Choreo-Managed Cache instances accept traffic from the internet by default. You can restrict access to specific IP addresses and CIDR blocks under **Advanced Settings**.

## High availability and automatic backups

The high availability and the automatic backup retention periods for a Choreo-Managed Cache can vary as follows depending on the service plan you select. 

| Service plan | High availability                                                                                                  | Backup features                          | Backup history |
| ------------ | -------------------------------------------------------------------------------------------------------------------| ---------------------------------------- | -------------- |
| Hobbyist     | Single-node with limited availability.                                                                             | Single backup only for disaster recovery | None           |
| Startup      | Single-node with limited availability.                                                                             | Single backup only for disaster recovery | 1 day          |
| Business     | Two-node (primary + standby) with higher availability (automatic failover if the primary node fails).              | Automatic backups                        | 3 days         |
| Premium      | Three-node (primary + standby + standby) with highest availability (automatic failover if the primary node fails). | Automatic backups                        | 13 days        |

In general, service plans are recommended for production scenarios due to the following reasons:

- Provides another physical copy of the data in case of hardware, software, or network failures.
- Reduces the data loss window in disaster scenarios.
- Ensures quicker restoration with controlled failover in case of failures, as the standby is already installed and running.

### Automatic backups

- Choreo runs full backups daily to automatically backup Choreo-Managed Caches and has write-ahead logs (WAL) copied at 5-minute intervals or for every new file generated.
- Choreo encrypts all backups at rest.
- Choreo automatically handles outages and software failures by replacing broken nodes with new ones that resume correctly from the point of failure. The impact of a failure will depend on the number of available standby nodes in the data store.

### Failure recovery

- **Minor failures**: Choreo automatically handles minor failures such as service process crashes or temporary loss of network access in all plans without requiring significant changes to the service deployment. Choreo automatically restores the service to normal operation once it automatically restarts the crashed process or when it restores the network access.

- **Severe failures**: Failures such as losing a node entirely in case of hardware or severe software problems, require more drastic recovery measures. The monitoring infrastructure automatically detects a failing node when the node starts reporting issues in the self-diagnostics or when it stops communicating. In such cases, the monitoring infrastructure automatically schedules a new replacement node to be created.
     - In the event of a data store failover, the service URI of your service remains the same; only the IP address will change to point to the new primary node.
     - Hobbyist and Startup plans provide a single node, and in case of failure, a new node starts up, restores its state from the latest available backup, and resumes serving traffic.
     - As there is just a single/primary node, the caching service becomes unavailable for the duration of the restoration operation. Therefore, all write operations made since the last backup will be lost.

## Limitations

### Connection limits

The number of simultaneous connections in a Choreo-Managed Cache depends on the total available memory on the server instances.

You can use the following to estimate:

```
max_number_of_connections = 4 x m
```

Here, `m` represents the memory in megabytes, where at least 10,000 connections are available, even on the smallest servers.
For example, on a server with 4GB memory (4,096 MB), the simultaneous connections are:

```
4 x 4096 = 16384 // 16k connections
```

This number is estimated by the exact available memory so it can vary between different plans and cloud providers. To see the exact maximum connections allowed, use the \* redis-cli and info command as follows:

```
echo "info" | redis-cli -u REDIS_URI | grep maxclients
```

### Restricted commands

To maintain the stability and security of a managed environment, Choreo restricts certain commands on Choreo-Managed Cache services.

!!! note "Support for Lua scripts on Choreo-Managed Cache"
     - Choreo-Managed Cache has built-in support for running Lua scripts to perform various actions directly on the server. Scripting is typically controlled using the `EVAL`, `EVALSHA`, and `SCRIPT LOAD` commands.
     - For all newly-created cache instances, `EVAL`, `EVALSHA`, and `SCRIPT LOAD` commands are enabled by default.

The following commands are disabled on Choreo:

- `bgrewriteaof`: Initiates a background append-only file rewrite.
- `cluster`: Manages Caching cluster commands.
- `command`: Provides details about all Caching commands.
- `debug`: Contains sub-commands for debugging Caching.
- `failover`: Manages manual failover of a master to a replica.
- `migrate`: Atomically transfers a key from one caching instance to another.
- `role`: Returns the role of the instance in the context of replication.
- `slaveof`: Makes the server a replica of another instance, or promotes it as master.
- `acl`: Manages caching access control lists.
- `bgsave`: Creates a snapshot of the data set into a dump file.
- `config`: Alters the configuration of a running caching server.
- `lastsave`: Returns the UNIX timestamp of the last successful save to disk.
- `monitor`: Streams back every command processed by the Caching server.
- `replicaof`: Makes the server a replica of another instance.
- `save`: Synchronously saves the dataset to disk.
- `shutdown`: Synchronously saves the dataset to disk and then shuts down the server.

The following `eval` commands are also disabled:

- `eval`: Executes a Lua script server-side.
- `eval_ro`: Read-only variant of the eval command.
- `evalsha`: Executes a script cached on the server side by its SHA1 digest.
- `evalsha_ro`: Read-only variant of the evalsha command.
- `fcall`: Calls a Caching function.
- `fcall_ro`: Read-only variant of the fcall command.
- `function`: Manages Caching functions.
- `script`: Manages the script cache.


# Choreo-Managed Databases, Vector Databases, and Caches

Choreo allows you to create PostgreSQL and MySQL databases as well as Choreo-Managed Cache instances on all major cloud providers (AWS, Azure, GCP, and DigitalOcean) as fully Choreo-managed platform services.
These databases and caches can be seamlessly provisioned to offer persistence and caching capabilities for all your Choreo components. Choreo provides various service plans for each type, ranging from smaller instances for development purposes to production-grade databases with automatic backups and high-availability multi-nodes.

!!! info "Note"
     - The capability to create Choreo-managed databases, vector databases, and cache services is available only for paid Choreo users.
     - Billing for these services will be included in your Choreo subscription, with pricing varying based on the service plan of the resources you create. For more details, see [Choreo Platform Services Billing](../references/choreo-platform-services-billing-and-upgrades.md#platform-service-billing-information).

!!!Tip "Explore the free trial"
    Choreo provides a 7-day free trial for all database types on the 'Hobbyist' service plan, available to free-tier users.

## PostgreSQL on Choreo

PostgreSQL (also known as Postgres), is an open-source object-relational database management system. You can create PostgreSQL databases on Choreo as fully Choreo-managed, flexible SQL databases that are ideal for both structured and unstructured data. If you want to perform an efficient vector similarity search, you can create a PostgreSQL vector database.

- [Create a PostgreSQL database on Choreo](./choreo-managed-postgresql-databases.md)

## MySQL on Choreo

MySQL is a user-friendly, flexible, open-source relational database management system with a well-established history in the SQL database realm. Choreo allows you to swiftly create fully Choreo-managed MySQL databases, enabling rapid setup and utilization.

- [Create a MySQL database on Choreo](./choreo-managed-mysql-databases.md)

## Choreo-Managed Cache

A fully-managed cache compatible with legacy Redis® OSS. A versatile, in-memory NoSQL database that serves as a cache, database, streaming engine, and message broker. Choreo-managed Cache allows you to have fully-managed instances that can be swiftly provisioned and integrated into your applications within minutes.

- [Create a Choreo-managed Cache](./choreo-managed-caches.md)

<span style="font-size: 11px; color:gray;">
 PostgreSQL, MySQL, and Redis® are trademarks and property of their respective owners. All product and service names used in this documentation are for identification purposes only. 
</span>


# Choreo-managed MySQL Databases

MySQL on Choreo offers fully managed, flexible relational databases on AWS, Azure, GCP, and Digital Ocean.

## Create a Choreo-managed MySQL database

Follow the steps below to create a Choreo-managed MySQL database: 

1. From the environment list on the header, located next to the **Deployment Tracks** list, select your **Organization**.
2. In the left navigation menu, click **Dependencies** and then **Databases**.
3. Click **Create** and select **MySQL** as the database type. Provide a display name for this server and follow the instructions.
4. Select your preferred cloud provider from AWS, Azure, GCP, and Digital Ocean.
  - Choreo uses the cloud provider to provision the compute and storage infrastructure for your database.
  - There is no functional difference between databases created on different cloud providers, apart from changes to service plans (and associated costs). 
5. Choose the region for your database.
  - Available regions will depend on the selected cloud provider. Choreo currently supports US and EU regions across all providers.
6. Select the service plan.
  - Service plans vary in the dedicated CPU, memory (RAM), storage space allocated for your database, the backup retention periods, and high-availability configurations for production use cases.

## Connect to your Choreo-managed MySQL database

To connect to your Choreo-managed MySQL database, consider the following guidelines:

- You can use any MySQL driver, ORM, or supported generic SQL library (may depend on the programming language) to connect to the database.
- You can find the connection parameters in the **Overview** section in the Choreo Console under the relevant database.
- MySQL databases accept traffic from the internet by default. You can restrict access to specific IP addresses and CIDR blocks under **Advanced Settings**.

## High Availability and Automatic Backups

The high availability characteristics and the automatic backup retention periods for Choreo-managed MySQL databases vary based on your service plan as explained below:

| Service Plan | High Availability                                                  | Backup Retention Time |
|--------------|--------------------------------------------------------------------|-----------------------|
| Hobbyist     | Single-node with limited availability                              | None                  |
| Startup      | Single-node with limited availability                              | 2 days                |
| Business     | Two-node (primary + standby) with higher availability              | 14 days               |
| Premium      | Three-node (primary + standby + standby) with highest availability | 30 days               |

In general, we recommend service plans for production scenarios for multiple reasons:
- Provides another physical copy of the data in case of hardware, software, or network failures.
- Typically reduces the data loss window in disaster scenarios.
- Provides a quicker time to restore with a controlled failover in case of failures, as the standby is already installed and running.

### Automatic Backups

- Choreo runs full backups daily to automatically back up Choreo-managed MySQL databases and record binary logs continuously.
Choreo encrypts all backups at rest.

- Choreo automatically handles outages and software failures by replacing broken nodes with new ones that resume correctly from the point of failure. The impact of a failure will depend on the number of available standby nodes in the database.

## Connection Limits

The maximum number of simultaneous connections to MySQL databases is fixed for each service plan and depends on how much RAM your service plan offers.

!!! note
    An `extra_connection` with a value of `1` is added for system processes for all MySQL databases, regardless of the service plan.

### For plans under 4 GiB RAM

For plans under 4 GiB of RAM, the number of allowed connections is `75` per GiB:

```
max_connections = 75 x RAM + extra_connection
```

### For plans with over 4 GiB RAM:

For plans with 4 GiB or more RAM, the number of allowed connections is `100` per GiB:

```
max_connections = 100 x RAM + extra_connection
```


# Choreo-Managed PostgreSQL Databases and Vector Databases

PostgreSQL on Choreo offers fully Choreo-managed, efficient object-relational databases on AWS, Azure, GCP, and Digital Ocean. Additionally, Choreo allows you to create fully-managed PostgreSQL vector databases if you want to perform efficient vector similarity search.

## Create a Choreo-managed PostgreSQL database

Follow the steps below to create a Choreo-managed PostgreSQL database: 

1. Sign in to the Choreo Console at [https://console.choreo.dev/](https://console.choreo.dev/).
2. In the header, click the **Organization** list. This opens the organization home page.
3. In the left navigation menu, click **Dependencies** and then **Databases**.
4. Click **Create** and select **PostgreSQL** as the database type. Provide a display name for this server and follow the instructions.
5. Select your preferred cloud provider from AWS, Azure, GCP, or Digital Ocean.
    - The cloud provider is used to provision the compute and storage infrastructure for your database.
    - There is no functional difference between databases created on different cloud providers, apart from changes to service plans (and associated costs). 
6. Choose the region for your database.
   - Available regions will depend on the selected cloud provider. Choreo currently supports US and EU regions across all providers.
7. Select the service plan.
   - Service plans vary in the dedicated CPU, memory (RAM), storage space allocated for your database, the backup retention periods, and high-availability configurations for production use cases.

## Create a Choreo-managed PostgreSQL vector database

Follow the steps below to create a Choreo-managed PostgreSQL vector database: 

1. Sign in to the Choreo Console at [https://console.choreo.dev/](https://console.choreo.dev/).
2. In the header, click the **Organization** list. This opens the organization home page.
3. In the left navigation menu, click **Dependencies** and then **Vector Databases**.
4. Follow steps 4 onwards in the [Create a Choreo-managed PostgreSQL database](#create-a-choreo-managed-postgresql-database) section.

## Connecting to your Choreo-managed PostgreSQL database

To connect to your Choreo-managed PostgreSQL database, consider the following guidelines:

- You can use any PostgreSQL driver, ORM, or supported generic SQL library (may depend on the programming language) to connect to the database.
- The connection parameters can be found in the **Overview** section in the Choreo Console under the relevant database.
- PostgreSQL databases accept traffic from the internet by default. You can restrict access to specific IP addresses and CIDR blocks under **Advanced Settings**.


## High Availability and Automatic Backups

The high availability characteristics and the automatic backup retention periods for Choreo-managed PostgreSQL databases vary based on the selected service plan as shown below.

| Service Plan | High Availability                                                  | Backup Retention Time |
|--------------|--------------------------------------------------------------------|-----------------------|
| Hobbyist     | Single-node with limited availability                              | None                  |
| Startup      | Single-node with limited availability                              | 2 days                |
| Business     | Two-node (primary + standby) with higher availability              | 14 days               |
| Premium      | Three-node (primary + standby + standby) with highest availability | 30 days               |

Service plans with standby nodes are generally recommended for production scenarios for multiple reasons:
- Provides another physical copy of the data in case of hardware, software, or network failures.
- Typically reduces the data loss window in disaster scenarios.
- Provides a quicker time to restore with a controlled failover in case of failures, as the standby is already installed and running.

### Automatic Backups


- Choreo runs full backups daily to automatically back up Choreo-managed PostgreSQL databases and copies the write-ahead logs (WAL)  at 5-minute intervals or for every new file generated.
Choreo encrypts all backups at rest.

- Choreo automatically handles outages and software failures by replacing broken nodes with new ones that resume correctly from the point of failure. The impact of a failure will depend on the number of available standby nodes in the database.

### Failure Recovery

- **Minor failures**: Choreo automatically handles minor failures such as service process crashes or temporary loss of network access in all plans without requiring significant changes to the service deployment. Choreo automatically restores the service to normal operation once Choreo automatically restarts the crashed process or when Choreo restores the network access.

- **Severe failures**: To handle severe failures such as losing a node entirely in case of hardware or severe software problems, requires more drastic recovery measures. The monitoring infrastructure automatically detects a failing node, both when the node starts reporting issues in the self-diagnostics or when it stops communicating. In such cases, the monitoring infrastructure automatically schedules a new replacement node to be created.
> - In the event of database failover, the Service URI of your service remains the same; only the IP address will change to point to the new primary node.
> - Hobbyist and Startup plan provide a single node, and in case of failure, a new node starts up, restores its state from the latest available backup, and resumes serving traffic.
In this plan, as there is just a single node providing the service, the service will become unavailable for the duration of the restoration. In addition, any write operations made since the backup of the latest WAL file will be lost. Typically, this time window is limited to either five minutes of time or one WAL file.

## Connection limits

The following connection limits apply to Choreo-managed PostgreSQL databases based on the selected service plan.

| Service Plan               | Max Connections |
|----------------------------|-----------------|
| Hobbyist                   | 25              |
| Startup/Business/Premium-4 | 100             |
| Business-16                | 400             |
| Premium-8                  | 200             |


 # Add Choreo-Managed Databases and Caches to the Marketplace

When you create a Choreo-managed database or cache, you can add it to the Marketplace, making it available for consumption through a connection.

!!! note 
     To add a Choreo-managed database or cache to the Marketplace, you must import at least one credential for it.

## Step 1: Import credentials

To import credentials, you can either use the default super admin credentials or the credentials you create using the super admin credentials. When you create a database or cache server, super admin credentials are generated by default. You can use these super admin credentials to create new user credentials. The steps to create new user credentials depend on the type of database or cache you are using.

You can use the imported credentials to create a connection. During connection setup, you must select credentials for each database from the list of available credentials.

To import credentials for a database, follow these steps:

1. Sign in to the [Choreo Console](https://console.choreo.dev/).
2. Go to the Choreo Console header and select your organization from the **Organization** list.
3. In the left navigation menu, click **Dependencies** and then click **Databases**.
4. Click on a required database to view its details.
5. Click the **Databases** tab.
6. Click to expand the database for which you want to import credentials, then click **Import Credentials**.
7. In the **Import Credentials** dialog, do one of the following depending on your requirements:

    - Select **Use Created Credentials** and specify the following:
         - A display name for the credentials.
         - The database credentials you created to use when setting up database connections in Choreo. 
         - The environment where you want to use the credentials. 
         
         The steps to create new user credentials depend on the type of database or cache you are using. In general, you must log in to your database server as the super admin using a command-line interface or a database management tool. Then, create new database users with the required permission levels.

    - Select **Use Super Admin Credentials** and specify the following:
         - A display name for the credentials. 
         - The environment where you want to use the credentials.

8. Click **Save**.

!!! tip 
     Choreo allows you to delete imported credentials to prevent their use when establishing new connections. However, deleting credentials will not affect any existing database connections that are already using them.

## Step 2: Add the database or cache to the Marketplace

- On the **Databases** tab, click **+Add to Marketplace** corresponding to the database you want to add. 

Once the database is added to the Marketplace, it can be consumed via a connection. For details on creating a connection to a Choreo-managed database, see [Create a connection to a database](../develop-components/sharing-and-reusing/create-a-connection.md).

!!! note 
     To remove a database or cache that you added to the Marketplace, click the corresponding **Remove from Marketplace**. This action prevents new connections to the removed database, but existing connections remain unaffected.

For details on using a database connection in your component, see [Use a Database Connection in Your Component](../develop-components/sharing-and-reusing/use-a-database-connection-in-your-component.md).


# Choreo-Managed Cache

Fully compatible with legacy Redis® OSS.

Choreo-Managed Cache provides fully-managed in-memory NoSQL databases on AWS, Azure, GCP, and Digital Ocean and can be used as a cache, database, streaming engine, or message broker.

## Create a Choreo-Managed Cache

Follow the steps below to create a Choreo-Managed Cache:

1. Sign in to the Choreo Console at [https://console.choreo.dev/](https://console.choreo.dev).
2. In the header, click the **Organization** list. This opens the organization home page.
3. In the left navigation menu, click **Dependencies** and then click **Databases**.
4. Click **+ Create** and select **Choreo-Managed Cache** as the data store type. Provide a display name for this server and follow the instructions.
5. Select a preferred cloud provider (AWS, Azure, GCP, or Digital Ocean).
    - The cloud provider provisions the compute and storage infrastructure for your data store.
    - The functionality remains the same across cloud providers, though service plans and costs may differ.
6. Select a region for your data store.
    - Available regions depend on the selected cloud provider. Choreo currently supports US and EU regions across all providers.
7. Select a service plan.
    - Service plans vary in terms of dedicated CPU, memory (RAM), and storage space allocated for your data store, as well as high-availability configurations for production use cases.
8. Click **Create**.

## Connect to your Choreo-Managed Cache

To connect to your Choreo-Managed Cache, follow these guidelines:

- Use any legacy Redis® OSS compatible driver (in any programming language) to connect to your Choreo-Managed Cache.
- You can find the connection parameters in the **Overview** section in the Choreo Console under the relevant database. Note that Choreo-Managed Cache enforces TLS.
- Choreo-Managed Cache instances accept traffic from the internet by default. You can restrict access to specific IP addresses and CIDR blocks under **Advanced Settings**.

## High availability and automatic backups

The high availability and the automatic backup retention periods for a Choreo-Managed Cache can vary as follows depending on the service plan you select. 

| Service plan | High availability                                                                                                  | Backup features                          | Backup history |
| ------------ | -------------------------------------------------------------------------------------------------------------------| ---------------------------------------- | -------------- |
| Hobbyist     | Single-node with limited availability.                                                                             | Single backup only for disaster recovery | None           |
| Startup      | Single-node with limited availability.                                                                             | Single backup only for disaster recovery | 1 day          |
| Business     | Two-node (primary + standby) with higher availability (automatic failover if the primary node fails).              | Automatic backups                        | 3 days         |
| Premium      | Three-node (primary + standby + standby) with highest availability (automatic failover if the primary node fails). | Automatic backups                        | 13 days        |

In general, service plans are recommended for production scenarios due to the following reasons:

- Provides another physical copy of the data in case of hardware, software, or network failures.
- Reduces the data loss window in disaster scenarios.
- Ensures quicker restoration with controlled failover in case of failures, as the standby is already installed and running.

### Automatic backups

- Choreo runs full backups daily to automatically backup Choreo-Managed Caches and has write-ahead logs (WAL) copied at 5-minute intervals or for every new file generated.
- Choreo encrypts all backups at rest.
- Choreo automatically handles outages and software failures by replacing broken nodes with new ones that resume correctly from the point of failure. The impact of a failure will depend on the number of available standby nodes in the data store.

### Failure recovery

- **Minor failures**: Choreo automatically handles minor failures such as service process crashes or temporary loss of network access in all plans without requiring significant changes to the service deployment. Choreo automatically restores the service to normal operation once it automatically restarts the crashed process or when it restores the network access.

- **Severe failures**: Failures such as losing a node entirely in case of hardware or severe software problems, require more drastic recovery measures. The monitoring infrastructure automatically detects a failing node when the node starts reporting issues in the self-diagnostics or when it stops communicating. In such cases, the monitoring infrastructure automatically schedules a new replacement node to be created.
     - In the event of a data store failover, the service URI of your service remains the same; only the IP address will change to point to the new primary node.
     - Hobbyist and Startup plans provide a single node, and in case of failure, a new node starts up, restores its state from the latest available backup, and resumes serving traffic.
     - As there is just a single/primary node, the caching service becomes unavailable for the duration of the restoration operation. Therefore, all write operations made since the last backup will be lost.

## Limitations

### Connection limits

The number of simultaneous connections in a Choreo-Managed Cache depends on the total available memory on the server instances.

You can use the following to estimate:

```
max_number_of_connections = 4 x m
```

Here, `m` represents the memory in megabytes, where at least 10,000 connections are available, even on the smallest servers.
For example, on a server with 4GB memory (4,096 MB), the simultaneous connections are:

```
4 x 4096 = 16384 // 16k connections
```

This number is estimated by the exact available memory so it can vary between different plans and cloud providers. To see the exact maximum connections allowed, use the \* redis-cli and info command as follows:

```
echo "info" | redis-cli -u REDIS_URI | grep maxclients
```

### Restricted commands

To maintain the stability and security of a managed environment, Choreo restricts certain commands on Choreo-Managed Cache services.

!!! note "Support for Lua scripts on Choreo-Managed Cache"
     - Choreo-Managed Cache has built-in support for running Lua scripts to perform various actions directly on the server. Scripting is typically controlled using the `EVAL`, `EVALSHA`, and `SCRIPT LOAD` commands.
     - For all newly-created cache instances, `EVAL`, `EVALSHA`, and `SCRIPT LOAD` commands are enabled by default.

The following commands are disabled on Choreo:

- `bgrewriteaof`: Initiates a background append-only file rewrite.
- `cluster`: Manages Caching cluster commands.
- `command`: Provides details about all Caching commands.
- `debug`: Contains sub-commands for debugging Caching.
- `failover`: Manages manual failover of a master to a replica.
- `migrate`: Atomically transfers a key from one caching instance to another.
- `role`: Returns the role of the instance in the context of replication.
- `slaveof`: Makes the server a replica of another instance, or promotes it as master.
- `acl`: Manages caching access control lists.
- `bgsave`: Creates a snapshot of the data set into a dump file.
- `config`: Alters the configuration of a running caching server.
- `lastsave`: Returns the UNIX timestamp of the last successful save to disk.
- `monitor`: Streams back every command processed by the Caching server.
- `replicaof`: Makes the server a replica of another instance.
- `save`: Synchronously saves the dataset to disk.
- `shutdown`: Synchronously saves the dataset to disk and then shuts down the server.

The following `eval` commands are also disabled:

- `eval`: Executes a Lua script server-side.
- `eval_ro`: Read-only variant of the eval command.
- `evalsha`: Executes a script cached on the server side by its SHA1 digest.
- `evalsha_ro`: Read-only variant of the evalsha command.
- `fcall`: Calls a Caching function.
- `fcall_ro`: Read-only variant of the fcall command.
- `function`: Manages Caching functions.
- `script`: Manages the script cache.


# Choreo-Managed Databases, Vector Databases, and Caches

Choreo allows you to create PostgreSQL and MySQL databases as well as Choreo-Managed Cache instances on all major cloud providers (AWS, Azure, GCP, and DigitalOcean) as fully Choreo-managed platform services.
These databases and caches can be seamlessly provisioned to offer persistence and caching capabilities for all your Choreo components. Choreo provides various service plans for each type, ranging from smaller instances for development purposes to production-grade databases with automatic backups and high-availability multi-nodes.

!!! info "Note"
     - The capability to create Choreo-managed databases, vector databases, and cache services is available only for paid Choreo users.
     - Billing for these services will be included in your Choreo subscription, with pricing varying based on the service plan of the resources you create. For more details, see [Choreo Platform Services Billing](../references/choreo-platform-services-billing-and-upgrades.md#platform-service-billing-information).

!!!Tip "Explore the free trial"
    Choreo provides a 7-day free trial for all database types on the 'Hobbyist' service plan, available to free-tier users.

## PostgreSQL on Choreo

PostgreSQL (also known as Postgres), is an open-source object-relational database management system. You can create PostgreSQL databases on Choreo as fully Choreo-managed, flexible SQL databases that are ideal for both structured and unstructured data. If you want to perform an efficient vector similarity search, you can create a PostgreSQL vector database.

- [Create a PostgreSQL database on Choreo](./choreo-managed-postgresql-databases.md)

## MySQL on Choreo

MySQL is a user-friendly, flexible, open-source relational database management system with a well-established history in the SQL database realm. Choreo allows you to swiftly create fully Choreo-managed MySQL databases, enabling rapid setup and utilization.

- [Create a MySQL database on Choreo](./choreo-managed-mysql-databases.md)

## Choreo-Managed Cache

A fully-managed cache compatible with legacy Redis® OSS. A versatile, in-memory NoSQL database that serves as a cache, database, streaming engine, and message broker. Choreo-managed Cache allows you to have fully-managed instances that can be swiftly provisioned and integrated into your applications within minutes.

- [Create a Choreo-managed Cache](./choreo-managed-caches.md)

<span style="font-size: 11px; color:gray;">
 PostgreSQL, MySQL, and Redis® are trademarks and property of their respective owners. All product and service names used in this documentation are for identification purposes only. 
</span>


# Choreo-managed MySQL Databases

MySQL on Choreo offers fully managed, flexible relational databases on AWS, Azure, GCP, and Digital Ocean.

## Create a Choreo-managed MySQL database

Follow the steps below to create a Choreo-managed MySQL database: 

1. From the environment list on the header, located next to the **Deployment Tracks** list, select your **Organization**.
2. In the left navigation menu, click **Dependencies** and then **Databases**.
3. Click **Create** and select **MySQL** as the database type. Provide a display name for this server and follow the instructions.
4. Select your preferred cloud provider from AWS, Azure, GCP, and Digital Ocean.
  - Choreo uses the cloud provider to provision the compute and storage infrastructure for your database.
  - There is no functional difference between databases created on different cloud providers, apart from changes to service plans (and associated costs). 
5. Choose the region for your database.
  - Available regions will depend on the selected cloud provider. Choreo currently supports US and EU regions across all providers.
6. Select the service plan.
  - Service plans vary in the dedicated CPU, memory (RAM), storage space allocated for your database, the backup retention periods, and high-availability configurations for production use cases.

## Connect to your Choreo-managed MySQL database

To connect to your Choreo-managed MySQL database, consider the following guidelines:

- You can use any MySQL driver, ORM, or supported generic SQL library (may depend on the programming language) to connect to the database.
- You can find the connection parameters in the **Overview** section in the Choreo Console under the relevant database.
- MySQL databases accept traffic from the internet by default. You can restrict access to specific IP addresses and CIDR blocks under **Advanced Settings**.

## High Availability and Automatic Backups

The high availability characteristics and the automatic backup retention periods for Choreo-managed MySQL databases vary based on your service plan as explained below:

| Service Plan | High Availability                                                  | Backup Retention Time |
|--------------|--------------------------------------------------------------------|-----------------------|
| Hobbyist     | Single-node with limited availability                              | None                  |
| Startup      | Single-node with limited availability                              | 2 days                |
| Business     | Two-node (primary + standby) with higher availability              | 14 days               |
| Premium      | Three-node (primary + standby + standby) with highest availability | 30 days               |

In general, we recommend service plans for production scenarios for multiple reasons:
- Provides another physical copy of the data in case of hardware, software, or network failures.
- Typically reduces the data loss window in disaster scenarios.
- Provides a quicker time to restore with a controlled failover in case of failures, as the standby is already installed and running.

### Automatic Backups

- Choreo runs full backups daily to automatically back up Choreo-managed MySQL databases and record binary logs continuously.
Choreo encrypts all backups at rest.

- Choreo automatically handles outages and software failures by replacing broken nodes with new ones that resume correctly from the point of failure. The impact of a failure will depend on the number of available standby nodes in the database.

## Connection Limits

The maximum number of simultaneous connections to MySQL databases is fixed for each service plan and depends on how much RAM your service plan offers.

!!! note
    An `extra_connection` with a value of `1` is added for system processes for all MySQL databases, regardless of the service plan.

### For plans under 4 GiB RAM

For plans under 4 GiB of RAM, the number of allowed connections is `75` per GiB:

```
max_connections = 75 x RAM + extra_connection
```

### For plans with over 4 GiB RAM:

For plans with 4 GiB or more RAM, the number of allowed connections is `100` per GiB:

```
max_connections = 100 x RAM + extra_connection
```


# Choreo-Managed PostgreSQL Databases and Vector Databases

PostgreSQL on Choreo offers fully Choreo-managed, efficient object-relational databases on AWS, Azure, GCP, and Digital Ocean. Additionally, Choreo allows you to create fully-managed PostgreSQL vector databases if you want to perform efficient vector similarity search.

## Create a Choreo-managed PostgreSQL database

Follow the steps below to create a Choreo-managed PostgreSQL database: 

1. Sign in to the Choreo Console at [https://console.choreo.dev/](https://console.choreo.dev/).
2. In the header, click the **Organization** list. This opens the organization home page.
3. In the left navigation menu, click **Dependencies** and then **Databases**.
4. Click **Create** and select **PostgreSQL** as the database type. Provide a display name for this server and follow the instructions.
5. Select your preferred cloud provider from AWS, Azure, GCP, or Digital Ocean.
    - The cloud provider is used to provision the compute and storage infrastructure for your database.
    - There is no functional difference between databases created on different cloud providers, apart from changes to service plans (and associated costs). 
6. Choose the region for your database.
   - Available regions will depend on the selected cloud provider. Choreo currently supports US and EU regions across all providers.
7. Select the service plan.
   - Service plans vary in the dedicated CPU, memory (RAM), storage space allocated for your database, the backup retention periods, and high-availability configurations for production use cases.

## Create a Choreo-managed PostgreSQL vector database

Follow the steps below to create a Choreo-managed PostgreSQL vector database: 

1. Sign in to the Choreo Console at [https://console.choreo.dev/](https://console.choreo.dev/).
2. In the header, click the **Organization** list. This opens the organization home page.
3. In the left navigation menu, click **Dependencies** and then **Vector Databases**.
4. Follow steps 4 onwards in the [Create a Choreo-managed PostgreSQL database](#create-a-choreo-managed-postgresql-database) section.

## Connecting to your Choreo-managed PostgreSQL database

To connect to your Choreo-managed PostgreSQL database, consider the following guidelines:

- You can use any PostgreSQL driver, ORM, or supported generic SQL library (may depend on the programming language) to connect to the database.
- The connection parameters can be found in the **Overview** section in the Choreo Console under the relevant database.
- PostgreSQL databases accept traffic from the internet by default. You can restrict access to specific IP addresses and CIDR blocks under **Advanced Settings**.


## High Availability and Automatic Backups

The high availability characteristics and the automatic backup retention periods for Choreo-managed PostgreSQL databases vary based on the selected service plan as shown below.

| Service Plan | High Availability                                                  | Backup Retention Time |
|--------------|--------------------------------------------------------------------|-----------------------|
| Hobbyist     | Single-node with limited availability                              | None                  |
| Startup      | Single-node with limited availability                              | 2 days                |
| Business     | Two-node (primary + standby) with higher availability              | 14 days               |
| Premium      | Three-node (primary + standby + standby) with highest availability | 30 days               |

Service plans with standby nodes are generally recommended for production scenarios for multiple reasons:
- Provides another physical copy of the data in case of hardware, software, or network failures.
- Typically reduces the data loss window in disaster scenarios.
- Provides a quicker time to restore with a controlled failover in case of failures, as the standby is already installed and running.

### Automatic Backups


- Choreo runs full backups daily to automatically back up Choreo-managed PostgreSQL databases and copies the write-ahead logs (WAL)  at 5-minute intervals or for every new file generated.
Choreo encrypts all backups at rest.

- Choreo automatically handles outages and software failures by replacing broken nodes with new ones that resume correctly from the point of failure. The impact of a failure will depend on the number of available standby nodes in the database.

### Failure Recovery

- **Minor failures**: Choreo automatically handles minor failures such as service process crashes or temporary loss of network access in all plans without requiring significant changes to the service deployment. Choreo automatically restores the service to normal operation once Choreo automatically restarts the crashed process or when Choreo restores the network access.

- **Severe failures**: To handle severe failures such as losing a node entirely in case of hardware or severe software problems, requires more drastic recovery measures. The monitoring infrastructure automatically detects a failing node, both when the node starts reporting issues in the self-diagnostics or when it stops communicating. In such cases, the monitoring infrastructure automatically schedules a new replacement node to be created.
> - In the event of database failover, the Service URI of your service remains the same; only the IP address will change to point to the new primary node.
> - Hobbyist and Startup plan provide a single node, and in case of failure, a new node starts up, restores its state from the latest available backup, and resumes serving traffic.
In this plan, as there is just a single node providing the service, the service will become unavailable for the duration of the restoration. In addition, any write operations made since the backup of the latest WAL file will be lost. Typically, this time window is limited to either five minutes of time or one WAL file.

## Connection limits

The following connection limits apply to Choreo-managed PostgreSQL databases based on the selected service plan.

| Service Plan               | Max Connections |
|----------------------------|-----------------|
| Hobbyist                   | 25              |
| Startup/Business/Premium-4 | 100             |
| Business-16                | 400             |
| Premium-8                  | 200             |


 # Add Choreo-Managed Databases and Caches to the Marketplace

When you create a Choreo-managed database or cache, you can add it to the Marketplace, making it available for consumption through a connection.

!!! note 
     To add a Choreo-managed database or cache to the Marketplace, you must import at least one credential for it.

## Step 1: Import credentials

To import credentials, you can either use the default super admin credentials or the credentials you create using the super admin credentials. When you create a database or cache server, super admin credentials are generated by default. You can use these super admin credentials to create new user credentials. The steps to create new user credentials depend on the type of database or cache you are using.

You can use the imported credentials to create a connection. During connection setup, you must select credentials for each database from the list of available credentials.

To import credentials for a database, follow these steps:

1. Sign in to the [Choreo Console](https://console.choreo.dev/).
2. Go to the Choreo Console header and select your organization from the **Organization** list.
3. In the left navigation menu, click **Dependencies** and then click **Databases**.
4. Click on a required database to view its details.
5. Click the **Databases** tab.
6. Click to expand the database for which you want to import credentials, then click **Import Credentials**.
7. In the **Import Credentials** dialog, do one of the following depending on your requirements:

    - Select **Use Created Credentials** and specify the following:
         - A display name for the credentials.
         - The database credentials you created to use when setting up database connections in Choreo. 
         - The environment where you want to use the credentials. 
         
         The steps to create new user credentials depend on the type of database or cache you are using. In general, you must log in to your database server as the super admin using a command-line interface or a database management tool. Then, create new database users with the required permission levels.

    - Select **Use Super Admin Credentials** and specify the following:
         - A display name for the credentials. 
         - The environment where you want to use the credentials.

8. Click **Save**.

!!! tip 
     Choreo allows you to delete imported credentials to prevent their use when establishing new connections. However, deleting credentials will not affect any existing database connections that are already using them.

## Step 2: Add the database or cache to the Marketplace

- On the **Databases** tab, click **+Add to Marketplace** corresponding to the database you want to add. 

Once the database is added to the Marketplace, it can be consumed via a connection. For details on creating a connection to a Choreo-managed database, see [Create a connection to a database](../develop-components/sharing-and-reusing/create-a-connection.md).

!!! note 
     To remove a database or cache that you added to the Marketplace, click the corresponding **Remove from Marketplace**. This action prevents new connections to the removed database, but existing connections remain unaffected.

For details on using a database connection in your component, see [Use a Database Connection in Your Component](../develop-components/sharing-and-reusing/use-a-database-connection-in-your-component.md).


# Choreo-Managed Cache

Fully compatible with legacy Redis® OSS.

Choreo-Managed Cache provides fully-managed in-memory NoSQL databases on AWS, Azure, GCP, and Digital Ocean and can be used as a cache, database, streaming engine, or message broker.

## Create a Choreo-Managed Cache

Follow the steps below to create a Choreo-Managed Cache:

1. Sign in to the Choreo Console at [https://console.choreo.dev/](https://console.choreo.dev).
2. In the header, click the **Organization** list. This opens the organization home page.
3. In the left navigation menu, click **Dependencies** and then click **Databases**.
4. Click **+ Create** and select **Choreo-Managed Cache** as the data store type. Provide a display name for this server and follow the instructions.
5. Select a preferred cloud provider (AWS, Azure, GCP, or Digital Ocean).
    - The cloud provider provisions the compute and storage infrastructure for your data store.
    - The functionality remains the same across cloud providers, though service plans and costs may differ.
6. Select a region for your data store.
    - Available regions depend on the selected cloud provider. Choreo currently supports US and EU regions across all providers.
7. Select a service plan.
    - Service plans vary in terms of dedicated CPU, memory (RAM), and storage space allocated for your data store, as well as high-availability configurations for production use cases.
8. Click **Create**.

## Connect to your Choreo-Managed Cache

To connect to your Choreo-Managed Cache, follow these guidelines:

- Use any legacy Redis® OSS compatible driver (in any programming language) to connect to your Choreo-Managed Cache.
- You can find the connection parameters in the **Overview** section in the Choreo Console under the relevant database. Note that Choreo-Managed Cache enforces TLS.
- Choreo-Managed Cache instances accept traffic from the internet by default. You can restrict access to specific IP addresses and CIDR blocks under **Advanced Settings**.

## High availability and automatic backups

The high availability and the automatic backup retention periods for a Choreo-Managed Cache can vary as follows depending on the service plan you select. 

| Service plan | High availability                                                                                                  | Backup features                          | Backup history |
| ------------ | -------------------------------------------------------------------------------------------------------------------| ---------------------------------------- | -------------- |
| Hobbyist     | Single-node with limited availability.                                                                             | Single backup only for disaster recovery | None           |
| Startup      | Single-node with limited availability.                                                                             | Single backup only for disaster recovery | 1 day          |
| Business     | Two-node (primary + standby) with higher availability (automatic failover if the primary node fails).              | Automatic backups                        | 3 days         |
| Premium      | Three-node (primary + standby + standby) with highest availability (automatic failover if the primary node fails). | Automatic backups                        | 13 days        |

In general, service plans are recommended for production scenarios due to the following reasons:

- Provides another physical copy of the data in case of hardware, software, or network failures.
- Reduces the data loss window in disaster scenarios.
- Ensures quicker restoration with controlled failover in case of failures, as the standby is already installed and running.

### Automatic backups

- Choreo runs full backups daily to automatically backup Choreo-Managed Caches and has write-ahead logs (WAL) copied at 5-minute intervals or for every new file generated.
- Choreo encrypts all backups at rest.
- Choreo automatically handles outages and software failures by replacing broken nodes with new ones that resume correctly from the point of failure. The impact of a failure will depend on the number of available standby nodes in the data store.

### Failure recovery

- **Minor failures**: Choreo automatically handles minor failures such as service process crashes or temporary loss of network access in all plans without requiring significant changes to the service deployment. Choreo automatically restores the service to normal operation once it automatically restarts the crashed process or when it restores the network access.

- **Severe failures**: Failures such as losing a node entirely in case of hardware or severe software problems, require more drastic recovery measures. The monitoring infrastructure automatically detects a failing node when the node starts reporting issues in the self-diagnostics or when it stops communicating. In such cases, the monitoring infrastructure automatically schedules a new replacement node to be created.
     - In the event of a data store failover, the service URI of your service remains the same; only the IP address will change to point to the new primary node.
     - Hobbyist and Startup plans provide a single node, and in case of failure, a new node starts up, restores its state from the latest available backup, and resumes serving traffic.
     - As there is just a single/primary node, the caching service becomes unavailable for the duration of the restoration operation. Therefore, all write operations made since the last backup will be lost.

## Limitations

### Connection limits

The number of simultaneous connections in a Choreo-Managed Cache depends on the total available memory on the server instances.

You can use the following to estimate:

```
max_number_of_connections = 4 x m
```

Here, `m` represents the memory in megabytes, where at least 10,000 connections are available, even on the smallest servers.
For example, on a server with 4GB memory (4,096 MB), the simultaneous connections are:

```
4 x 4096 = 16384 // 16k connections
```

This number is estimated by the exact available memory so it can vary between different plans and cloud providers. To see the exact maximum connections allowed, use the \* redis-cli and info command as follows:

```
echo "info" | redis-cli -u REDIS_URI | grep maxclients
```

### Restricted commands

To maintain the stability and security of a managed environment, Choreo restricts certain commands on Choreo-Managed Cache services.

!!! note "Support for Lua scripts on Choreo-Managed Cache"
     - Choreo-Managed Cache has built-in support for running Lua scripts to perform various actions directly on the server. Scripting is typically controlled using the `EVAL`, `EVALSHA`, and `SCRIPT LOAD` commands.
     - For all newly-created cache instances, `EVAL`, `EVALSHA`, and `SCRIPT LOAD` commands are enabled by default.

The following commands are disabled on Choreo:

- `bgrewriteaof`: Initiates a background append-only file rewrite.
- `cluster`: Manages Caching cluster commands.
- `command`: Provides details about all Caching commands.
- `debug`: Contains sub-commands for debugging Caching.
- `failover`: Manages manual failover of a master to a replica.
- `migrate`: Atomically transfers a key from one caching instance to another.
- `role`: Returns the role of the instance in the context of replication.
- `slaveof`: Makes the server a replica of another instance, or promotes it as master.
- `acl`: Manages caching access control lists.
- `bgsave`: Creates a snapshot of the data set into a dump file.
- `config`: Alters the configuration of a running caching server.
- `lastsave`: Returns the UNIX timestamp of the last successful save to disk.
- `monitor`: Streams back every command processed by the Caching server.
- `replicaof`: Makes the server a replica of another instance.
- `save`: Synchronously saves the dataset to disk.
- `shutdown`: Synchronously saves the dataset to disk and then shuts down the server.

The following `eval` commands are also disabled:

- `eval`: Executes a Lua script server-side.
- `eval_ro`: Read-only variant of the eval command.
- `evalsha`: Executes a script cached on the server side by its SHA1 digest.
- `evalsha_ro`: Read-only variant of the evalsha command.
- `fcall`: Calls a Caching function.
- `fcall_ro`: Read-only variant of the fcall command.
- `function`: Manages Caching functions.
- `script`: Manages the script cache.


# Choreo-Managed Databases, Vector Databases, and Caches

Choreo allows you to create PostgreSQL and MySQL databases as well as Choreo-Managed Cache instances on all major cloud providers (AWS, Azure, GCP, and DigitalOcean) as fully Choreo-managed platform services.
These databases and caches can be seamlessly provisioned to offer persistence and caching capabilities for all your Choreo components. Choreo provides various service plans for each type, ranging from smaller instances for development purposes to production-grade databases with automatic backups and high-availability multi-nodes.

!!! info "Note"
     - The capability to create Choreo-managed databases, vector databases, and cache services is available only for paid Choreo users.
     - Billing for these services will be included in your Choreo subscription, with pricing varying based on the service plan of the resources you create. For more details, see [Choreo Platform Services Billing](../references/choreo-platform-services-billing-and-upgrades.md#platform-service-billing-information).

!!!Tip "Explore the free trial"
    Choreo provides a 7-day free trial for all database types on the 'Hobbyist' service plan, available to free-tier users.

## PostgreSQL on Choreo

PostgreSQL (also known as Postgres), is an open-source object-relational database management system. You can create PostgreSQL databases on Choreo as fully Choreo-managed, flexible SQL databases that are ideal for both structured and unstructured data. If you want to perform an efficient vector similarity search, you can create a PostgreSQL vector database.

- [Create a PostgreSQL database on Choreo](./choreo-managed-postgresql-databases.md)

## MySQL on Choreo

MySQL is a user-friendly, flexible, open-source relational database management system with a well-established history in the SQL database realm. Choreo allows you to swiftly create fully Choreo-managed MySQL databases, enabling rapid setup and utilization.

- [Create a MySQL database on Choreo](./choreo-managed-mysql-databases.md)

## Choreo-Managed Cache

A fully-managed cache compatible with legacy Redis® OSS. A versatile, in-memory NoSQL database that serves as a cache, database, streaming engine, and message broker. Choreo-managed Cache allows you to have fully-managed instances that can be swiftly provisioned and integrated into your applications within minutes.

- [Create a Choreo-managed Cache](./choreo-managed-caches.md)

<span style="font-size: 11px; color:gray;">
 PostgreSQL, MySQL, and Redis® are trademarks and property of their respective owners. All product and service names used in this documentation are for identification purposes only. 
</span>


# Choreo-managed MySQL Databases

MySQL on Choreo offers fully managed, flexible relational databases on AWS, Azure, GCP, and Digital Ocean.

## Create a Choreo-managed MySQL database

Follow the steps below to create a Choreo-managed MySQL database: 

1. From the environment list on the header, located next to the **Deployment Tracks** list, select your **Organization**.
2. In the left navigation menu, click **Dependencies** and then **Databases**.
3. Click **Create** and select **MySQL** as the database type. Provide a display name for this server and follow the instructions.
4. Select your preferred cloud provider from AWS, Azure, GCP, and Digital Ocean.
  - Choreo uses the cloud provider to provision the compute and storage infrastructure for your database.
  - There is no functional difference between databases created on different cloud providers, apart from changes to service plans (and associated costs). 
5. Choose the region for your database.
  - Available regions will depend on the selected cloud provider. Choreo currently supports US and EU regions across all providers.
6. Select the service plan.
  - Service plans vary in the dedicated CPU, memory (RAM), storage space allocated for your database, the backup retention periods, and high-availability configurations for production use cases.

## Connect to your Choreo-managed MySQL database

To connect to your Choreo-managed MySQL database, consider the following guidelines:

- You can use any MySQL driver, ORM, or supported generic SQL library (may depend on the programming language) to connect to the database.
- You can find the connection parameters in the **Overview** section in the Choreo Console under the relevant database.
- MySQL databases accept traffic from the internet by default. You can restrict access to specific IP addresses and CIDR blocks under **Advanced Settings**.

## High Availability and Automatic Backups

The high availability characteristics and the automatic backup retention periods for Choreo-managed MySQL databases vary based on your service plan as explained below:

| Service Plan | High Availability                                                  | Backup Retention Time |
|--------------|--------------------------------------------------------------------|-----------------------|
| Hobbyist     | Single-node with limited availability                              | None                  |
| Startup      | Single-node with limited availability                              | 2 days                |
| Business     | Two-node (primary + standby) with higher availability              | 14 days               |
| Premium      | Three-node (primary + standby + standby) with highest availability | 30 days               |

In general, we recommend service plans for production scenarios for multiple reasons:
- Provides another physical copy of the data in case of hardware, software, or network failures.
- Typically reduces the data loss window in disaster scenarios.
- Provides a quicker time to restore with a controlled failover in case of failures, as the standby is already installed and running.

### Automatic Backups

- Choreo runs full backups daily to automatically back up Choreo-managed MySQL databases and record binary logs continuously.
Choreo encrypts all backups at rest.

- Choreo automatically handles outages and software failures by replacing broken nodes with new ones that resume correctly from the point of failure. The impact of a failure will depend on the number of available standby nodes in the database.

## Connection Limits

The maximum number of simultaneous connections to MySQL databases is fixed for each service plan and depends on how much RAM your service plan offers.

!!! note
    An `extra_connection` with a value of `1` is added for system processes for all MySQL databases, regardless of the service plan.

### For plans under 4 GiB RAM

For plans under 4 GiB of RAM, the number of allowed connections is `75` per GiB:

```
max_connections = 75 x RAM + extra_connection
```

### For plans with over 4 GiB RAM:

For plans with 4 GiB or more RAM, the number of allowed connections is `100` per GiB:

```
max_connections = 100 x RAM + extra_connection
```


# Choreo-Managed PostgreSQL Databases and Vector Databases

PostgreSQL on Choreo offers fully Choreo-managed, efficient object-relational databases on AWS, Azure, GCP, and Digital Ocean. Additionally, Choreo allows you to create fully-managed PostgreSQL vector databases if you want to perform efficient vector similarity search.

## Create a Choreo-managed PostgreSQL database

Follow the steps below to create a Choreo-managed PostgreSQL database: 

1. Sign in to the Choreo Console at [https://console.choreo.dev/](https://console.choreo.dev/).
2. In the header, click the **Organization** list. This opens the organization home page.
3. In the left navigation menu, click **Dependencies** and then **Databases**.
4. Click **Create** and select **PostgreSQL** as the database type. Provide a display name for this server and follow the instructions.
5. Select your preferred cloud provider from AWS, Azure, GCP, or Digital Ocean.
    - The cloud provider is used to provision the compute and storage infrastructure for your database.
    - There is no functional difference between databases created on different cloud providers, apart from changes to service plans (and associated costs). 
6. Choose the region for your database.
   - Available regions will depend on the selected cloud provider. Choreo currently supports US and EU regions across all providers.
7. Select the service plan.
   - Service plans vary in the dedicated CPU, memory (RAM), storage space allocated for your database, the backup retention periods, and high-availability configurations for production use cases.

## Create a Choreo-managed PostgreSQL vector database

Follow the steps below to create a Choreo-managed PostgreSQL vector database: 

1. Sign in to the Choreo Console at [https://console.choreo.dev/](https://console.choreo.dev/).
2. In the header, click the **Organization** list. This opens the organization home page.
3. In the left navigation menu, click **Dependencies** and then **Vector Databases**.
4. Follow steps 4 onwards in the [Create a Choreo-managed PostgreSQL database](#create-a-choreo-managed-postgresql-database) section.

## Connecting to your Choreo-managed PostgreSQL database

To connect to your Choreo-managed PostgreSQL database, consider the following guidelines:

- You can use any PostgreSQL driver, ORM, or supported generic SQL library (may depend on the programming language) to connect to the database.
- The connection parameters can be found in the **Overview** section in the Choreo Console under the relevant database.
- PostgreSQL databases accept traffic from the internet by default. You can restrict access to specific IP addresses and CIDR blocks under **Advanced Settings**.


## High Availability and Automatic Backups

The high availability characteristics and the automatic backup retention periods for Choreo-managed PostgreSQL databases vary based on the selected service plan as shown below.

| Service Plan | High Availability                                                  | Backup Retention Time |
|--------------|--------------------------------------------------------------------|-----------------------|
| Hobbyist     | Single-node with limited availability                              | None                  |
| Startup      | Single-node with limited availability                              | 2 days                |
| Business     | Two-node (primary + standby) with higher availability              | 14 days               |
| Premium      | Three-node (primary + standby + standby) with highest availability | 30 days               |

Service plans with standby nodes are generally recommended for production scenarios for multiple reasons:
- Provides another physical copy of the data in case of hardware, software, or network failures.
- Typically reduces the data loss window in disaster scenarios.
- Provides a quicker time to restore with a controlled failover in case of failures, as the standby is already installed and running.

### Automatic Backups


- Choreo runs full backups daily to automatically back up Choreo-managed PostgreSQL databases and copies the write-ahead logs (WAL)  at 5-minute intervals or for every new file generated.
Choreo encrypts all backups at rest.

- Choreo automatically handles outages and software failures by replacing broken nodes with new ones that resume correctly from the point of failure. The impact of a failure will depend on the number of available standby nodes in the database.

### Failure Recovery

- **Minor failures**: Choreo automatically handles minor failures such as service process crashes or temporary loss of network access in all plans without requiring significant changes to the service deployment. Choreo automatically restores the service to normal operation once Choreo automatically restarts the crashed process or when Choreo restores the network access.

- **Severe failures**: To handle severe failures such as losing a node entirely in case of hardware or severe software problems, requires more drastic recovery measures. The monitoring infrastructure automatically detects a failing node, both when the node starts reporting issues in the self-diagnostics or when it stops communicating. In such cases, the monitoring infrastructure automatically schedules a new replacement node to be created.
> - In the event of database failover, the Service URI of your service remains the same; only the IP address will change to point to the new primary node.
> - Hobbyist and Startup plan provide a single node, and in case of failure, a new node starts up, restores its state from the latest available backup, and resumes serving traffic.
In this plan, as there is just a single node providing the service, the service will become unavailable for the duration of the restoration. In addition, any write operations made since the backup of the latest WAL file will be lost. Typically, this time window is limited to either five minutes of time or one WAL file.

## Connection limits

The following connection limits apply to Choreo-managed PostgreSQL databases based on the selected service plan.

| Service Plan               | Max Connections |
|----------------------------|-----------------|
| Hobbyist                   | 25              |
| Startup/Business/Premium-4 | 100             |
| Business-16                | 400             |
| Premium-8                  | 200             |


 # Add Choreo-Managed Databases and Caches to the Marketplace

When you create a Choreo-managed database or cache, you can add it to the Marketplace, making it available for consumption through a connection.

!!! note 
     To add a Choreo-managed database or cache to the Marketplace, you must import at least one credential for it.

## Step 1: Import credentials

To import credentials, you can either use the default super admin credentials or the credentials you create using the super admin credentials. When you create a database or cache server, super admin credentials are generated by default. You can use these super admin credentials to create new user credentials. The steps to create new user credentials depend on the type of database or cache you are using.

You can use the imported credentials to create a connection. During connection setup, you must select credentials for each database from the list of available credentials.

To import credentials for a database, follow these steps:

1. Sign in to the [Choreo Console](https://console.choreo.dev/).
2. Go to the Choreo Console header and select your organization from the **Organization** list.
3. In the left navigation menu, click **Dependencies** and then click **Databases**.
4. Click on a required database to view its details.
5. Click the **Databases** tab.
6. Click to expand the database for which you want to import credentials, then click **Import Credentials**.
7. In the **Import Credentials** dialog, do one of the following depending on your requirements:

    - Select **Use Created Credentials** and specify the following:
         - A display name for the credentials.
         - The database credentials you created to use when setting up database connections in Choreo. 
         - The environment where you want to use the credentials. 
         
         The steps to create new user credentials depend on the type of database or cache you are using. In general, you must log in to your database server as the super admin using a command-line interface or a database management tool. Then, create new database users with the required permission levels.

    - Select **Use Super Admin Credentials** and specify the following:
         - A display name for the credentials. 
         - The environment where you want to use the credentials.

8. Click **Save**.

!!! tip 
     Choreo allows you to delete imported credentials to prevent their use when establishing new connections. However, deleting credentials will not affect any existing database connections that are already using them.

## Step 2: Add the database or cache to the Marketplace

- On the **Databases** tab, click **+Add to Marketplace** corresponding to the database you want to add. 

Once the database is added to the Marketplace, it can be consumed via a connection. For details on creating a connection to a Choreo-managed database, see [Create a connection to a database](../develop-components/sharing-and-reusing/create-a-connection.md).

!!! note 
     To remove a database or cache that you added to the Marketplace, click the corresponding **Remove from Marketplace**. This action prevents new connections to the removed database, but existing connections remain unaffected.

For details on using a database connection in your component, see [Use a Database Connection in Your Component](../develop-components/sharing-and-reusing/use-a-database-connection-in-your-component.md).


# Choreo-Managed Cache

Fully compatible with legacy Redis® OSS.

Choreo-Managed Cache provides fully-managed in-memory NoSQL databases on AWS, Azure, GCP, and Digital Ocean and can be used as a cache, database, streaming engine, or message broker.

## Create a Choreo-Managed Cache

Follow the steps below to create a Choreo-Managed Cache:

1. Sign in to the Choreo Console at [https://console.choreo.dev/](https://console.choreo.dev).
2. In the header, click the **Organization** list. This opens the organization home page.
3. In the left navigation menu, click **Dependencies** and then click **Databases**.
4. Click **+ Create** and select **Choreo-Managed Cache** as the data store type. Provide a display name for this server and follow the instructions.
5. Select a preferred cloud provider (AWS, Azure, GCP, or Digital Ocean).
    - The cloud provider provisions the compute and storage infrastructure for your data store.
    - The functionality remains the same across cloud providers, though service plans and costs may differ.
6. Select a region for your data store.
    - Available regions depend on the selected cloud provider. Choreo currently supports US and EU regions across all providers.
7. Select a service plan.
    - Service plans vary in terms of dedicated CPU, memory (RAM), and storage space allocated for your data store, as well as high-availability configurations for production use cases.
8. Click **Create**.

## Connect to your Choreo-Managed Cache

To connect to your Choreo-Managed Cache, follow these guidelines:

- Use any legacy Redis® OSS compatible driver (in any programming language) to connect to your Choreo-Managed Cache.
- You can find the connection parameters in the **Overview** section in the Choreo Console under the relevant database. Note that Choreo-Managed Cache enforces TLS.
- Choreo-Managed Cache instances accept traffic from the internet by default. You can restrict access to specific IP addresses and CIDR blocks under **Advanced Settings**.

## High availability and automatic backups

The high availability and the automatic backup retention periods for a Choreo-Managed Cache can vary as follows depending on the service plan you select. 

| Service plan | High availability                                                                                                  | Backup features                          | Backup history |
| ------------ | -------------------------------------------------------------------------------------------------------------------| ---------------------------------------- | -------------- |
| Hobbyist     | Single-node with limited availability.                                                                             | Single backup only for disaster recovery | None           |
| Startup      | Single-node with limited availability.                                                                             | Single backup only for disaster recovery | 1 day          |
| Business     | Two-node (primary + standby) with higher availability (automatic failover if the primary node fails).              | Automatic backups                        | 3 days         |
| Premium      | Three-node (primary + standby + standby) with highest availability (automatic failover if the primary node fails). | Automatic backups                        | 13 days        |

In general, service plans are recommended for production scenarios due to the following reasons:

- Provides another physical copy of the data in case of hardware, software, or network failures.
- Reduces the data loss window in disaster scenarios.
- Ensures quicker restoration with controlled failover in case of failures, as the standby is already installed and running.

### Automatic backups

- Choreo runs full backups daily to automatically backup Choreo-Managed Caches and has write-ahead logs (WAL) copied at 5-minute intervals or for every new file generated.
- Choreo encrypts all backups at rest.
- Choreo automatically handles outages and software failures by replacing broken nodes with new ones that resume correctly from the point of failure. The impact of a failure will depend on the number of available standby nodes in the data store.

### Failure recovery

- **Minor failures**: Choreo automatically handles minor failures such as service process crashes or temporary loss of network access in all plans without requiring significant changes to the service deployment. Choreo automatically restores the service to normal operation once it automatically restarts the crashed process or when it restores the network access.

- **Severe failures**: Failures such as losing a node entirely in case of hardware or severe software problems, require more drastic recovery measures. The monitoring infrastructure automatically detects a failing node when the node starts reporting issues in the self-diagnostics or when it stops communicating. In such cases, the monitoring infrastructure automatically schedules a new replacement node to be created.
     - In the event of a data store failover, the service URI of your service remains the same; only the IP address will change to point to the new primary node.
     - Hobbyist and Startup plans provide a single node, and in case of failure, a new node starts up, restores its state from the latest available backup, and resumes serving traffic.
     - As there is just a single/primary node, the caching service becomes unavailable for the duration of the restoration operation. Therefore, all write operations made since the last backup will be lost.

## Limitations

### Connection limits

The number of simultaneous connections in a Choreo-Managed Cache depends on the total available memory on the server instances.

You can use the following to estimate:

```
max_number_of_connections = 4 x m
```

Here, `m` represents the memory in megabytes, where at least 10,000 connections are available, even on the smallest servers.
For example, on a server with 4GB memory (4,096 MB), the simultaneous connections are:

```
4 x 4096 = 16384 // 16k connections
```

This number is estimated by the exact available memory so it can vary between different plans and cloud providers. To see the exact maximum connections allowed, use the \* redis-cli and info command as follows:

```
echo "info" | redis-cli -u REDIS_URI | grep maxclients
```

### Restricted commands

To maintain the stability and security of a managed environment, Choreo restricts certain commands on Choreo-Managed Cache services.

!!! note "Support for Lua scripts on Choreo-Managed Cache"
     - Choreo-Managed Cache has built-in support for running Lua scripts to perform various actions directly on the server. Scripting is typically controlled using the `EVAL`, `EVALSHA`, and `SCRIPT LOAD` commands.
     - For all newly-created cache instances, `EVAL`, `EVALSHA`, and `SCRIPT LOAD` commands are enabled by default.

The following commands are disabled on Choreo:

- `bgrewriteaof`: Initiates a background append-only file rewrite.
- `cluster`: Manages Caching cluster commands.
- `command`: Provides details about all Caching commands.
- `debug`: Contains sub-commands for debugging Caching.
- `failover`: Manages manual failover of a master to a replica.
- `migrate`: Atomically transfers a key from one caching instance to another.
- `role`: Returns the role of the instance in the context of replication.
- `slaveof`: Makes the server a replica of another instance, or promotes it as master.
- `acl`: Manages caching access control lists.
- `bgsave`: Creates a snapshot of the data set into a dump file.
- `config`: Alters the configuration of a running caching server.
- `lastsave`: Returns the UNIX timestamp of the last successful save to disk.
- `monitor`: Streams back every command processed by the Caching server.
- `replicaof`: Makes the server a replica of another instance.
- `save`: Synchronously saves the dataset to disk.
- `shutdown`: Synchronously saves the dataset to disk and then shuts down the server.

The following `eval` commands are also disabled:

- `eval`: Executes a Lua script server-side.
- `eval_ro`: Read-only variant of the eval command.
- `evalsha`: Executes a script cached on the server side by its SHA1 digest.
- `evalsha_ro`: Read-only variant of the evalsha command.
- `fcall`: Calls a Caching function.
- `fcall_ro`: Read-only variant of the fcall command.
- `function`: Manages Caching functions.
- `script`: Manages the script cache.


# Choreo-Managed Databases, Vector Databases, and Caches

Choreo allows you to create PostgreSQL and MySQL databases as well as Choreo-Managed Cache instances on all major cloud providers (AWS, Azure, GCP, and DigitalOcean) as fully Choreo-managed platform services.
These databases and caches can be seamlessly provisioned to offer persistence and caching capabilities for all your Choreo components. Choreo provides various service plans for each type, ranging from smaller instances for development purposes to production-grade databases with automatic backups and high-availability multi-nodes.

!!! info "Note"
     - The capability to create Choreo-managed databases, vector databases, and cache services is available only for paid Choreo users.
     - Billing for these services will be included in your Choreo subscription, with pricing varying based on the service plan of the resources you create. For more details, see [Choreo Platform Services Billing](../references/choreo-platform-services-billing-and-upgrades.md#platform-service-billing-information).

!!!Tip "Explore the free trial"
    Choreo provides a 7-day free trial for all database types on the 'Hobbyist' service plan, available to free-tier users.

## PostgreSQL on Choreo

PostgreSQL (also known as Postgres), is an open-source object-relational database management system. You can create PostgreSQL databases on Choreo as fully Choreo-managed, flexible SQL databases that are ideal for both structured and unstructured data. If you want to perform an efficient vector similarity search, you can create a PostgreSQL vector database.

- [Create a PostgreSQL database on Choreo](./choreo-managed-postgresql-databases.md)

## MySQL on Choreo

MySQL is a user-friendly, flexible, open-source relational database management system with a well-established history in the SQL database realm. Choreo allows you to swiftly create fully Choreo-managed MySQL databases, enabling rapid setup and utilization.

- [Create a MySQL database on Choreo](./choreo-managed-mysql-databases.md)

## Choreo-Managed Cache

A fully-managed cache compatible with legacy Redis® OSS. A versatile, in-memory NoSQL database that serves as a cache, database, streaming engine, and message broker. Choreo-managed Cache allows you to have fully-managed instances that can be swiftly provisioned and integrated into your applications within minutes.

- [Create a Choreo-managed Cache](./choreo-managed-caches.md)

<span style="font-size: 11px; color:gray;">
 PostgreSQL, MySQL, and Redis® are trademarks and property of their respective owners. All product and service names used in this documentation are for identification purposes only. 
</span>


# Choreo-managed MySQL Databases

MySQL on Choreo offers fully managed, flexible relational databases on AWS, Azure, GCP, and Digital Ocean.

## Create a Choreo-managed MySQL database

Follow the steps below to create a Choreo-managed MySQL database: 

1. From the environment list on the header, located next to the **Deployment Tracks** list, select your **Organization**.
2. In the left navigation menu, click **Dependencies** and then **Databases**.
3. Click **Create** and select **MySQL** as the database type. Provide a display name for this server and follow the instructions.
4. Select your preferred cloud provider from AWS, Azure, GCP, and Digital Ocean.
  - Choreo uses the cloud provider to provision the compute and storage infrastructure for your database.
  - There is no functional difference between databases created on different cloud providers, apart from changes to service plans (and associated costs). 
5. Choose the region for your database.
  - Available regions will depend on the selected cloud provider. Choreo currently supports US and EU regions across all providers.
6. Select the service plan.
  - Service plans vary in the dedicated CPU, memory (RAM), storage space allocated for your database, the backup retention periods, and high-availability configurations for production use cases.

## Connect to your Choreo-managed MySQL database

To connect to your Choreo-managed MySQL database, consider the following guidelines:

- You can use any MySQL driver, ORM, or supported generic SQL library (may depend on the programming language) to connect to the database.
- You can find the connection parameters in the **Overview** section in the Choreo Console under the relevant database.
- MySQL databases accept traffic from the internet by default. You can restrict access to specific IP addresses and CIDR blocks under **Advanced Settings**.

## High Availability and Automatic Backups

The high availability characteristics and the automatic backup retention periods for Choreo-managed MySQL databases vary based on your service plan as explained below:

| Service Plan | High Availability                                                  | Backup Retention Time |
|--------------|--------------------------------------------------------------------|-----------------------|
| Hobbyist     | Single-node with limited availability                              | None                  |
| Startup      | Single-node with limited availability                              | 2 days                |
| Business     | Two-node (primary + standby) with higher availability              | 14 days               |
| Premium      | Three-node (primary + standby + standby) with highest availability | 30 days               |

In general, we recommend service plans for production scenarios for multiple reasons:
- Provides another physical copy of the data in case of hardware, software, or network failures.
- Typically reduces the data loss window in disaster scenarios.
- Provides a quicker time to restore with a controlled failover in case of failures, as the standby is already installed and running.

### Automatic Backups

- Choreo runs full backups daily to automatically back up Choreo-managed MySQL databases and record binary logs continuously.
Choreo encrypts all backups at rest.

- Choreo automatically handles outages and software failures by replacing broken nodes with new ones that resume correctly from the point of failure. The impact of a failure will depend on the number of available standby nodes in the database.

## Connection Limits

The maximum number of simultaneous connections to MySQL databases is fixed for each service plan and depends on how much RAM your service plan offers.

!!! note
    An `extra_connection` with a value of `1` is added for system processes for all MySQL databases, regardless of the service plan.

### For plans under 4 GiB RAM

For plans under 4 GiB of RAM, the number of allowed connections is `75` per GiB:

```
max_connections = 75 x RAM + extra_connection
```

### For plans with over 4 GiB RAM:

For plans with 4 GiB or more RAM, the number of allowed connections is `100` per GiB:

```
max_connections = 100 x RAM + extra_connection
```


# Choreo-Managed PostgreSQL Databases and Vector Databases

PostgreSQL on Choreo offers fully Choreo-managed, efficient object-relational databases on AWS, Azure, GCP, and Digital Ocean. Additionally, Choreo allows you to create fully-managed PostgreSQL vector databases if you want to perform efficient vector similarity search.

## Create a Choreo-managed PostgreSQL database

Follow the steps below to create a Choreo-managed PostgreSQL database: 

1. Sign in to the Choreo Console at [https://console.choreo.dev/](https://console.choreo.dev/).
2. In the header, click the **Organization** list. This opens the organization home page.
3. In the left navigation menu, click **Dependencies** and then **Databases**.
4. Click **Create** and select **PostgreSQL** as the database type. Provide a display name for this server and follow the instructions.
5. Select your preferred cloud provider from AWS, Azure, GCP, or Digital Ocean.
    - The cloud provider is used to provision the compute and storage infrastructure for your database.
    - There is no functional difference between databases created on different cloud providers, apart from changes to service plans (and associated costs). 
6. Choose the region for your database.
   - Available regions will depend on the selected cloud provider. Choreo currently supports US and EU regions across all providers.
7. Select the service plan.
   - Service plans vary in the dedicated CPU, memory (RAM), storage space allocated for your database, the backup retention periods, and high-availability configurations for production use cases.

## Create a Choreo-managed PostgreSQL vector database

Follow the steps below to create a Choreo-managed PostgreSQL vector database: 

1. Sign in to the Choreo Console at [https://console.choreo.dev/](https://console.choreo.dev/).
2. In the header, click the **Organization** list. This opens the organization home page.
3. In the left navigation menu, click **Dependencies** and then **Vector Databases**.
4. Follow steps 4 onwards in the [Create a Choreo-managed PostgreSQL database](#create-a-choreo-managed-postgresql-database) section.

## Connecting to your Choreo-managed PostgreSQL database

To connect to your Choreo-managed PostgreSQL database, consider the following guidelines:

- You can use any PostgreSQL driver, ORM, or supported generic SQL library (may depend on the programming language) to connect to the database.
- The connection parameters can be found in the **Overview** section in the Choreo Console under the relevant database.
- PostgreSQL databases accept traffic from the internet by default. You can restrict access to specific IP addresses and CIDR blocks under **Advanced Settings**.


## High Availability and Automatic Backups

The high availability characteristics and the automatic backup retention periods for Choreo-managed PostgreSQL databases vary based on the selected service plan as shown below.

| Service Plan | High Availability                                                  | Backup Retention Time |
|--------------|--------------------------------------------------------------------|-----------------------|
| Hobbyist     | Single-node with limited availability                              | None                  |
| Startup      | Single-node with limited availability                              | 2 days                |
| Business     | Two-node (primary + standby) with higher availability              | 14 days               |
| Premium      | Three-node (primary + standby + standby) with highest availability | 30 days               |

Service plans with standby nodes are generally recommended for production scenarios for multiple reasons:
- Provides another physical copy of the data in case of hardware, software, or network failures.
- Typically reduces the data loss window in disaster scenarios.
- Provides a quicker time to restore with a controlled failover in case of failures, as the standby is already installed and running.

### Automatic Backups


- Choreo runs full backups daily to automatically back up Choreo-managed PostgreSQL databases and copies the write-ahead logs (WAL)  at 5-minute intervals or for every new file generated.
Choreo encrypts all backups at rest.

- Choreo automatically handles outages and software failures by replacing broken nodes with new ones that resume correctly from the point of failure. The impact of a failure will depend on the number of available standby nodes in the database.

### Failure Recovery

- **Minor failures**: Choreo automatically handles minor failures such as service process crashes or temporary loss of network access in all plans without requiring significant changes to the service deployment. Choreo automatically restores the service to normal operation once Choreo automatically restarts the crashed process or when Choreo restores the network access.

- **Severe failures**: To handle severe failures such as losing a node entirely in case of hardware or severe software problems, requires more drastic recovery measures. The monitoring infrastructure automatically detects a failing node, both when the node starts reporting issues in the self-diagnostics or when it stops communicating. In such cases, the monitoring infrastructure automatically schedules a new replacement node to be created.
> - In the event of database failover, the Service URI of your service remains the same; only the IP address will change to point to the new primary node.
> - Hobbyist and Startup plan provide a single node, and in case of failure, a new node starts up, restores its state from the latest available backup, and resumes serving traffic.
In this plan, as there is just a single node providing the service, the service will become unavailable for the duration of the restoration. In addition, any write operations made since the backup of the latest WAL file will be lost. Typically, this time window is limited to either five minutes of time or one WAL file.

## Connection limits

The following connection limits apply to Choreo-managed PostgreSQL databases based on the selected service plan.

| Service Plan               | Max Connections |
|----------------------------|-----------------|
| Hobbyist                   | 25              |
| Startup/Business/Premium-4 | 100             |
| Business-16                | 400             |
| Premium-8                  | 200             |


 # Add Choreo-Managed Databases and Caches to the Marketplace

When you create a Choreo-managed database or cache, you can add it to the Marketplace, making it available for consumption through a connection.

!!! note 
     To add a Choreo-managed database or cache to the Marketplace, you must import at least one credential for it.

## Step 1: Import credentials

To import credentials, you can either use the default super admin credentials or the credentials you create using the super admin credentials. When you create a database or cache server, super admin credentials are generated by default. You can use these super admin credentials to create new user credentials. The steps to create new user credentials depend on the type of database or cache you are using.

You can use the imported credentials to create a connection. During connection setup, you must select credentials for each database from the list of available credentials.

To import credentials for a database, follow these steps:

1. Sign in to the [Choreo Console](https://console.choreo.dev/).
2. Go to the Choreo Console header and select your organization from the **Organization** list.
3. In the left navigation menu, click **Dependencies** and then click **Databases**.
4. Click on a required database to view its details.
5. Click the **Databases** tab.
6. Click to expand the database for which you want to import credentials, then click **Import Credentials**.
7. In the **Import Credentials** dialog, do one of the following depending on your requirements:

    - Select **Use Created Credentials** and specify the following:
         - A display name for the credentials.
         - The database credentials you created to use when setting up database connections in Choreo. 
         - The environment where you want to use the credentials. 
         
         The steps to create new user credentials depend on the type of database or cache you are using. In general, you must log in to your database server as the super admin using a command-line interface or a database management tool. Then, create new database users with the required permission levels.

    - Select **Use Super Admin Credentials** and specify the following:
         - A display name for the credentials. 
         - The environment where you want to use the credentials.

8. Click **Save**.

!!! tip 
     Choreo allows you to delete imported credentials to prevent their use when establishing new connections. However, deleting credentials will not affect any existing database connections that are already using them.

## Step 2: Add the database or cache to the Marketplace

- On the **Databases** tab, click **+Add to Marketplace** corresponding to the database you want to add. 

Once the database is added to the Marketplace, it can be consumed via a connection. For details on creating a connection to a Choreo-managed database, see [Create a connection to a database](../develop-components/sharing-and-reusing/create-a-connection.md).

!!! note 
     To remove a database or cache that you added to the Marketplace, click the corresponding **Remove from Marketplace**. This action prevents new connections to the removed database, but existing connections remain unaffected.

For details on using a database connection in your component, see [Use a Database Connection in Your Component](../develop-components/sharing-and-reusing/use-a-database-connection-in-your-component.md).


# Choreo-Managed Cache

Fully compatible with legacy Redis® OSS.

Choreo-Managed Cache provides fully-managed in-memory NoSQL databases on AWS, Azure, GCP, and Digital Ocean and can be used as a cache, database, streaming engine, or message broker.

## Create a Choreo-Managed Cache

Follow the steps below to create a Choreo-Managed Cache:

1. Sign in to the Choreo Console at [https://console.choreo.dev/](https://console.choreo.dev).
2. In the header, click the **Organization** list. This opens the organization home page.
3. In the left navigation menu, click **Dependencies** and then click **Databases**.
4. Click **+ Create** and select **Choreo-Managed Cache** as the data store type. Provide a display name for this server and follow the instructions.
5. Select a preferred cloud provider (AWS, Azure, GCP, or Digital Ocean).
    - The cloud provider provisions the compute and storage infrastructure for your data store.
    - The functionality remains the same across cloud providers, though service plans and costs may differ.
6. Select a region for your data store.
    - Available regions depend on the selected cloud provider. Choreo currently supports US and EU regions across all providers.
7. Select a service plan.
    - Service plans vary in terms of dedicated CPU, memory (RAM), and storage space allocated for your data store, as well as high-availability configurations for production use cases.
8. Click **Create**.

## Connect to your Choreo-Managed Cache

To connect to your Choreo-Managed Cache, follow these guidelines:

- Use any legacy Redis® OSS compatible driver (in any programming language) to connect to your Choreo-Managed Cache.
- You can find the connection parameters in the **Overview** section in the Choreo Console under the relevant database. Note that Choreo-Managed Cache enforces TLS.
- Choreo-Managed Cache instances accept traffic from the internet by default. You can restrict access to specific IP addresses and CIDR blocks under **Advanced Settings**.

## High availability and automatic backups

The high availability and the automatic backup retention periods for a Choreo-Managed Cache can vary as follows depending on the service plan you select. 

| Service plan | High availability                                                                                                  | Backup features                          | Backup history |
| ------------ | -------------------------------------------------------------------------------------------------------------------| ---------------------------------------- | -------------- |
| Hobbyist     | Single-node with limited availability.                                                                             | Single backup only for disaster recovery | None           |
| Startup      | Single-node with limited availability.                                                                             | Single backup only for disaster recovery | 1 day          |
| Business     | Two-node (primary + standby) with higher availability (automatic failover if the primary node fails).              | Automatic backups                        | 3 days         |
| Premium      | Three-node (primary + standby + standby) with highest availability (automatic failover if the primary node fails). | Automatic backups                        | 13 days        |

In general, service plans are recommended for production scenarios due to the following reasons:

- Provides another physical copy of the data in case of hardware, software, or network failures.
- Reduces the data loss window in disaster scenarios.
- Ensures quicker restoration with controlled failover in case of failures, as the standby is already installed and running.

### Automatic backups

- Choreo runs full backups daily to automatically backup Choreo-Managed Caches and has write-ahead logs (WAL) copied at 5-minute intervals or for every new file generated.
- Choreo encrypts all backups at rest.
- Choreo automatically handles outages and software failures by replacing broken nodes with new ones that resume correctly from the point of failure. The impact of a failure will depend on the number of available standby nodes in the data store.

### Failure recovery

- **Minor failures**: Choreo automatically handles minor failures such as service process crashes or temporary loss of network access in all plans without requiring significant changes to the service deployment. Choreo automatically restores the service to normal operation once it automatically restarts the crashed process or when it restores the network access.

- **Severe failures**: Failures such as losing a node entirely in case of hardware or severe software problems, require more drastic recovery measures. The monitoring infrastructure automatically detects a failing node when the node starts reporting issues in the self-diagnostics or when it stops communicating. In such cases, the monitoring infrastructure automatically schedules a new replacement node to be created.
     - In the event of a data store failover, the service URI of your service remains the same; only the IP address will change to point to the new primary node.
     - Hobbyist and Startup plans provide a single node, and in case of failure, a new node starts up, restores its state from the latest available backup, and resumes serving traffic.
     - As there is just a single/primary node, the caching service becomes unavailable for the duration of the restoration operation. Therefore, all write operations made since the last backup will be lost.

## Limitations

### Connection limits

The number of simultaneous connections in a Choreo-Managed Cache depends on the total available memory on the server instances.

You can use the following to estimate:

```
max_number_of_connections = 4 x m
```

Here, `m` represents the memory in megabytes, where at least 10,000 connections are available, even on the smallest servers.
For example, on a server with 4GB memory (4,096 MB), the simultaneous connections are:

```
4 x 4096 = 16384 // 16k connections
```

This number is estimated by the exact available memory so it can vary between different plans and cloud providers. To see the exact maximum connections allowed, use the \* redis-cli and info command as follows:

```
echo "info" | redis-cli -u REDIS_URI | grep maxclients
```

### Restricted commands

To maintain the stability and security of a managed environment, Choreo restricts certain commands on Choreo-Managed Cache services.

!!! note "Support for Lua scripts on Choreo-Managed Cache"
     - Choreo-Managed Cache has built-in support for running Lua scripts to perform various actions directly on the server. Scripting is typically controlled using the `EVAL`, `EVALSHA`, and `SCRIPT LOAD` commands.
     - For all newly-created cache instances, `EVAL`, `EVALSHA`, and `SCRIPT LOAD` commands are enabled by default.

The following commands are disabled on Choreo:

- `bgrewriteaof`: Initiates a background append-only file rewrite.
- `cluster`: Manages Caching cluster commands.
- `command`: Provides details about all Caching commands.
- `debug`: Contains sub-commands for debugging Caching.
- `failover`: Manages manual failover of a master to a replica.
- `migrate`: Atomically transfers a key from one caching instance to another.
- `role`: Returns the role of the instance in the context of replication.
- `slaveof`: Makes the server a replica of another instance, or promotes it as master.
- `acl`: Manages caching access control lists.
- `bgsave`: Creates a snapshot of the data set into a dump file.
- `config`: Alters the configuration of a running caching server.
- `lastsave`: Returns the UNIX timestamp of the last successful save to disk.
- `monitor`: Streams back every command processed by the Caching server.
- `replicaof`: Makes the server a replica of another instance.
- `save`: Synchronously saves the dataset to disk.
- `shutdown`: Synchronously saves the dataset to disk and then shuts down the server.

The following `eval` commands are also disabled:

- `eval`: Executes a Lua script server-side.
- `eval_ro`: Read-only variant of the eval command.
- `evalsha`: Executes a script cached on the server side by its SHA1 digest.
- `evalsha_ro`: Read-only variant of the evalsha command.
- `fcall`: Calls a Caching function.
- `fcall_ro`: Read-only variant of the fcall command.
- `function`: Manages Caching functions.
- `script`: Manages the script cache.


# Choreo-Managed Databases, Vector Databases, and Caches

Choreo allows you to create PostgreSQL and MySQL databases as well as Choreo-Managed Cache instances on all major cloud providers (AWS, Azure, GCP, and DigitalOcean) as fully Choreo-managed platform services.
These databases and caches can be seamlessly provisioned to offer persistence and caching capabilities for all your Choreo components. Choreo provides various service plans for each type, ranging from smaller instances for development purposes to production-grade databases with automatic backups and high-availability multi-nodes.

!!! info "Note"
     - The capability to create Choreo-managed databases, vector databases, and cache services is available only for paid Choreo users.
     - Billing for these services will be included in your Choreo subscription, with pricing varying based on the service plan of the resources you create. For more details, see [Choreo Platform Services Billing](../references/choreo-platform-services-billing-and-upgrades.md#platform-service-billing-information).

!!!Tip "Explore the free trial"
    Choreo provides a 7-day free trial for all database types on the 'Hobbyist' service plan, available to free-tier users.

## PostgreSQL on Choreo

PostgreSQL (also known as Postgres), is an open-source object-relational database management system. You can create PostgreSQL databases on Choreo as fully Choreo-managed, flexible SQL databases that are ideal for both structured and unstructured data. If you want to perform an efficient vector similarity search, you can create a PostgreSQL vector database.

- [Create a PostgreSQL database on Choreo](./choreo-managed-postgresql-databases.md)

## MySQL on Choreo

MySQL is a user-friendly, flexible, open-source relational database management system with a well-established history in the SQL database realm. Choreo allows you to swiftly create fully Choreo-managed MySQL databases, enabling rapid setup and utilization.

- [Create a MySQL database on Choreo](./choreo-managed-mysql-databases.md)

## Choreo-Managed Cache

A fully-managed cache compatible with legacy Redis® OSS. A versatile, in-memory NoSQL database that serves as a cache, database, streaming engine, and message broker. Choreo-managed Cache allows you to have fully-managed instances that can be swiftly provisioned and integrated into your applications within minutes.

- [Create a Choreo-managed Cache](./choreo-managed-caches.md)

<span style="font-size: 11px; color:gray;">
 PostgreSQL, MySQL, and Redis® are trademarks and property of their respective owners. All product and service names used in this documentation are for identification purposes only. 
</span>


# Choreo-managed MySQL Databases

MySQL on Choreo offers fully managed, flexible relational databases on AWS, Azure, GCP, and Digital Ocean.

## Create a Choreo-managed MySQL database

Follow the steps below to create a Choreo-managed MySQL database: 

1. From the environment list on the header, located next to the **Deployment Tracks** list, select your **Organization**.
2. In the left navigation menu, click **Dependencies** and then **Databases**.
3. Click **Create** and select **MySQL** as the database type. Provide a display name for this server and follow the instructions.
4. Select your preferred cloud provider from AWS, Azure, GCP, and Digital Ocean.
  - Choreo uses the cloud provider to provision the compute and storage infrastructure for your database.
  - There is no functional difference between databases created on different cloud providers, apart from changes to service plans (and associated costs). 
5. Choose the region for your database.
  - Available regions will depend on the selected cloud provider. Choreo currently supports US and EU regions across all providers.
6. Select the service plan.
  - Service plans vary in the dedicated CPU, memory (RAM), storage space allocated for your database, the backup retention periods, and high-availability configurations for production use cases.

## Connect to your Choreo-managed MySQL database

To connect to your Choreo-managed MySQL database, consider the following guidelines:

- You can use any MySQL driver, ORM, or supported generic SQL library (may depend on the programming language) to connect to the database.
- You can find the connection parameters in the **Overview** section in the Choreo Console under the relevant database.
- MySQL databases accept traffic from the internet by default. You can restrict access to specific IP addresses and CIDR blocks under **Advanced Settings**.

## High Availability and Automatic Backups

The high availability characteristics and the automatic backup retention periods for Choreo-managed MySQL databases vary based on your service plan as explained below:

| Service Plan | High Availability                                                  | Backup Retention Time |
|--------------|--------------------------------------------------------------------|-----------------------|
| Hobbyist     | Single-node with limited availability                              | None                  |
| Startup      | Single-node with limited availability                              | 2 days                |
| Business     | Two-node (primary + standby) with higher availability              | 14 days               |
| Premium      | Three-node (primary + standby + standby) with highest availability | 30 days               |

In general, we recommend service plans for production scenarios for multiple reasons:
- Provides another physical copy of the data in case of hardware, software, or network failures.
- Typically reduces the data loss window in disaster scenarios.
- Provides a quicker time to restore with a controlled failover in case of failures, as the standby is already installed and running.

### Automatic Backups

- Choreo runs full backups daily to automatically back up Choreo-managed MySQL databases and record binary logs continuously.
Choreo encrypts all backups at rest.

- Choreo automatically handles outages and software failures by replacing broken nodes with new ones that resume correctly from the point of failure. The impact of a failure will depend on the number of available standby nodes in the database.

## Connection Limits

The maximum number of simultaneous connections to MySQL databases is fixed for each service plan and depends on how much RAM your service plan offers.

!!! note
    An `extra_connection` with a value of `1` is added for system processes for all MySQL databases, regardless of the service plan.

### For plans under 4 GiB RAM

For plans under 4 GiB of RAM, the number of allowed connections is `75` per GiB:

```
max_connections = 75 x RAM + extra_connection
```

### For plans with over 4 GiB RAM:

For plans with 4 GiB or more RAM, the number of allowed connections is `100` per GiB:

```
max_connections = 100 x RAM + extra_connection
```


# Choreo-Managed PostgreSQL Databases and Vector Databases

PostgreSQL on Choreo offers fully Choreo-managed, efficient object-relational databases on AWS, Azure, GCP, and Digital Ocean. Additionally, Choreo allows you to create fully-managed PostgreSQL vector databases if you want to perform efficient vector similarity search.

## Create a Choreo-managed PostgreSQL database

Follow the steps below to create a Choreo-managed PostgreSQL database: 

1. Sign in to the Choreo Console at [https://console.choreo.dev/](https://console.choreo.dev/).
2. In the header, click the **Organization** list. This opens the organization home page.
3. In the left navigation menu, click **Dependencies** and then **Databases**.
4. Click **Create** and select **PostgreSQL** as the database type. Provide a display name for this server and follow the instructions.
5. Select your preferred cloud provider from AWS, Azure, GCP, or Digital Ocean.
    - The cloud provider is used to provision the compute and storage infrastructure for your database.
    - There is no functional difference between databases created on different cloud providers, apart from changes to service plans (and associated costs). 
6. Choose the region for your database.
   - Available regions will depend on the selected cloud provider. Choreo currently supports US and EU regions across all providers.
7. Select the service plan.
   - Service plans vary in the dedicated CPU, memory (RAM), storage space allocated for your database, the backup retention periods, and high-availability configurations for production use cases.

## Create a Choreo-managed PostgreSQL vector database

Follow the steps below to create a Choreo-managed PostgreSQL vector database: 

1. Sign in to the Choreo Console at [https://console.choreo.dev/](https://console.choreo.dev/).
2. In the header, click the **Organization** list. This opens the organization home page.
3. In the left navigation menu, click **Dependencies** and then **Vector Databases**.
4. Follow steps 4 onwards in the [Create a Choreo-managed PostgreSQL database](#create-a-choreo-managed-postgresql-database) section.

## Connecting to your Choreo-managed PostgreSQL database

To connect to your Choreo-managed PostgreSQL database, consider the following guidelines:

- You can use any PostgreSQL driver, ORM, or supported generic SQL library (may depend on the programming language) to connect to the database.
- The connection parameters can be found in the **Overview** section in the Choreo Console under the relevant database.
- PostgreSQL databases accept traffic from the internet by default. You can restrict access to specific IP addresses and CIDR blocks under **Advanced Settings**.


## High Availability and Automatic Backups

The high availability characteristics and the automatic backup retention periods for Choreo-managed PostgreSQL databases vary based on the selected service plan as shown below.

| Service Plan | High Availability                                                  | Backup Retention Time |
|--------------|--------------------------------------------------------------------|-----------------------|
| Hobbyist     | Single-node with limited availability                              | None                  |
| Startup      | Single-node with limited availability                              | 2 days                |
| Business     | Two-node (primary + standby) with higher availability              | 14 days               |
| Premium      | Three-node (primary + standby + standby) with highest availability | 30 days               |

Service plans with standby nodes are generally recommended for production scenarios for multiple reasons:
- Provides another physical copy of the data in case of hardware, software, or network failures.
- Typically reduces the data loss window in disaster scenarios.
- Provides a quicker time to restore with a controlled failover in case of failures, as the standby is already installed and running.

### Automatic Backups


- Choreo runs full backups daily to automatically back up Choreo-managed PostgreSQL databases and copies the write-ahead logs (WAL)  at 5-minute intervals or for every new file generated.
Choreo encrypts all backups at rest.

- Choreo automatically handles outages and software failures by replacing broken nodes with new ones that resume correctly from the point of failure. The impact of a failure will depend on the number of available standby nodes in the database.

### Failure Recovery

- **Minor failures**: Choreo automatically handles minor failures such as service process crashes or temporary loss of network access in all plans without requiring significant changes to the service deployment. Choreo automatically restores the service to normal operation once Choreo automatically restarts the crashed process or when Choreo restores the network access.

- **Severe failures**: To handle severe failures such as losing a node entirely in case of hardware or severe software problems, requires more drastic recovery measures. The monitoring infrastructure automatically detects a failing node, both when the node starts reporting issues in the self-diagnostics or when it stops communicating. In such cases, the monitoring infrastructure automatically schedules a new replacement node to be created.
> - In the event of database failover, the Service URI of your service remains the same; only the IP address will change to point to the new primary node.
> - Hobbyist and Startup plan provide a single node, and in case of failure, a new node starts up, restores its state from the latest available backup, and resumes serving traffic.
In this plan, as there is just a single node providing the service, the service will become unavailable for the duration of the restoration. In addition, any write operations made since the backup of the latest WAL file will be lost. Typically, this time window is limited to either five minutes of time or one WAL file.

## Connection limits

The following connection limits apply to Choreo-managed PostgreSQL databases based on the selected service plan.

| Service Plan               | Max Connections |
|----------------------------|-----------------|
| Hobbyist                   | 25              |
| Startup/Business/Premium-4 | 100             |
| Business-16                | 400             |
| Premium-8                  | 200             |


 # Add Choreo-Managed Databases and Caches to the Marketplace

When you create a Choreo-managed database or cache, you can add it to the Marketplace, making it available for consumption through a connection.

!!! note 
     To add a Choreo-managed database or cache to the Marketplace, you must import at least one credential for it.

## Step 1: Import credentials

To import credentials, you can either use the default super admin credentials or the credentials you create using the super admin credentials. When you create a database or cache server, super admin credentials are generated by default. You can use these super admin credentials to create new user credentials. The steps to create new user credentials depend on the type of database or cache you are using.

You can use the imported credentials to create a connection. During connection setup, you must select credentials for each database from the list of available credentials.

To import credentials for a database, follow these steps:

1. Sign in to the [Choreo Console](https://console.choreo.dev/).
2. Go to the Choreo Console header and select your organization from the **Organization** list.
3. In the left navigation menu, click **Dependencies** and then click **Databases**.
4. Click on a required database to view its details.
5. Click the **Databases** tab.
6. Click to expand the database for which you want to import credentials, then click **Import Credentials**.
7. In the **Import Credentials** dialog, do one of the following depending on your requirements:

    - Select **Use Created Credentials** and specify the following:
         - A display name for the credentials.
         - The database credentials you created to use when setting up database connections in Choreo. 
         - The environment where you want to use the credentials. 
         
         The steps to create new user credentials depend on the type of database or cache you are using. In general, you must log in to your database server as the super admin using a command-line interface or a database management tool. Then, create new database users with the required permission levels.

    - Select **Use Super Admin Credentials** and specify the following:
         - A display name for the credentials. 
         - The environment where you want to use the credentials.

8. Click **Save**.

!!! tip 
     Choreo allows you to delete imported credentials to prevent their use when establishing new connections. However, deleting credentials will not affect any existing database connections that are already using them.

## Step 2: Add the database or cache to the Marketplace

- On the **Databases** tab, click **+Add to Marketplace** corresponding to the database you want to add. 

Once the database is added to the Marketplace, it can be consumed via a connection. For details on creating a connection to a Choreo-managed database, see [Create a connection to a database](../develop-components/sharing-and-reusing/create-a-connection.md).

!!! note 
     To remove a database or cache that you added to the Marketplace, click the corresponding **Remove from Marketplace**. This action prevents new connections to the removed database, but existing connections remain unaffected.

For details on using a database connection in your component, see [Use a Database Connection in Your Component](../develop-components/sharing-and-reusing/use-a-database-connection-in-your-component.md).


# Choreo-Managed Cache

Fully compatible with legacy Redis® OSS.

Choreo-Managed Cache provides fully-managed in-memory NoSQL databases on AWS, Azure, GCP, and Digital Ocean and can be used as a cache, database, streaming engine, or message broker.

## Create a Choreo-Managed Cache

Follow the steps below to create a Choreo-Managed Cache:

1. Sign in to the Choreo Console at [https://console.choreo.dev/](https://console.choreo.dev).
2. In the header, click the **Organization** list. This opens the organization home page.
3. In the left navigation menu, click **Dependencies** and then click **Databases**.
4. Click **+ Create** and select **Choreo-Managed Cache** as the data store type. Provide a display name for this server and follow the instructions.
5. Select a preferred cloud provider (AWS, Azure, GCP, or Digital Ocean).
    - The cloud provider provisions the compute and storage infrastructure for your data store.
    - The functionality remains the same across cloud providers, though service plans and costs may differ.
6. Select a region for your data store.
    - Available regions depend on the selected cloud provider. Choreo currently supports US and EU regions across all providers.
7. Select a service plan.
    - Service plans vary in terms of dedicated CPU, memory (RAM), and storage space allocated for your data store, as well as high-availability configurations for production use cases.
8. Click **Create**.

## Connect to your Choreo-Managed Cache

To connect to your Choreo-Managed Cache, follow these guidelines:

- Use any legacy Redis® OSS compatible driver (in any programming language) to connect to your Choreo-Managed Cache.
- You can find the connection parameters in the **Overview** section in the Choreo Console under the relevant database. Note that Choreo-Managed Cache enforces TLS.
- Choreo-Managed Cache instances accept traffic from the internet by default. You can restrict access to specific IP addresses and CIDR blocks under **Advanced Settings**.

## High availability and automatic backups

The high availability and the automatic backup retention periods for a Choreo-Managed Cache can vary as follows depending on the service plan you select. 

| Service plan | High availability                                                                                                  | Backup features                          | Backup history |
| ------------ | -------------------------------------------------------------------------------------------------------------------| ---------------------------------------- | -------------- |
| Hobbyist     | Single-node with limited availability.                                                                             | Single backup only for disaster recovery | None           |
| Startup      | Single-node with limited availability.                                                                             | Single backup only for disaster recovery | 1 day          |
| Business     | Two-node (primary + standby) with higher availability (automatic failover if the primary node fails).              | Automatic backups                        | 3 days         |
| Premium      | Three-node (primary + standby + standby) with highest availability (automatic failover if the primary node fails). | Automatic backups                        | 13 days        |

In general, service plans are recommended for production scenarios due to the following reasons:

- Provides another physical copy of the data in case of hardware, software, or network failures.
- Reduces the data loss window in disaster scenarios.
- Ensures quicker restoration with controlled failover in case of failures, as the standby is already installed and running.

### Automatic backups

- Choreo runs full backups daily to automatically backup Choreo-Managed Caches and has write-ahead logs (WAL) copied at 5-minute intervals or for every new file generated.
- Choreo encrypts all backups at rest.
- Choreo automatically handles outages and software failures by replacing broken nodes with new ones that resume correctly from the point of failure. The impact of a failure will depend on the number of available standby nodes in the data store.

### Failure recovery

- **Minor failures**: Choreo automatically handles minor failures such as service process crashes or temporary loss of network access in all plans without requiring significant changes to the service deployment. Choreo automatically restores the service to normal operation once it automatically restarts the crashed process or when it restores the network access.

- **Severe failures**: Failures such as losing a node entirely in case of hardware or severe software problems, require more drastic recovery measures. The monitoring infrastructure automatically detects a failing node when the node starts reporting issues in the self-diagnostics or when it stops communicating. In such cases, the monitoring infrastructure automatically schedules a new replacement node to be created.
     - In the event of a data store failover, the service URI of your service remains the same; only the IP address will change to point to the new primary node.
     - Hobbyist and Startup plans provide a single node, and in case of failure, a new node starts up, restores its state from the latest available backup, and resumes serving traffic.
     - As there is just a single/primary node, the caching service becomes unavailable for the duration of the restoration operation. Therefore, all write operations made since the last backup will be lost.

## Limitations

### Connection limits

The number of simultaneous connections in a Choreo-Managed Cache depends on the total available memory on the server instances.

You can use the following to estimate:

```
max_number_of_connections = 4 x m
```

Here, `m` represents the memory in megabytes, where at least 10,000 connections are available, even on the smallest servers.
For example, on a server with 4GB memory (4,096 MB), the simultaneous connections are:

```
4 x 4096 = 16384 // 16k connections
```

This number is estimated by the exact available memory so it can vary between different plans and cloud providers. To see the exact maximum connections allowed, use the \* redis-cli and info command as follows:

```
echo "info" | redis-cli -u REDIS_URI | grep maxclients
```

### Restricted commands

To maintain the stability and security of a managed environment, Choreo restricts certain commands on Choreo-Managed Cache services.

!!! note "Support for Lua scripts on Choreo-Managed Cache"
     - Choreo-Managed Cache has built-in support for running Lua scripts to perform various actions directly on the server. Scripting is typically controlled using the `EVAL`, `EVALSHA`, and `SCRIPT LOAD` commands.
     - For all newly-created cache instances, `EVAL`, `EVALSHA`, and `SCRIPT LOAD` commands are enabled by default.

The following commands are disabled on Choreo:

- `bgrewriteaof`: Initiates a background append-only file rewrite.
- `cluster`: Manages Caching cluster commands.
- `command`: Provides details about all Caching commands.
- `debug`: Contains sub-commands for debugging Caching.
- `failover`: Manages manual failover of a master to a replica.
- `migrate`: Atomically transfers a key from one caching instance to another.
- `role`: Returns the role of the instance in the context of replication.
- `slaveof`: Makes the server a replica of another instance, or promotes it as master.
- `acl`: Manages caching access control lists.
- `bgsave`: Creates a snapshot of the data set into a dump file.
- `config`: Alters the configuration of a running caching server.
- `lastsave`: Returns the UNIX timestamp of the last successful save to disk.
- `monitor`: Streams back every command processed by the Caching server.
- `replicaof`: Makes the server a replica of another instance.
- `save`: Synchronously saves the dataset to disk.
- `shutdown`: Synchronously saves the dataset to disk and then shuts down the server.

The following `eval` commands are also disabled:

- `eval`: Executes a Lua script server-side.
- `eval_ro`: Read-only variant of the eval command.
- `evalsha`: Executes a script cached on the server side by its SHA1 digest.
- `evalsha_ro`: Read-only variant of the evalsha command.
- `fcall`: Calls a Caching function.
- `fcall_ro`: Read-only variant of the fcall command.
- `function`: Manages Caching functions.
- `script`: Manages the script cache.


# Choreo-Managed Databases, Vector Databases, and Caches

Choreo allows you to create PostgreSQL and MySQL databases as well as Choreo-Managed Cache instances on all major cloud providers (AWS, Azure, GCP, and DigitalOcean) as fully Choreo-managed platform services.
These databases and caches can be seamlessly provisioned to offer persistence and caching capabilities for all your Choreo components. Choreo provides various service plans for each type, ranging from smaller instances for development purposes to production-grade databases with automatic backups and high-availability multi-nodes.

!!! info "Note"
     - The capability to create Choreo-managed databases, vector databases, and cache services is available only for paid Choreo users.
     - Billing for these services will be included in your Choreo subscription, with pricing varying based on the service plan of the resources you create. For more details, see [Choreo Platform Services Billing](../references/choreo-platform-services-billing-and-upgrades.md#platform-service-billing-information).

!!!Tip "Explore the free trial"
    Choreo provides a 7-day free trial for all database types on the 'Hobbyist' service plan, available to free-tier users.

## PostgreSQL on Choreo

PostgreSQL (also known as Postgres), is an open-source object-relational database management system. You can create PostgreSQL databases on Choreo as fully Choreo-managed, flexible SQL databases that are ideal for both structured and unstructured data. If you want to perform an efficient vector similarity search, you can create a PostgreSQL vector database.

- [Create a PostgreSQL database on Choreo](./choreo-managed-postgresql-databases.md)

## MySQL on Choreo

MySQL is a user-friendly, flexible, open-source relational database management system with a well-established history in the SQL database realm. Choreo allows you to swiftly create fully Choreo-managed MySQL databases, enabling rapid setup and utilization.

- [Create a MySQL database on Choreo](./choreo-managed-mysql-databases.md)

## Choreo-Managed Cache

A fully-managed cache compatible with legacy Redis® OSS. A versatile, in-memory NoSQL database that serves as a cache, database, streaming engine, and message broker. Choreo-managed Cache allows you to have fully-managed instances that can be swiftly provisioned and integrated into your applications within minutes.

- [Create a Choreo-managed Cache](./choreo-managed-caches.md)

<span style="font-size: 11px; color:gray;">
 PostgreSQL, MySQL, and Redis® are trademarks and property of their respective owners. All product and service names used in this documentation are for identification purposes only. 
</span>


# Choreo-managed MySQL Databases

MySQL on Choreo offers fully managed, flexible relational databases on AWS, Azure, GCP, and Digital Ocean.

## Create a Choreo-managed MySQL database

Follow the steps below to create a Choreo-managed MySQL database: 

1. From the environment list on the header, located next to the **Deployment Tracks** list, select your **Organization**.
2. In the left navigation menu, click **Dependencies** and then **Databases**.
3. Click **Create** and select **MySQL** as the database type. Provide a display name for this server and follow the instructions.
4. Select your preferred cloud provider from AWS, Azure, GCP, and Digital Ocean.
  - Choreo uses the cloud provider to provision the compute and storage infrastructure for your database.
  - There is no functional difference between databases created on different cloud providers, apart from changes to service plans (and associated costs). 
5. Choose the region for your database.
  - Available regions will depend on the selected cloud provider. Choreo currently supports US and EU regions across all providers.
6. Select the service plan.
  - Service plans vary in the dedicated CPU, memory (RAM), storage space allocated for your database, the backup retention periods, and high-availability configurations for production use cases.

## Connect to your Choreo-managed MySQL database

To connect to your Choreo-managed MySQL database, consider the following guidelines:

- You can use any MySQL driver, ORM, or supported generic SQL library (may depend on the programming language) to connect to the database.
- You can find the connection parameters in the **Overview** section in the Choreo Console under the relevant database.
- MySQL databases accept traffic from the internet by default. You can restrict access to specific IP addresses and CIDR blocks under **Advanced Settings**.

## High Availability and Automatic Backups

The high availability characteristics and the automatic backup retention periods for Choreo-managed MySQL databases vary based on your service plan as explained below:

| Service Plan | High Availability                                                  | Backup Retention Time |
|--------------|--------------------------------------------------------------------|-----------------------|
| Hobbyist     | Single-node with limited availability                              | None                  |
| Startup      | Single-node with limited availability                              | 2 days                |
| Business     | Two-node (primary + standby) with higher availability              | 14 days               |
| Premium      | Three-node (primary + standby + standby) with highest availability | 30 days               |

In general, we recommend service plans for production scenarios for multiple reasons:
- Provides another physical copy of the data in case of hardware, software, or network failures.
- Typically reduces the data loss window in disaster scenarios.
- Provides a quicker time to restore with a controlled failover in case of failures, as the standby is already installed and running.

### Automatic Backups

- Choreo runs full backups daily to automatically back up Choreo-managed MySQL databases and record binary logs continuously.
Choreo encrypts all backups at rest.

- Choreo automatically handles outages and software failures by replacing broken nodes with new ones that resume correctly from the point of failure. The impact of a failure will depend on the number of available standby nodes in the database.

## Connection Limits

The maximum number of simultaneous connections to MySQL databases is fixed for each service plan and depends on how much RAM your service plan offers.

!!! note
    An `extra_connection` with a value of `1` is added for system processes for all MySQL databases, regardless of the service plan.

### For plans under 4 GiB RAM

For plans under 4 GiB of RAM, the number of allowed connections is `75` per GiB:

```
max_connections = 75 x RAM + extra_connection
```

### For plans with over 4 GiB RAM:

For plans with 4 GiB or more RAM, the number of allowed connections is `100` per GiB:

```
max_connections = 100 x RAM + extra_connection
```


# Choreo-Managed PostgreSQL Databases and Vector Databases

PostgreSQL on Choreo offers fully Choreo-managed, efficient object-relational databases on AWS, Azure, GCP, and Digital Ocean. Additionally, Choreo allows you to create fully-managed PostgreSQL vector databases if you want to perform efficient vector similarity search.

## Create a Choreo-managed PostgreSQL database

Follow the steps below to create a Choreo-managed PostgreSQL database: 

1. Sign in to the Choreo Console at [https://console.choreo.dev/](https://console.choreo.dev/).
2. In the header, click the **Organization** list. This opens the organization home page.
3. In the left navigation menu, click **Dependencies** and then **Databases**.
4. Click **Create** and select **PostgreSQL** as the database type. Provide a display name for this server and follow the instructions.
5. Select your preferred cloud provider from AWS, Azure, GCP, or Digital Ocean.
    - The cloud provider is used to provision the compute and storage infrastructure for your database.
    - There is no functional difference between databases created on different cloud providers, apart from changes to service plans (and associated costs). 
6. Choose the region for your database.
   - Available regions will depend on the selected cloud provider. Choreo currently supports US and EU regions across all providers.
7. Select the service plan.
   - Service plans vary in the dedicated CPU, memory (RAM), storage space allocated for your database, the backup retention periods, and high-availability configurations for production use cases.

## Create a Choreo-managed PostgreSQL vector database

Follow the steps below to create a Choreo-managed PostgreSQL vector database: 

1. Sign in to the Choreo Console at [https://console.choreo.dev/](https://console.choreo.dev/).
2. In the header, click the **Organization** list. This opens the organization home page.
3. In the left navigation menu, click **Dependencies** and then **Vector Databases**.
4. Follow steps 4 onwards in the [Create a Choreo-managed PostgreSQL database](#create-a-choreo-managed-postgresql-database) section.

## Connecting to your Choreo-managed PostgreSQL database

To connect to your Choreo-managed PostgreSQL database, consider the following guidelines:

- You can use any PostgreSQL driver, ORM, or supported generic SQL library (may depend on the programming language) to connect to the database.
- The connection parameters can be found in the **Overview** section in the Choreo Console under the relevant database.
- PostgreSQL databases accept traffic from the internet by default. You can restrict access to specific IP addresses and CIDR blocks under **Advanced Settings**.


## High Availability and Automatic Backups

The high availability characteristics and the automatic backup retention periods for Choreo-managed PostgreSQL databases vary based on the selected service plan as shown below.

| Service Plan | High Availability                                                  | Backup Retention Time |
|--------------|--------------------------------------------------------------------|-----------------------|
| Hobbyist     | Single-node with limited availability                              | None                  |
| Startup      | Single-node with limited availability                              | 2 days                |
| Business     | Two-node (primary + standby) with higher availability              | 14 days               |
| Premium      | Three-node (primary + standby + standby) with highest availability | 30 days               |

Service plans with standby nodes are generally recommended for production scenarios for multiple reasons:
- Provides another physical copy of the data in case of hardware, software, or network failures.
- Typically reduces the data loss window in disaster scenarios.
- Provides a quicker time to restore with a controlled failover in case of failures, as the standby is already installed and running.

### Automatic Backups


- Choreo runs full backups daily to automatically back up Choreo-managed PostgreSQL databases and copies the write-ahead logs (WAL)  at 5-minute intervals or for every new file generated.
Choreo encrypts all backups at rest.

- Choreo automatically handles outages and software failures by replacing broken nodes with new ones that resume correctly from the point of failure. The impact of a failure will depend on the number of available standby nodes in the database.

### Failure Recovery

- **Minor failures**: Choreo automatically handles minor failures such as service process crashes or temporary loss of network access in all plans without requiring significant changes to the service deployment. Choreo automatically restores the service to normal operation once Choreo automatically restarts the crashed process or when Choreo restores the network access.

- **Severe failures**: To handle severe failures such as losing a node entirely in case of hardware or severe software problems, requires more drastic recovery measures. The monitoring infrastructure automatically detects a failing node, both when the node starts reporting issues in the self-diagnostics or when it stops communicating. In such cases, the monitoring infrastructure automatically schedules a new replacement node to be created.
> - In the event of database failover, the Service URI of your service remains the same; only the IP address will change to point to the new primary node.
> - Hobbyist and Startup plan provide a single node, and in case of failure, a new node starts up, restores its state from the latest available backup, and resumes serving traffic.
In this plan, as there is just a single node providing the service, the service will become unavailable for the duration of the restoration. In addition, any write operations made since the backup of the latest WAL file will be lost. Typically, this time window is limited to either five minutes of time or one WAL file.

## Connection limits

The following connection limits apply to Choreo-managed PostgreSQL databases based on the selected service plan.

| Service Plan               | Max Connections |
|----------------------------|-----------------|
| Hobbyist                   | 25              |
| Startup/Business/Premium-4 | 100             |
| Business-16                | 400             |
| Premium-8                  | 200             |












 # Add Choreo-Managed Databases and Caches to the Marketplace

When you create a Choreo-managed database or cache, you can add it to the Marketplace, making it available for consumption through a connection.

!!! note 
     To add a Choreo-managed database or cache to the Marketplace, you must import at least one credential for it.

## Step 1: Import credentials

To import credentials, you can either use the default super admin credentials or the credentials you create using the super admin credentials. When you create a database or cache server, super admin credentials are generated by default. You can use these super admin credentials to create new user credentials. The steps to create new user credentials depend on the type of database or cache you are using.

You can use the imported credentials to create a connection. During connection setup, you must select credentials for each database from the list of available credentials.

To import credentials for a database, follow these steps:

1. Sign in to the [Choreo Console](https://console.choreo.dev/).
2. Go to the Choreo Console header and select your organization from the **Organization** list.
3. In the left navigation menu, click **Dependencies** and then click **Databases**.
4. Click on a required database to view its details.
5. Click the **Databases** tab.
6. Click to expand the database for which you want to import credentials, then click **Import Credentials**.
7. In the **Import Credentials** dialog, do one of the following depending on your requirements:

    - Select **Use Created Credentials** and specify the following:
         - A display name for the credentials.
         - The database credentials you created to use when setting up database connections in Choreo. 
         - The environment where you want to use the credentials. 
         
         The steps to create new user credentials depend on the type of database or cache you are using. In general, you must log in to your database server as the super admin using a command-line interface or a database management tool. Then, create new database users with the required permission levels.

    - Select **Use Super Admin Credentials** and specify the following:
         - A display name for the credentials. 
         - The environment where you want to use the credentials.

8. Click **Save**.

!!! tip 
     Choreo allows you to delete imported credentials to prevent their use when establishing new connections. However, deleting credentials will not affect any existing database connections that are already using them.

## Step 2: Add the database or cache to the Marketplace

- On the **Databases** tab, click **+Add to Marketplace** corresponding to the database you want to add. 

Once the database is added to the Marketplace, it can be consumed via a connection. For details on creating a connection to a Choreo-managed database, see [Create a connection to a database](../develop-components/sharing-and-reusing/create-a-connection.md).

!!! note 
     To remove a database or cache that you added to the Marketplace, click the corresponding **Remove from Marketplace**. This action prevents new connections to the removed database, but existing connections remain unaffected.

For details on using a database connection in your component, see [Use a Database Connection in Your Component](../develop-components/sharing-and-reusing/use-a-database-connection-in-your-component.md).


# Choreo-Managed Cache

Fully compatible with legacy Redis® OSS.

Choreo-Managed Cache provides fully-managed in-memory NoSQL databases on AWS, Azure, GCP, and Digital Ocean and can be used as a cache, database, streaming engine, or message broker.

## Create a Choreo-Managed Cache

Follow the steps below to create a Choreo-Managed Cache:

1. Sign in to the Choreo Console at [https://console.choreo.dev/](https://console.choreo.dev).
2. In the header, click the **Organization** list. This opens the organization home page.
3. In the left navigation menu, click **Dependencies** and then click **Databases**.
4. Click **+ Create** and select **Choreo-Managed Cache** as the data store type. Provide a display name for this server and follow the instructions.
5. Select a preferred cloud provider (AWS, Azure, GCP, or Digital Ocean).
    - The cloud provider provisions the compute and storage infrastructure for your data store.
    - The functionality remains the same across cloud providers, though service plans and costs may differ.
6. Select a region for your data store.
    - Available regions depend on the selected cloud provider. Choreo currently supports US and EU regions across all providers.
7. Select a service plan.
    - Service plans vary in terms of dedicated CPU, memory (RAM), and storage space allocated for your data store, as well as high-availability configurations for production use cases.
8. Click **Create**.

## Connect to your Choreo-Managed Cache

To connect to your Choreo-Managed Cache, follow these guidelines:

- Use any legacy Redis® OSS compatible driver (in any programming language) to connect to your Choreo-Managed Cache.
- You can find the connection parameters in the **Overview** section in the Choreo Console under the relevant database. Note that Choreo-Managed Cache enforces TLS.
- Choreo-Managed Cache instances accept traffic from the internet by default. You can restrict access to specific IP addresses and CIDR blocks under **Advanced Settings**.

## High availability and automatic backups

The high availability and the automatic backup retention periods for a Choreo-Managed Cache can vary as follows depending on the service plan you select. 

| Service plan | High availability                                                                                                  | Backup features                          | Backup history |
| ------------ | -------------------------------------------------------------------------------------------------------------------| ---------------------------------------- | -------------- |
| Hobbyist     | Single-node with limited availability.                                                                             | Single backup only for disaster recovery | None           |
| Startup      | Single-node with limited availability.                                                                             | Single backup only for disaster recovery | 1 day          |
| Business     | Two-node (primary + standby) with higher availability (automatic failover if the primary node fails).              | Automatic backups                        | 3 days         |
| Premium      | Three-node (primary + standby + standby) with highest availability (automatic failover if the primary node fails). | Automatic backups                        | 13 days        |

In general, service plans are recommended for production scenarios due to the following reasons:

- Provides another physical copy of the data in case of hardware, software, or network failures.
- Reduces the data loss window in disaster scenarios.
- Ensures quicker restoration with controlled failover in case of failures, as the standby is already installed and running.

### Automatic backups

- Choreo runs full backups daily to automatically backup Choreo-Managed Caches and has write-ahead logs (WAL) copied at 5-minute intervals or for every new file generated.
- Choreo encrypts all backups at rest.
- Choreo automatically handles outages and software failures by replacing broken nodes with new ones that resume correctly from the point of failure. The impact of a failure will depend on the number of available standby nodes in the data store.

### Failure recovery

- **Minor failures**: Choreo automatically handles minor failures such as service process crashes or temporary loss of network access in all plans without requiring significant changes to the service deployment. Choreo automatically restores the service to normal operation once it automatically restarts the crashed process or when it restores the network access.

- **Severe failures**: Failures such as losing a node entirely in case of hardware or severe software problems, require more drastic recovery measures. The monitoring infrastructure automatically detects a failing node when the node starts reporting issues in the self-diagnostics or when it stops communicating. In such cases, the monitoring infrastructure automatically schedules a new replacement node to be created.
     - In the event of a data store failover, the service URI of your service remains the same; only the IP address will change to point to the new primary node.
     - Hobbyist and Startup plans provide a single node, and in case of failure, a new node starts up, restores its state from the latest available backup, and resumes serving traffic.
     - As there is just a single/primary node, the caching service becomes unavailable for the duration of the restoration operation. Therefore, all write operations made since the last backup will be lost.

## Limitations

### Connection limits

The number of simultaneous connections in a Choreo-Managed Cache depends on the total available memory on the server instances.

You can use the following to estimate:

```
max_number_of_connections = 4 x m
```

Here, `m` represents the memory in megabytes, where at least 10,000 connections are available, even on the smallest servers.
For example, on a server with 4GB memory (4,096 MB), the simultaneous connections are:

```
4 x 4096 = 16384 // 16k connections
```

This number is estimated by the exact available memory so it can vary between different plans and cloud providers. To see the exact maximum connections allowed, use the \* redis-cli and info command as follows:

```
echo "info" | redis-cli -u REDIS_URI | grep maxclients
```

### Restricted commands

To maintain the stability and security of a managed environment, Choreo restricts certain commands on Choreo-Managed Cache services.

!!! note "Support for Lua scripts on Choreo-Managed Cache"
     - Choreo-Managed Cache has built-in support for running Lua scripts to perform various actions directly on the server. Scripting is typically controlled using the `EVAL`, `EVALSHA`, and `SCRIPT LOAD` commands.
     - For all newly-created cache instances, `EVAL`, `EVALSHA`, and `SCRIPT LOAD` commands are enabled by default.

The following commands are disabled on Choreo:

- `bgrewriteaof`: Initiates a background append-only file rewrite.
- `cluster`: Manages Caching cluster commands.
- `command`: Provides details about all Caching commands.
- `debug`: Contains sub-commands for debugging Caching.
- `failover`: Manages manual failover of a master to a replica.
- `migrate`: Atomically transfers a key from one caching instance to another.
- `role`: Returns the role of the instance in the context of replication.
- `slaveof`: Makes the server a replica of another instance, or promotes it as master.
- `acl`: Manages caching access control lists.
- `bgsave`: Creates a snapshot of the data set into a dump file.
- `config`: Alters the configuration of a running caching server.
- `lastsave`: Returns the UNIX timestamp of the last successful save to disk.
- `monitor`: Streams back every command processed by the Caching server.
- `replicaof`: Makes the server a replica of another instance.
- `save`: Synchronously saves the dataset to disk.
- `shutdown`: Synchronously saves the dataset to disk and then shuts down the server.

The following `eval` commands are also disabled:

- `eval`: Executes a Lua script server-side.
- `eval_ro`: Read-only variant of the eval command.
- `evalsha`: Executes a script cached on the server side by its SHA1 digest.
- `evalsha_ro`: Read-only variant of the evalsha command.
- `fcall`: Calls a Caching function.
- `fcall_ro`: Read-only variant of the fcall command.
- `function`: Manages Caching functions.
- `script`: Manages the script cache.


# Choreo-Managed Databases, Vector Databases, and Caches

Choreo allows you to create PostgreSQL and MySQL databases as well as Choreo-Managed Cache instances on all major cloud providers (AWS, Azure, GCP, and DigitalOcean) as fully Choreo-managed platform services.
These databases and caches can be seamlessly provisioned to offer persistence and caching capabilities for all your Choreo components. Choreo provides various service plans for each type, ranging from smaller instances for development purposes to production-grade databases with automatic backups and high-availability multi-nodes.

!!! info "Note"
     - The capability to create Choreo-managed databases, vector databases, and cache services is available only for paid Choreo users.
     - Billing for these services will be included in your Choreo subscription, with pricing varying based on the service plan of the resources you create. For more details, see [Choreo Platform Services Billing](../references/choreo-platform-services-billing-and-upgrades.md#platform-service-billing-information).

!!!Tip "Explore the free trial"
    Choreo provides a 7-day free trial for all database types on the 'Hobbyist' service plan, available to free-tier users.

## PostgreSQL on Choreo

PostgreSQL (also known as Postgres), is an open-source object-relational database management system. You can create PostgreSQL databases on Choreo as fully Choreo-managed, flexible SQL databases that are ideal for both structured and unstructured data. If you want to perform an efficient vector similarity search, you can create a PostgreSQL vector database.

- [Create a PostgreSQL database on Choreo](./choreo-managed-postgresql-databases.md)

## MySQL on Choreo

MySQL is a user-friendly, flexible, open-source relational database management system with a well-established history in the SQL database realm. Choreo allows you to swiftly create fully Choreo-managed MySQL databases, enabling rapid setup and utilization.

- [Create a MySQL database on Choreo](./choreo-managed-mysql-databases.md)

## Choreo-Managed Cache

A fully-managed cache compatible with legacy Redis® OSS. A versatile, in-memory NoSQL database that serves as a cache, database, streaming engine, and message broker. Choreo-managed Cache allows you to have fully-managed instances that can be swiftly provisioned and integrated into your applications within minutes.

- [Create a Choreo-managed Cache](./choreo-managed-caches.md)

<span style="font-size: 11px; color:gray;">
 PostgreSQL, MySQL, and Redis® are trademarks and property of their respective owners. All product and service names used in this documentation are for identification purposes only. 
</span>


# Choreo-managed MySQL Databases

MySQL on Choreo offers fully managed, flexible relational databases on AWS, Azure, GCP, and Digital Ocean.

## Create a Choreo-managed MySQL database

Follow the steps below to create a Choreo-managed MySQL database: 

1. From the environment list on the header, located next to the **Deployment Tracks** list, select your **Organization**.
2. In the left navigation menu, click **Dependencies** and then **Databases**.
3. Click **Create** and select **MySQL** as the database type. Provide a display name for this server and follow the instructions.
4. Select your preferred cloud provider from AWS, Azure, GCP, and Digital Ocean.
  - Choreo uses the cloud provider to provision the compute and storage infrastructure for your database.
  - There is no functional difference between databases created on different cloud providers, apart from changes to service plans (and associated costs). 
5. Choose the region for your database.
  - Available regions will depend on the selected cloud provider. Choreo currently supports US and EU regions across all providers.
6. Select the service plan.
  - Service plans vary in the dedicated CPU, memory (RAM), storage space allocated for your database, the backup retention periods, and high-availability configurations for production use cases.

## Connect to your Choreo-managed MySQL database

To connect to your Choreo-managed MySQL database, consider the following guidelines:

- You can use any MySQL driver, ORM, or supported generic SQL library (may depend on the programming language) to connect to the database.
- You can find the connection parameters in the **Overview** section in the Choreo Console under the relevant database.
- MySQL databases accept traffic from the internet by default. You can restrict access to specific IP addresses and CIDR blocks under **Advanced Settings**.

## High Availability and Automatic Backups

The high availability characteristics and the automatic backup retention periods for Choreo-managed MySQL databases vary based on your service plan as explained below:

| Service Plan | High Availability                                                  | Backup Retention Time |
|--------------|--------------------------------------------------------------------|-----------------------|
| Hobbyist     | Single-node with limited availability                              | None                  |
| Startup      | Single-node with limited availability                              | 2 days                |
| Business     | Two-node (primary + standby) with higher availability              | 14 days               |
| Premium      | Three-node (primary + standby + standby) with highest availability | 30 days               |

In general, we recommend service plans for production scenarios for multiple reasons:
- Provides another physical copy of the data in case of hardware, software, or network failures.
- Typically reduces the data loss window in disaster scenarios.
- Provides a quicker time to restore with a controlled failover in case of failures, as the standby is already installed and running.

### Automatic Backups

- Choreo runs full backups daily to automatically back up Choreo-managed MySQL databases and record binary logs continuously.
Choreo encrypts all backups at rest.

- Choreo automatically handles outages and software failures by replacing broken nodes with new ones that resume correctly from the point of failure. The impact of a failure will depend on the number of available standby nodes in the database.

## Connection Limits

The maximum number of simultaneous connections to MySQL databases is fixed for each service plan and depends on how much RAM your service plan offers.

!!! note
    An `extra_connection` with a value of `1` is added for system processes for all MySQL databases, regardless of the service plan.

### For plans under 4 GiB RAM

For plans under 4 GiB of RAM, the number of allowed connections is `75` per GiB:

```
max_connections = 75 x RAM + extra_connection
```

### For plans with over 4 GiB RAM:

For plans with 4 GiB or more RAM, the number of allowed connections is `100` per GiB:

```
max_connections = 100 x RAM + extra_connection
```


# Choreo-Managed PostgreSQL Databases and Vector Databases

PostgreSQL on Choreo offers fully Choreo-managed, efficient object-relational databases on AWS, Azure, GCP, and Digital Ocean. Additionally, Choreo allows you to create fully-managed PostgreSQL vector databases if you want to perform efficient vector similarity search.

## Create a Choreo-managed PostgreSQL database

Follow the steps below to create a Choreo-managed PostgreSQL database: 

1. Sign in to the Choreo Console at [https://console.choreo.dev/](https://console.choreo.dev/).
2. In the header, click the **Organization** list. This opens the organization home page.
3. In the left navigation menu, click **Dependencies** and then **Databases**.
4. Click **Create** and select **PostgreSQL** as the database type. Provide a display name for this server and follow the instructions.
5. Select your preferred cloud provider from AWS, Azure, GCP, or Digital Ocean.
    - The cloud provider is used to provision the compute and storage infrastructure for your database.
    - There is no functional difference between databases created on different cloud providers, apart from changes to service plans (and associated costs). 
6. Choose the region for your database.
   - Available regions will depend on the selected cloud provider. Choreo currently supports US and EU regions across all providers.
7. Select the service plan.
   - Service plans vary in the dedicated CPU, memory (RAM), storage space allocated for your database, the backup retention periods, and high-availability configurations for production use cases.

## Create a Choreo-managed PostgreSQL vector database

Follow the steps below to create a Choreo-managed PostgreSQL vector database: 

1. Sign in to the Choreo Console at [https://console.choreo.dev/](https://console.choreo.dev/).
2. In the header, click the **Organization** list. This opens the organization home page.
3. In the left navigation menu, click **Dependencies** and then **Vector Databases**.
4. Follow steps 4 onwards in the [Create a Choreo-managed PostgreSQL database](#create-a-choreo-managed-postgresql-database) section.

## Connecting to your Choreo-managed PostgreSQL database

To connect to your Choreo-managed PostgreSQL database, consider the following guidelines:

- You can use any PostgreSQL driver, ORM, or supported generic SQL library (may depend on the programming language) to connect to the database.
- The connection parameters can be found in the **Overview** section in the Choreo Console under the relevant database.
- PostgreSQL databases accept traffic from the internet by default. You can restrict access to specific IP addresses and CIDR blocks under **Advanced Settings**.


## High Availability and Automatic Backups

The high availability characteristics and the automatic backup retention periods for Choreo-managed PostgreSQL databases vary based on the selected service plan as shown below.

| Service Plan | High Availability                                                  | Backup Retention Time |
|--------------|--------------------------------------------------------------------|-----------------------|
| Hobbyist     | Single-node with limited availability                              | None                  |
| Startup      | Single-node with limited availability                              | 2 days                |
| Business     | Two-node (primary + standby) with higher availability              | 14 days               |
| Premium      | Three-node (primary + standby + standby) with highest availability | 30 days               |

Service plans with standby nodes are generally recommended for production scenarios for multiple reasons:
- Provides another physical copy of the data in case of hardware, software, or network failures.
- Typically reduces the data loss window in disaster scenarios.
- Provides a quicker time to restore with a controlled failover in case of failures, as the standby is already installed and running.

### Automatic Backups


- Choreo runs full backups daily to automatically back up Choreo-managed PostgreSQL databases and copies the write-ahead logs (WAL)  at 5-minute intervals or for every new file generated.
Choreo encrypts all backups at rest.

- Choreo automatically handles outages and software failures by replacing broken nodes with new ones that resume correctly from the point of failure. The impact of a failure will depend on the number of available standby nodes in the database.

### Failure Recovery

- **Minor failures**: Choreo automatically handles minor failures such as service process crashes or temporary loss of network access in all plans without requiring significant changes to the service deployment. Choreo automatically restores the service to normal operation once Choreo automatically restarts the crashed process or when Choreo restores the network access.

- **Severe failures**: To handle severe failures such as losing a node entirely in case of hardware or severe software problems, requires more drastic recovery measures. The monitoring infrastructure automatically detects a failing node, both when the node starts reporting issues in the self-diagnostics or when it stops communicating. In such cases, the monitoring infrastructure automatically schedules a new replacement node to be created.
> - In the event of database failover, the Service URI of your service remains the same; only the IP address will change to point to the new primary node.
> - Hobbyist and Startup plan provide a single node, and in case of failure, a new node starts up, restores its state from the latest available backup, and resumes serving traffic.
In this plan, as there is just a single node providing the service, the service will become unavailable for the duration of the restoration. In addition, any write operations made since the backup of the latest WAL file will be lost. Typically, this time window is limited to either five minutes of time or one WAL file.

## Connection limits

The following connection limits apply to Choreo-managed PostgreSQL databases based on the selected service plan.

| Service Plan               | Max Connections |
|----------------------------|-----------------|
| Hobbyist                   | 25              |
| Startup/Business/Premium-4 | 100             |
| Business-16                | 400             |
| Premium-8                  | 200             |


 # Add Choreo-Managed Databases and Caches to the Marketplace

When you create a Choreo-managed database or cache, you can add it to the Marketplace, making it available for consumption through a connection.

!!! note 
     To add a Choreo-managed database or cache to the Marketplace, you must import at least one credential for it.

## Step 1: Import credentials

To import credentials, you can either use the default super admin credentials or the credentials you create using the super admin credentials. When you create a database or cache server, super admin credentials are generated by default. You can use these super admin credentials to create new user credentials. The steps to create new user credentials depend on the type of database or cache you are using.

You can use the imported credentials to create a connection. During connection setup, you must select credentials for each database from the list of available credentials.

To import credentials for a database, follow these steps:

1. Sign in to the [Choreo Console](https://console.choreo.dev/).
2. Go to the Choreo Console header and select your organization from the **Organization** list.
3. In the left navigation menu, click **Dependencies** and then click **Databases**.
4. Click on a required database to view its details.
5. Click the **Databases** tab.
6. Click to expand the database for which you want to import credentials, then click **Import Credentials**.
7. In the **Import Credentials** dialog, do one of the following depending on your requirements:

    - Select **Use Created Credentials** and specify the following:
         - A display name for the credentials.
         - The database credentials you created to use when setting up database connections in Choreo. 
         - The environment where you want to use the credentials. 
         
         The steps to create new user credentials depend on the type of database or cache you are using. In general, you must log in to your database server as the super admin using a command-line interface or a database management tool. Then, create new database users with the required permission levels.

    - Select **Use Super Admin Credentials** and specify the following:
         - A display name for the credentials. 
         - The environment where you want to use the credentials.

8. Click **Save**.

!!! tip 
     Choreo allows you to delete imported credentials to prevent their use when establishing new connections. However, deleting credentials will not affect any existing database connections that are already using them.

## Step 2: Add the database or cache to the Marketplace

- On the **Databases** tab, click **+Add to Marketplace** corresponding to the database you want to add. 

Once the database is added to the Marketplace, it can be consumed via a connection. For details on creating a connection to a Choreo-managed database, see [Create a connection to a database](../develop-components/sharing-and-reusing/create-a-connection.md).

!!! note 
     To remove a database or cache that you added to the Marketplace, click the corresponding **Remove from Marketplace**. This action prevents new connections to the removed database, but existing connections remain unaffected.

For details on using a database connection in your component, see [Use a Database Connection in Your Component](../develop-components/sharing-and-reusing/use-a-database-connection-in-your-component.md).


# Choreo-Managed Cache

Fully compatible with legacy Redis® OSS.

Choreo-Managed Cache provides fully-managed in-memory NoSQL databases on AWS, Azure, GCP, and Digital Ocean and can be used as a cache, database, streaming engine, or message broker.

## Create a Choreo-Managed Cache

Follow the steps below to create a Choreo-Managed Cache:

1. Sign in to the Choreo Console at [https://console.choreo.dev/](https://console.choreo.dev).
2. In the header, click the **Organization** list. This opens the organization home page.
3. In the left navigation menu, click **Dependencies** and then click **Databases**.
4. Click **+ Create** and select **Choreo-Managed Cache** as the data store type. Provide a display name for this server and follow the instructions.
5. Select a preferred cloud provider (AWS, Azure, GCP, or Digital Ocean).
    - The cloud provider provisions the compute and storage infrastructure for your data store.
    - The functionality remains the same across cloud providers, though service plans and costs may differ.
6. Select a region for your data store.
    - Available regions depend on the selected cloud provider. Choreo currently supports US and EU regions across all providers.
7. Select a service plan.
    - Service plans vary in terms of dedicated CPU, memory (RAM), and storage space allocated for your data store, as well as high-availability configurations for production use cases.
8. Click **Create**.

## Connect to your Choreo-Managed Cache

To connect to your Choreo-Managed Cache, follow these guidelines:

- Use any legacy Redis® OSS compatible driver (in any programming language) to connect to your Choreo-Managed Cache.
- You can find the connection parameters in the **Overview** section in the Choreo Console under the relevant database. Note that Choreo-Managed Cache enforces TLS.
- Choreo-Managed Cache instances accept traffic from the internet by default. You can restrict access to specific IP addresses and CIDR blocks under **Advanced Settings**.

## High availability and automatic backups

The high availability and the automatic backup retention periods for a Choreo-Managed Cache can vary as follows depending on the service plan you select. 

| Service plan | High availability                                                                                                  | Backup features                          | Backup history |
| ------------ | -------------------------------------------------------------------------------------------------------------------| ---------------------------------------- | -------------- |
| Hobbyist     | Single-node with limited availability.                                                                             | Single backup only for disaster recovery | None           |
| Startup      | Single-node with limited availability.                                                                             | Single backup only for disaster recovery | 1 day          |
| Business     | Two-node (primary + standby) with higher availability (automatic failover if the primary node fails).              | Automatic backups                        | 3 days         |
| Premium      | Three-node (primary + standby + standby) with highest availability (automatic failover if the primary node fails). | Automatic backups                        | 13 days        |

In general, service plans are recommended for production scenarios due to the following reasons:

- Provides another physical copy of the data in case of hardware, software, or network failures.
- Reduces the data loss window in disaster scenarios.
- Ensures quicker restoration with controlled failover in case of failures, as the standby is already installed and running.

### Automatic backups

- Choreo runs full backups daily to automatically backup Choreo-Managed Caches and has write-ahead logs (WAL) copied at 5-minute intervals or for every new file generated.
- Choreo encrypts all backups at rest.
- Choreo automatically handles outages and software failures by replacing broken nodes with new ones that resume correctly from the point of failure. The impact of a failure will depend on the number of available standby nodes in the data store.

### Failure recovery

- **Minor failures**: Choreo automatically handles minor failures such as service process crashes or temporary loss of network access in all plans without requiring significant changes to the service deployment. Choreo automatically restores the service to normal operation once it automatically restarts the crashed process or when it restores the network access.

- **Severe failures**: Failures such as losing a node entirely in case of hardware or severe software problems, require more drastic recovery measures. The monitoring infrastructure automatically detects a failing node when the node starts reporting issues in the self-diagnostics or when it stops communicating. In such cases, the monitoring infrastructure automatically schedules a new replacement node to be created.
     - In the event of a data store failover, the service URI of your service remains the same; only the IP address will change to point to the new primary node.
     - Hobbyist and Startup plans provide a single node, and in case of failure, a new node starts up, restores its state from the latest available backup, and resumes serving traffic.
     - As there is just a single/primary node, the caching service becomes unavailable for the duration of the restoration operation. Therefore, all write operations made since the last backup will be lost.

## Limitations

### Connection limits

The number of simultaneous connections in a Choreo-Managed Cache depends on the total available memory on the server instances.

You can use the following to estimate:

```
max_number_of_connections = 4 x m
```

Here, `m` represents the memory in megabytes, where at least 10,000 connections are available, even on the smallest servers.
For example, on a server with 4GB memory (4,096 MB), the simultaneous connections are:

```
4 x 4096 = 16384 // 16k connections
```

This number is estimated by the exact available memory so it can vary between different plans and cloud providers. To see the exact maximum connections allowed, use the \* redis-cli and info command as follows:

```
echo "info" | redis-cli -u REDIS_URI | grep maxclients
```

### Restricted commands

To maintain the stability and security of a managed environment, Choreo restricts certain commands on Choreo-Managed Cache services.

!!! note "Support for Lua scripts on Choreo-Managed Cache"
     - Choreo-Managed Cache has built-in support for running Lua scripts to perform various actions directly on the server. Scripting is typically controlled using the `EVAL`, `EVALSHA`, and `SCRIPT LOAD` commands.
     - For all newly-created cache instances, `EVAL`, `EVALSHA`, and `SCRIPT LOAD` commands are enabled by default.

The following commands are disabled on Choreo:

- `bgrewriteaof`: Initiates a background append-only file rewrite.
- `cluster`: Manages Caching cluster commands.
- `command`: Provides details about all Caching commands.
- `debug`: Contains sub-commands for debugging Caching.
- `failover`: Manages manual failover of a master to a replica.
- `migrate`: Atomically transfers a key from one caching instance to another.
- `role`: Returns the role of the instance in the context of replication.
- `slaveof`: Makes the server a replica of another instance, or promotes it as master.
- `acl`: Manages caching access control lists.
- `bgsave`: Creates a snapshot of the data set into a dump file.
- `config`: Alters the configuration of a running caching server.
- `lastsave`: Returns the UNIX timestamp of the last successful save to disk.
- `monitor`: Streams back every command processed by the Caching server.
- `replicaof`: Makes the server a replica of another instance.
- `save`: Synchronously saves the dataset to disk.
- `shutdown`: Synchronously saves the dataset to disk and then shuts down the server.

The following `eval` commands are also disabled:

- `eval`: Executes a Lua script server-side.
- `eval_ro`: Read-only variant of the eval command.
- `evalsha`: Executes a script cached on the server side by its SHA1 digest.
- `evalsha_ro`: Read-only variant of the evalsha command.
- `fcall`: Calls a Caching function.
- `fcall_ro`: Read-only variant of the fcall command.
- `function`: Manages Caching functions.
- `script`: Manages the script cache.


# Choreo-Managed Databases, Vector Databases, and Caches

Choreo allows you to create PostgreSQL and MySQL databases as well as Choreo-Managed Cache instances on all major cloud providers (AWS, Azure, GCP, and DigitalOcean) as fully Choreo-managed platform services.
These databases and caches can be seamlessly provisioned to offer persistence and caching capabilities for all your Choreo components. Choreo provides various service plans for each type, ranging from smaller instances for development purposes to production-grade databases with automatic backups and high-availability multi-nodes.

!!! info "Note"
     - The capability to create Choreo-managed databases, vector databases, and cache services is available only for paid Choreo users.
     - Billing for these services will be included in your Choreo subscription, with pricing varying based on the service plan of the resources you create. For more details, see [Choreo Platform Services Billing](../references/choreo-platform-services-billing-and-upgrades.md#platform-service-billing-information).

!!!Tip "Explore the free trial"
    Choreo provides a 7-day free trial for all database types on the 'Hobbyist' service plan, available to free-tier users.

## PostgreSQL on Choreo

PostgreSQL (also known as Postgres), is an open-source object-relational database management system. You can create PostgreSQL databases on Choreo as fully Choreo-managed, flexible SQL databases that are ideal for both structured and unstructured data. If you want to perform an efficient vector similarity search, you can create a PostgreSQL vector database.

- [Create a PostgreSQL database on Choreo](./choreo-managed-postgresql-databases.md)

## MySQL on Choreo

MySQL is a user-friendly, flexible, open-source relational database management system with a well-established history in the SQL database realm. Choreo allows you to swiftly create fully Choreo-managed MySQL databases, enabling rapid setup and utilization.

- [Create a MySQL database on Choreo](./choreo-managed-mysql-databases.md)

## Choreo-Managed Cache

A fully-managed cache compatible with legacy Redis® OSS. A versatile, in-memory NoSQL database that serves as a cache, database, streaming engine, and message broker. Choreo-managed Cache allows you to have fully-managed instances that can be swiftly provisioned and integrated into your applications within minutes.

- [Create a Choreo-managed Cache](./choreo-managed-caches.md)

<span style="font-size: 11px; color:gray;">
 PostgreSQL, MySQL, and Redis® are trademarks and property of their respective owners. All product and service names used in this documentation are for identification purposes only. 
</span>


# Choreo-managed MySQL Databases

MySQL on Choreo offers fully managed, flexible relational databases on AWS, Azure, GCP, and Digital Ocean.

## Create a Choreo-managed MySQL database

Follow the steps below to create a Choreo-managed MySQL database: 

1. From the environment list on the header, located next to the **Deployment Tracks** list, select your **Organization**.
2. In the left navigation menu, click **Dependencies** and then **Databases**.
3. Click **Create** and select **MySQL** as the database type. Provide a display name for this server and follow the instructions.
4. Select your preferred cloud provider from AWS, Azure, GCP, and Digital Ocean.
  - Choreo uses the cloud provider to provision the compute and storage infrastructure for your database.
  - There is no functional difference between databases created on different cloud providers, apart from changes to service plans (and associated costs). 
5. Choose the region for your database.
  - Available regions will depend on the selected cloud provider. Choreo currently supports US and EU regions across all providers.
6. Select the service plan.
  - Service plans vary in the dedicated CPU, memory (RAM), storage space allocated for your database, the backup retention periods, and high-availability configurations for production use cases.

## Connect to your Choreo-managed MySQL database

To connect to your Choreo-managed MySQL database, consider the following guidelines:

- You can use any MySQL driver, ORM, or supported generic SQL library (may depend on the programming language) to connect to the database.
- You can find the connection parameters in the **Overview** section in the Choreo Console under the relevant database.
- MySQL databases accept traffic from the internet by default. You can restrict access to specific IP addresses and CIDR blocks under **Advanced Settings**.

## High Availability and Automatic Backups

The high availability characteristics and the automatic backup retention periods for Choreo-managed MySQL databases vary based on your service plan as explained below:

| Service Plan | High Availability                                                  | Backup Retention Time |
|--------------|--------------------------------------------------------------------|-----------------------|
| Hobbyist     | Single-node with limited availability                              | None                  |
| Startup      | Single-node with limited availability                              | 2 days                |
| Business     | Two-node (primary + standby) with higher availability              | 14 days               |
| Premium      | Three-node (primary + standby + standby) with highest availability | 30 days               |

In general, we recommend service plans for production scenarios for multiple reasons:
- Provides another physical copy of the data in case of hardware, software, or network failures.
- Typically reduces the data loss window in disaster scenarios.
- Provides a quicker time to restore with a controlled failover in case of failures, as the standby is already installed and running.

### Automatic Backups

- Choreo runs full backups daily to automatically back up Choreo-managed MySQL databases and record binary logs continuously.
Choreo encrypts all backups at rest.

- Choreo automatically handles outages and software failures by replacing broken nodes with new ones that resume correctly from the point of failure. The impact of a failure will depend on the number of available standby nodes in the database.

## Connection Limits

The maximum number of simultaneous connections to MySQL databases is fixed for each service plan and depends on how much RAM your service plan offers.

!!! note
    An `extra_connection` with a value of `1` is added for system processes for all MySQL databases, regardless of the service plan.

### For plans under 4 GiB RAM

For plans under 4 GiB of RAM, the number of allowed connections is `75` per GiB:

```
max_connections = 75 x RAM + extra_connection
```

### For plans with over 4 GiB RAM:

For plans with 4 GiB or more RAM, the number of allowed connections is `100` per GiB:

```
max_connections = 100 x RAM + extra_connection
```


# Choreo-Managed PostgreSQL Databases and Vector Databases

PostgreSQL on Choreo offers fully Choreo-managed, efficient object-relational databases on AWS, Azure, GCP, and Digital Ocean. Additionally, Choreo allows you to create fully-managed PostgreSQL vector databases if you want to perform efficient vector similarity search.

## Create a Choreo-managed PostgreSQL database

Follow the steps below to create a Choreo-managed PostgreSQL database: 

1. Sign in to the Choreo Console at [https://console.choreo.dev/](https://console.choreo.dev/).
2. In the header, click the **Organization** list. This opens the organization home page.
3. In the left navigation menu, click **Dependencies** and then **Databases**.
4. Click **Create** and select **PostgreSQL** as the database type. Provide a display name for this server and follow the instructions.
5. Select your preferred cloud provider from AWS, Azure, GCP, or Digital Ocean.
    - The cloud provider is used to provision the compute and storage infrastructure for your database.
    - There is no functional difference between databases created on different cloud providers, apart from changes to service plans (and associated costs). 
6. Choose the region for your database.
   - Available regions will depend on the selected cloud provider. Choreo currently supports US and EU regions across all providers.
7. Select the service plan.
   - Service plans vary in the dedicated CPU, memory (RAM), storage space allocated for your database, the backup retention periods, and high-availability configurations for production use cases.

## Create a Choreo-managed PostgreSQL vector database

Follow the steps below to create a Choreo-managed PostgreSQL vector database: 

1. Sign in to the Choreo Console at [https://console.choreo.dev/](https://console.choreo.dev/).
2. In the header, click the **Organization** list. This opens the organization home page.
3. In the left navigation menu, click **Dependencies** and then **Vector Databases**.
4. Follow steps 4 onwards in the [Create a Choreo-managed PostgreSQL database](#create-a-choreo-managed-postgresql-database) section.

## Connecting to your Choreo-managed PostgreSQL database

To connect to your Choreo-managed PostgreSQL database, consider the following guidelines:

- You can use any PostgreSQL driver, ORM, or supported generic SQL library (may depend on the programming language) to connect to the database.
- The connection parameters can be found in the **Overview** section in the Choreo Console under the relevant database.
- PostgreSQL databases accept traffic from the internet by default. You can restrict access to specific IP addresses and CIDR blocks under **Advanced Settings**.


## High Availability and Automatic Backups

The high availability characteristics and the automatic backup retention periods for Choreo-managed PostgreSQL databases vary based on the selected service plan as shown below.

| Service Plan | High Availability                                                  | Backup Retention Time |
|--------------|--------------------------------------------------------------------|-----------------------|
| Hobbyist     | Single-node with limited availability                              | None                  |
| Startup      | Single-node with limited availability                              | 2 days                |
| Business     | Two-node (primary + standby) with higher availability              | 14 days               |
| Premium      | Three-node (primary + standby + standby) with highest availability | 30 days               |

Service plans with standby nodes are generally recommended for production scenarios for multiple reasons:
- Provides another physical copy of the data in case of hardware, software, or network failures.
- Typically reduces the data loss window in disaster scenarios.
- Provides a quicker time to restore with a controlled failover in case of failures, as the standby is already installed and running.

### Automatic Backups


- Choreo runs full backups daily to automatically back up Choreo-managed PostgreSQL databases and copies the write-ahead logs (WAL)  at 5-minute intervals or for every new file generated.
Choreo encrypts all backups at rest.

- Choreo automatically handles outages and software failures by replacing broken nodes with new ones that resume correctly from the point of failure. The impact of a failure will depend on the number of available standby nodes in the database.

### Failure Recovery

- **Minor failures**: Choreo automatically handles minor failures such as service process crashes or temporary loss of network access in all plans without requiring significant changes to the service deployment. Choreo automatically restores the service to normal operation once Choreo automatically restarts the crashed process or when Choreo restores the network access.

- **Severe failures**: To handle severe failures such as losing a node entirely in case of hardware or severe software problems, requires more drastic recovery measures. The monitoring infrastructure automatically detects a failing node, both when the node starts reporting issues in the self-diagnostics or when it stops communicating. In such cases, the monitoring infrastructure automatically schedules a new replacement node to be created.
> - In the event of database failover, the Service URI of your service remains the same; only the IP address will change to point to the new primary node.
> - Hobbyist and Startup plan provide a single node, and in case of failure, a new node starts up, restores its state from the latest available backup, and resumes serving traffic.
In this plan, as there is just a single node providing the service, the service will become unavailable for the duration of the restoration. In addition, any write operations made since the backup of the latest WAL file will be lost. Typically, this time window is limited to either five minutes of time or one WAL file.

## Connection limits

The following connection limits apply to Choreo-managed PostgreSQL databases based on the selected service plan.

| Service Plan               | Max Connections |
|----------------------------|-----------------|
| Hobbyist                   | 25              |
| Startup/Business/Premium-4 | 100             |
| Business-16                | 400             |
| Premium-8                  | 200             |


 # Add Choreo-Managed Databases and Caches to the Marketplace

When you create a Choreo-managed database or cache, you can add it to the Marketplace, making it available for consumption through a connection.

!!! note 
     To add a Choreo-managed database or cache to the Marketplace, you must import at least one credential for it.

## Step 1: Import credentials

To import credentials, you can either use the default super admin credentials or the credentials you create using the super admin credentials. When you create a database or cache server, super admin credentials are generated by default. You can use these super admin credentials to create new user credentials. The steps to create new user credentials depend on the type of database or cache you are using.

You can use the imported credentials to create a connection. During connection setup, you must select credentials for each database from the list of available credentials.

To import credentials for a database, follow these steps:

1. Sign in to the [Choreo Console](https://console.choreo.dev/).
2. Go to the Choreo Console header and select your organization from the **Organization** list.
3. In the left navigation menu, click **Dependencies** and then click **Databases**.
4. Click on a required database to view its details.
5. Click the **Databases** tab.
6. Click to expand the database for which you want to import credentials, then click **Import Credentials**.
7. In the **Import Credentials** dialog, do one of the following depending on your requirements:

    - Select **Use Created Credentials** and specify the following:
         - A display name for the credentials.
         - The database credentials you created to use when setting up database connections in Choreo. 
         - The environment where you want to use the credentials. 
         
         The steps to create new user credentials depend on the type of database or cache you are using. In general, you must log in to your database server as the super admin using a command-line interface or a database management tool. Then, create new database users with the required permission levels.

    - Select **Use Super Admin Credentials** and specify the following:
         - A display name for the credentials. 
         - The environment where you want to use the credentials.

8. Click **Save**.

!!! tip 
     Choreo allows you to delete imported credentials to prevent their use when establishing new connections. However, deleting credentials will not affect any existing database connections that are already using them.

## Step 2: Add the database or cache to the Marketplace

- On the **Databases** tab, click **+Add to Marketplace** corresponding to the database you want to add. 

Once the database is added to the Marketplace, it can be consumed via a connection. For details on creating a connection to a Choreo-managed database, see [Create a connection to a database](../develop-components/sharing-and-reusing/create-a-connection.md).

!!! note 
     To remove a database or cache that you added to the Marketplace, click the corresponding **Remove from Marketplace**. This action prevents new connections to the removed database, but existing connections remain unaffected.

For details on using a database connection in your component, see [Use a Database Connection in Your Component](../develop-components/sharing-and-reusing/use-a-database-connection-in-your-component.md).


# Choreo-Managed Cache

Fully compatible with legacy Redis® OSS.

Choreo-Managed Cache provides fully-managed in-memory NoSQL databases on AWS, Azure, GCP, and Digital Ocean and can be used as a cache, database, streaming engine, or message broker.

## Create a Choreo-Managed Cache

Follow the steps below to create a Choreo-Managed Cache:

1. Sign in to the Choreo Console at [https://console.choreo.dev/](https://console.choreo.dev).
2. In the header, click the **Organization** list. This opens the organization home page.
3. In the left navigation menu, click **Dependencies** and then click **Databases**.
4. Click **+ Create** and select **Choreo-Managed Cache** as the data store type. Provide a display name for this server and follow the instructions.
5. Select a preferred cloud provider (AWS, Azure, GCP, or Digital Ocean).
    - The cloud provider provisions the compute and storage infrastructure for your data store.
    - The functionality remains the same across cloud providers, though service plans and costs may differ.
6. Select a region for your data store.
    - Available regions depend on the selected cloud provider. Choreo currently supports US and EU regions across all providers.
7. Select a service plan.
    - Service plans vary in terms of dedicated CPU, memory (RAM), and storage space allocated for your data store, as well as high-availability configurations for production use cases.
8. Click **Create**.

## Connect to your Choreo-Managed Cache

To connect to your Choreo-Managed Cache, follow these guidelines:

- Use any legacy Redis® OSS compatible driver (in any programming language) to connect to your Choreo-Managed Cache.
- You can find the connection parameters in the **Overview** section in the Choreo Console under the relevant database. Note that Choreo-Managed Cache enforces TLS.
- Choreo-Managed Cache instances accept traffic from the internet by default. You can restrict access to specific IP addresses and CIDR blocks under **Advanced Settings**.

## High availability and automatic backups

The high availability and the automatic backup retention periods for a Choreo-Managed Cache can vary as follows depending on the service plan you select. 

| Service plan | High availability                                                                                                  | Backup features                          | Backup history |
| ------------ | -------------------------------------------------------------------------------------------------------------------| ---------------------------------------- | -------------- |
| Hobbyist     | Single-node with limited availability.                                                                             | Single backup only for disaster recovery | None           |
| Startup      | Single-node with limited availability.                                                                             | Single backup only for disaster recovery | 1 day          |
| Business     | Two-node (primary + standby) with higher availability (automatic failover if the primary node fails).              | Automatic backups                        | 3 days         |
| Premium      | Three-node (primary + standby + standby) with highest availability (automatic failover if the primary node fails). | Automatic backups                        | 13 days        |

In general, service plans are recommended for production scenarios due to the following reasons:

- Provides another physical copy of the data in case of hardware, software, or network failures.
- Reduces the data loss window in disaster scenarios.
- Ensures quicker restoration with controlled failover in case of failures, as the standby is already installed and running.

### Automatic backups

- Choreo runs full backups daily to automatically backup Choreo-Managed Caches and has write-ahead logs (WAL) copied at 5-minute intervals or for every new file generated.
- Choreo encrypts all backups at rest.
- Choreo automatically handles outages and software failures by replacing broken nodes with new ones that resume correctly from the point of failure. The impact of a failure will depend on the number of available standby nodes in the data store.

### Failure recovery

- **Minor failures**: Choreo automatically handles minor failures such as service process crashes or temporary loss of network access in all plans without requiring significant changes to the service deployment. Choreo automatically restores the service to normal operation once it automatically restarts the crashed process or when it restores the network access.

- **Severe failures**: Failures such as losing a node entirely in case of hardware or severe software problems, require more drastic recovery measures. The monitoring infrastructure automatically detects a failing node when the node starts reporting issues in the self-diagnostics or when it stops communicating. In such cases, the monitoring infrastructure automatically schedules a new replacement node to be created.
     - In the event of a data store failover, the service URI of your service remains the same; only the IP address will change to point to the new primary node.
     - Hobbyist and Startup plans provide a single node, and in case of failure, a new node starts up, restores its state from the latest available backup, and resumes serving traffic.
     - As there is just a single/primary node, the caching service becomes unavailable for the duration of the restoration operation. Therefore, all write operations made since the last backup will be lost.

## Limitations

### Connection limits

The number of simultaneous connections in a Choreo-Managed Cache depends on the total available memory on the server instances.

You can use the following to estimate:

```
max_number_of_connections = 4 x m
```

Here, `m` represents the memory in megabytes, where at least 10,000 connections are available, even on the smallest servers.
For example, on a server with 4GB memory (4,096 MB), the simultaneous connections are:

```
4 x 4096 = 16384 // 16k connections
```

This number is estimated by the exact available memory so it can vary between different plans and cloud providers. To see the exact maximum connections allowed, use the \* redis-cli and info command as follows:

```
echo "info" | redis-cli -u REDIS_URI | grep maxclients
```

### Restricted commands

To maintain the stability and security of a managed environment, Choreo restricts certain commands on Choreo-Managed Cache services.

!!! note "Support for Lua scripts on Choreo-Managed Cache"
     - Choreo-Managed Cache has built-in support for running Lua scripts to perform various actions directly on the server. Scripting is typically controlled using the `EVAL`, `EVALSHA`, and `SCRIPT LOAD` commands.
     - For all newly-created cache instances, `EVAL`, `EVALSHA`, and `SCRIPT LOAD` commands are enabled by default.

The following commands are disabled on Choreo:

- `bgrewriteaof`: Initiates a background append-only file rewrite.
- `cluster`: Manages Caching cluster commands.
- `command`: Provides details about all Caching commands.
- `debug`: Contains sub-commands for debugging Caching.
- `failover`: Manages manual failover of a master to a replica.
- `migrate`: Atomically transfers a key from one caching instance to another.
- `role`: Returns the role of the instance in the context of replication.
- `slaveof`: Makes the server a replica of another instance, or promotes it as master.
- `acl`: Manages caching access control lists.
- `bgsave`: Creates a snapshot of the data set into a dump file.
- `config`: Alters the configuration of a running caching server.
- `lastsave`: Returns the UNIX timestamp of the last successful save to disk.
- `monitor`: Streams back every command processed by the Caching server.
- `replicaof`: Makes the server a replica of another instance.
- `save`: Synchronously saves the dataset to disk.
- `shutdown`: Synchronously saves the dataset to disk and then shuts down the server.

The following `eval` commands are also disabled:

- `eval`: Executes a Lua script server-side.
- `eval_ro`: Read-only variant of the eval command.
- `evalsha`: Executes a script cached on the server side by its SHA1 digest.
- `evalsha_ro`: Read-only variant of the evalsha command.
- `fcall`: Calls a Caching function.
- `fcall_ro`: Read-only variant of the fcall command.
- `function`: Manages Caching functions.
- `script`: Manages the script cache.


# Choreo-Managed Databases, Vector Databases, and Caches

Choreo allows you to create PostgreSQL and MySQL databases as well as Choreo-Managed Cache instances on all major cloud providers (AWS, Azure, GCP, and DigitalOcean) as fully Choreo-managed platform services.
These databases and caches can be seamlessly provisioned to offer persistence and caching capabilities for all your Choreo components. Choreo provides various service plans for each type, ranging from smaller instances for development purposes to production-grade databases with automatic backups and high-availability multi-nodes.

!!! info "Note"
     - The capability to create Choreo-managed databases, vector databases, and cache services is available only for paid Choreo users.
     - Billing for these services will be included in your Choreo subscription, with pricing varying based on the service plan of the resources you create. For more details, see [Choreo Platform Services Billing](../references/choreo-platform-services-billing-and-upgrades.md#platform-service-billing-information).

!!!Tip "Explore the free trial"
    Choreo provides a 7-day free trial for all database types on the 'Hobbyist' service plan, available to free-tier users.

## PostgreSQL on Choreo

PostgreSQL (also known as Postgres), is an open-source object-relational database management system. You can create PostgreSQL databases on Choreo as fully Choreo-managed, flexible SQL databases that are ideal for both structured and unstructured data. If you want to perform an efficient vector similarity search, you can create a PostgreSQL vector database.

- [Create a PostgreSQL database on Choreo](./choreo-managed-postgresql-databases.md)

## MySQL on Choreo

MySQL is a user-friendly, flexible, open-source relational database management system with a well-established history in the SQL database realm. Choreo allows you to swiftly create fully Choreo-managed MySQL databases, enabling rapid setup and utilization.

- [Create a MySQL database on Choreo](./choreo-managed-mysql-databases.md)

## Choreo-Managed Cache

A fully-managed cache compatible with legacy Redis® OSS. A versatile, in-memory NoSQL database that serves as a cache, database, streaming engine, and message broker. Choreo-managed Cache allows you to have fully-managed instances that can be swiftly provisioned and integrated into your applications within minutes.

- [Create a Choreo-managed Cache](./choreo-managed-caches.md)

<span style="font-size: 11px; color:gray;">
 PostgreSQL, MySQL, and Redis® are trademarks and property of their respective owners. All product and service names used in this documentation are for identification purposes only. 
</span>


# Choreo-managed MySQL Databases

MySQL on Choreo offers fully managed, flexible relational databases on AWS, Azure, GCP, and Digital Ocean.

## Create a Choreo-managed MySQL database

Follow the steps below to create a Choreo-managed MySQL database: 

1. From the environment list on the header, located next to the **Deployment Tracks** list, select your **Organization**.
2. In the left navigation menu, click **Dependencies** and then **Databases**.
3. Click **Create** and select **MySQL** as the database type. Provide a display name for this server and follow the instructions.
4. Select your preferred cloud provider from AWS, Azure, GCP, and Digital Ocean.
  - Choreo uses the cloud provider to provision the compute and storage infrastructure for your database.
  - There is no functional difference between databases created on different cloud providers, apart from changes to service plans (and associated costs). 
5. Choose the region for your database.
  - Available regions will depend on the selected cloud provider. Choreo currently supports US and EU regions across all providers.
6. Select the service plan.
  - Service plans vary in the dedicated CPU, memory (RAM), storage space allocated for your database, the backup retention periods, and high-availability configurations for production use cases.

## Connect to your Choreo-managed MySQL database

To connect to your Choreo-managed MySQL database, consider the following guidelines:

- You can use any MySQL driver, ORM, or supported generic SQL library (may depend on the programming language) to connect to the database.
- You can find the connection parameters in the **Overview** section in the Choreo Console under the relevant database.
- MySQL databases accept traffic from the internet by default. You can restrict access to specific IP addresses and CIDR blocks under **Advanced Settings**.

## High Availability and Automatic Backups

The high availability characteristics and the automatic backup retention periods for Choreo-managed MySQL databases vary based on your service plan as explained below:

| Service Plan | High Availability                                                  | Backup Retention Time |
|--------------|--------------------------------------------------------------------|-----------------------|
| Hobbyist     | Single-node with limited availability                              | None                  |
| Startup      | Single-node with limited availability                              | 2 days                |
| Business     | Two-node (primary + standby) with higher availability              | 14 days               |
| Premium      | Three-node (primary + standby + standby) with highest availability | 30 days               |

In general, we recommend service plans for production scenarios for multiple reasons:
- Provides another physical copy of the data in case of hardware, software, or network failures.
- Typically reduces the data loss window in disaster scenarios.
- Provides a quicker time to restore with a controlled failover in case of failures, as the standby is already installed and running.

### Automatic Backups

- Choreo runs full backups daily to automatically back up Choreo-managed MySQL databases and record binary logs continuously.
Choreo encrypts all backups at rest.

- Choreo automatically handles outages and software failures by replacing broken nodes with new ones that resume correctly from the point of failure. The impact of a failure will depend on the number of available standby nodes in the database.

## Connection Limits

The maximum number of simultaneous connections to MySQL databases is fixed for each service plan and depends on how much RAM your service plan offers.

!!! note
    An `extra_connection` with a value of `1` is added for system processes for all MySQL databases, regardless of the service plan.

### For plans under 4 GiB RAM

For plans under 4 GiB of RAM, the number of allowed connections is `75` per GiB:

```
max_connections = 75 x RAM + extra_connection
```

### For plans with over 4 GiB RAM:

For plans with 4 GiB or more RAM, the number of allowed connections is `100` per GiB:

```
max_connections = 100 x RAM + extra_connection
```


# Choreo-Managed PostgreSQL Databases and Vector Databases

PostgreSQL on Choreo offers fully Choreo-managed, efficient object-relational databases on AWS, Azure, GCP, and Digital Ocean. Additionally, Choreo allows you to create fully-managed PostgreSQL vector databases if you want to perform efficient vector similarity search.

## Create a Choreo-managed PostgreSQL database

Follow the steps below to create a Choreo-managed PostgreSQL database: 

1. Sign in to the Choreo Console at [https://console.choreo.dev/](https://console.choreo.dev/).
2. In the header, click the **Organization** list. This opens the organization home page.
3. In the left navigation menu, click **Dependencies** and then **Databases**.
4. Click **Create** and select **PostgreSQL** as the database type. Provide a display name for this server and follow the instructions.
5. Select your preferred cloud provider from AWS, Azure, GCP, or Digital Ocean.
    - The cloud provider is used to provision the compute and storage infrastructure for your database.
    - There is no functional difference between databases created on different cloud providers, apart from changes to service plans (and associated costs). 
6. Choose the region for your database.
   - Available regions will depend on the selected cloud provider. Choreo currently supports US and EU regions across all providers.
7. Select the service plan.
   - Service plans vary in the dedicated CPU, memory (RAM), storage space allocated for your database, the backup retention periods, and high-availability configurations for production use cases.

## Create a Choreo-managed PostgreSQL vector database

Follow the steps below to create a Choreo-managed PostgreSQL vector database: 

1. Sign in to the Choreo Console at [https://console.choreo.dev/](https://console.choreo.dev/).
2. In the header, click the **Organization** list. This opens the organization home page.
3. In the left navigation menu, click **Dependencies** and then **Vector Databases**.
4. Follow steps 4 onwards in the [Create a Choreo-managed PostgreSQL database](#create-a-choreo-managed-postgresql-database) section.

## Connecting to your Choreo-managed PostgreSQL database

To connect to your Choreo-managed PostgreSQL database, consider the following guidelines:

- You can use any PostgreSQL driver, ORM, or supported generic SQL library (may depend on the programming language) to connect to the database.
- The connection parameters can be found in the **Overview** section in the Choreo Console under the relevant database.
- PostgreSQL databases accept traffic from the internet by default. You can restrict access to specific IP addresses and CIDR blocks under **Advanced Settings**.


## High Availability and Automatic Backups

The high availability characteristics and the automatic backup retention periods for Choreo-managed PostgreSQL databases vary based on the selected service plan as shown below.

| Service Plan | High Availability                                                  | Backup Retention Time |
|--------------|--------------------------------------------------------------------|-----------------------|
| Hobbyist     | Single-node with limited availability                              | None                  |
| Startup      | Single-node with limited availability                              | 2 days                |
| Business     | Two-node (primary + standby) with higher availability              | 14 days               |
| Premium      | Three-node (primary + standby + standby) with highest availability | 30 days               |

Service plans with standby nodes are generally recommended for production scenarios for multiple reasons:
- Provides another physical copy of the data in case of hardware, software, or network failures.
- Typically reduces the data loss window in disaster scenarios.
- Provides a quicker time to restore with a controlled failover in case of failures, as the standby is already installed and running.

### Automatic Backups


- Choreo runs full backups daily to automatically back up Choreo-managed PostgreSQL databases and copies the write-ahead logs (WAL)  at 5-minute intervals or for every new file generated.
Choreo encrypts all backups at rest.

- Choreo automatically handles outages and software failures by replacing broken nodes with new ones that resume correctly from the point of failure. The impact of a failure will depend on the number of available standby nodes in the database.

### Failure Recovery

- **Minor failures**: Choreo automatically handles minor failures such as service process crashes or temporary loss of network access in all plans without requiring significant changes to the service deployment. Choreo automatically restores the service to normal operation once Choreo automatically restarts the crashed process or when Choreo restores the network access.

- **Severe failures**: To handle severe failures such as losing a node entirely in case of hardware or severe software problems, requires more drastic recovery measures. The monitoring infrastructure automatically detects a failing node, both when the node starts reporting issues in the self-diagnostics or when it stops communicating. In such cases, the monitoring infrastructure automatically schedules a new replacement node to be created.
> - In the event of database failover, the Service URI of your service remains the same; only the IP address will change to point to the new primary node.
> - Hobbyist and Startup plan provide a single node, and in case of failure, a new node starts up, restores its state from the latest available backup, and resumes serving traffic.
In this plan, as there is just a single node providing the service, the service will become unavailable for the duration of the restoration. In addition, any write operations made since the backup of the latest WAL file will be lost. Typically, this time window is limited to either five minutes of time or one WAL file.

## Connection limits

The following connection limits apply to Choreo-managed PostgreSQL databases based on the selected service plan.

| Service Plan               | Max Connections |
|----------------------------|-----------------|
| Hobbyist                   | 25              |
| Startup/Business/Premium-4 | 100             |
| Business-16                | 400             |
| Premium-8                  | 200             |


 # Add Choreo-Managed Databases and Caches to the Marketplace

When you create a Choreo-managed database or cache, you can add it to the Marketplace, making it available for consumption through a connection.

!!! note 
     To add a Choreo-managed database or cache to the Marketplace, you must import at least one credential for it.

## Step 1: Import credentials

To import credentials, you can either use the default super admin credentials or the credentials you create using the super admin credentials. When you create a database or cache server, super admin credentials are generated by default. You can use these super admin credentials to create new user credentials. The steps to create new user credentials depend on the type of database or cache you are using.

You can use the imported credentials to create a connection. During connection setup, you must select credentials for each database from the list of available credentials.

To import credentials for a database, follow these steps:

1. Sign in to the [Choreo Console](https://console.choreo.dev/).
2. Go to the Choreo Console header and select your organization from the **Organization** list.
3. In the left navigation menu, click **Dependencies** and then click **Databases**.
4. Click on a required database to view its details.
5. Click the **Databases** tab.
6. Click to expand the database for which you want to import credentials, then click **Import Credentials**.
7. In the **Import Credentials** dialog, do one of the following depending on your requirements:

    - Select **Use Created Credentials** and specify the following:
         - A display name for the credentials.
         - The database credentials you created to use when setting up database connections in Choreo. 
         - The environment where you want to use the credentials. 
         
         The steps to create new user credentials depend on the type of database or cache you are using. In general, you must log in to your database server as the super admin using a command-line interface or a database management tool. Then, create new database users with the required permission levels.

    - Select **Use Super Admin Credentials** and specify the following:
         - A display name for the credentials. 
         - The environment where you want to use the credentials.

8. Click **Save**.

!!! tip 
     Choreo allows you to delete imported credentials to prevent their use when establishing new connections. However, deleting credentials will not affect any existing database connections that are already using them.

## Step 2: Add the database or cache to the Marketplace

- On the **Databases** tab, click **+Add to Marketplace** corresponding to the database you want to add. 

Once the database is added to the Marketplace, it can be consumed via a connection. For details on creating a connection to a Choreo-managed database, see [Create a connection to a database](../develop-components/sharing-and-reusing/create-a-connection.md).

!!! note 
     To remove a database or cache that you added to the Marketplace, click the corresponding **Remove from Marketplace**. This action prevents new connections to the removed database, but existing connections remain unaffected.

For details on using a database connection in your component, see [Use a Database Connection in Your Component](../develop-components/sharing-and-reusing/use-a-database-connection-in-your-component.md).


# Choreo-Managed Cache

Fully compatible with legacy Redis® OSS.

Choreo-Managed Cache provides fully-managed in-memory NoSQL databases on AWS, Azure, GCP, and Digital Ocean and can be used as a cache, database, streaming engine, or message broker.

## Create a Choreo-Managed Cache

Follow the steps below to create a Choreo-Managed Cache:

1. Sign in to the Choreo Console at [https://console.choreo.dev/](https://console.choreo.dev).
2. In the header, click the **Organization** list. This opens the organization home page.
3. In the left navigation menu, click **Dependencies** and then click **Databases**.
4. Click **+ Create** and select **Choreo-Managed Cache** as the data store type. Provide a display name for this server and follow the instructions.
5. Select a preferred cloud provider (AWS, Azure, GCP, or Digital Ocean).
    - The cloud provider provisions the compute and storage infrastructure for your data store.
    - The functionality remains the same across cloud providers, though service plans and costs may differ.
6. Select a region for your data store.
    - Available regions depend on the selected cloud provider. Choreo currently supports US and EU regions across all providers.
7. Select a service plan.
    - Service plans vary in terms of dedicated CPU, memory (RAM), and storage space allocated for your data store, as well as high-availability configurations for production use cases.
8. Click **Create**.

## Connect to your Choreo-Managed Cache

To connect to your Choreo-Managed Cache, follow these guidelines:

- Use any legacy Redis® OSS compatible driver (in any programming language) to connect to your Choreo-Managed Cache.
- You can find the connection parameters in the **Overview** section in the Choreo Console under the relevant database. Note that Choreo-Managed Cache enforces TLS.
- Choreo-Managed Cache instances accept traffic from the internet by default. You can restrict access to specific IP addresses and CIDR blocks under **Advanced Settings**.

## High availability and automatic backups

The high availability and the automatic backup retention periods for a Choreo-Managed Cache can vary as follows depending on the service plan you select. 

| Service plan | High availability                                                                                                  | Backup features                          | Backup history |
| ------------ | -------------------------------------------------------------------------------------------------------------------| ---------------------------------------- | -------------- |
| Hobbyist     | Single-node with limited availability.                                                                             | Single backup only for disaster recovery | None           |
| Startup      | Single-node with limited availability.                                                                             | Single backup only for disaster recovery | 1 day          |
| Business     | Two-node (primary + standby) with higher availability (automatic failover if the primary node fails).              | Automatic backups                        | 3 days         |
| Premium      | Three-node (primary + standby + standby) with highest availability (automatic failover if the primary node fails). | Automatic backups                        | 13 days        |

In general, service plans are recommended for production scenarios due to the following reasons:

- Provides another physical copy of the data in case of hardware, software, or network failures.
- Reduces the data loss window in disaster scenarios.
- Ensures quicker restoration with controlled failover in case of failures, as the standby is already installed and running.

### Automatic backups

- Choreo runs full backups daily to automatically backup Choreo-Managed Caches and has write-ahead logs (WAL) copied at 5-minute intervals or for every new file generated.
- Choreo encrypts all backups at rest.
- Choreo automatically handles outages and software failures by replacing broken nodes with new ones that resume correctly from the point of failure. The impact of a failure will depend on the number of available standby nodes in the data store.

### Failure recovery

- **Minor failures**: Choreo automatically handles minor failures such as service process crashes or temporary loss of network access in all plans without requiring significant changes to the service deployment. Choreo automatically restores the service to normal operation once it automatically restarts the crashed process or when it restores the network access.

- **Severe failures**: Failures such as losing a node entirely in case of hardware or severe software problems, require more drastic recovery measures. The monitoring infrastructure automatically detects a failing node when the node starts reporting issues in the self-diagnostics or when it stops communicating. In such cases, the monitoring infrastructure automatically schedules a new replacement node to be created.
     - In the event of a data store failover, the service URI of your service remains the same; only the IP address will change to point to the new primary node.
     - Hobbyist and Startup plans provide a single node, and in case of failure, a new node starts up, restores its state from the latest available backup, and resumes serving traffic.
     - As there is just a single/primary node, the caching service becomes unavailable for the duration of the restoration operation. Therefore, all write operations made since the last backup will be lost.

## Limitations

### Connection limits

The number of simultaneous connections in a Choreo-Managed Cache depends on the total available memory on the server instances.

You can use the following to estimate:

```
max_number_of_connections = 4 x m
```

Here, `m` represents the memory in megabytes, where at least 10,000 connections are available, even on the smallest servers.
For example, on a server with 4GB memory (4,096 MB), the simultaneous connections are:

```
4 x 4096 = 16384 // 16k connections
```

This number is estimated by the exact available memory so it can vary between different plans and cloud providers. To see the exact maximum connections allowed, use the \* redis-cli and info command as follows:

```
echo "info" | redis-cli -u REDIS_URI | grep maxclients
```

### Restricted commands

To maintain the stability and security of a managed environment, Choreo restricts certain commands on Choreo-Managed Cache services.

!!! note "Support for Lua scripts on Choreo-Managed Cache"
     - Choreo-Managed Cache has built-in support for running Lua scripts to perform various actions directly on the server. Scripting is typically controlled using the `EVAL`, `EVALSHA`, and `SCRIPT LOAD` commands.
     - For all newly-created cache instances, `EVAL`, `EVALSHA`, and `SCRIPT LOAD` commands are enabled by default.

The following commands are disabled on Choreo:

- `bgrewriteaof`: Initiates a background append-only file rewrite.
- `cluster`: Manages Caching cluster commands.
- `command`: Provides details about all Caching commands.
- `debug`: Contains sub-commands for debugging Caching.
- `failover`: Manages manual failover of a master to a replica.
- `migrate`: Atomically transfers a key from one caching instance to another.
- `role`: Returns the role of the instance in the context of replication.
- `slaveof`: Makes the server a replica of another instance, or promotes it as master.
- `acl`: Manages caching access control lists.
- `bgsave`: Creates a snapshot of the data set into a dump file.
- `config`: Alters the configuration of a running caching server.
- `lastsave`: Returns the UNIX timestamp of the last successful save to disk.
- `monitor`: Streams back every command processed by the Caching server.
- `replicaof`: Makes the server a replica of another instance.
- `save`: Synchronously saves the dataset to disk.
- `shutdown`: Synchronously saves the dataset to disk and then shuts down the server.

The following `eval` commands are also disabled:

- `eval`: Executes a Lua script server-side.
- `eval_ro`: Read-only variant of the eval command.
- `evalsha`: Executes a script cached on the server side by its SHA1 digest.
- `evalsha_ro`: Read-only variant of the evalsha command.
- `fcall`: Calls a Caching function.
- `fcall_ro`: Read-only variant of the fcall command.
- `function`: Manages Caching functions.
- `script`: Manages the script cache.


# Choreo-Managed Databases, Vector Databases, and Caches

Choreo allows you to create PostgreSQL and MySQL databases as well as Choreo-Managed Cache instances on all major cloud providers (AWS, Azure, GCP, and DigitalOcean) as fully Choreo-managed platform services.
These databases and caches can be seamlessly provisioned to offer persistence and caching capabilities for all your Choreo components. Choreo provides various service plans for each type, ranging from smaller instances for development purposes to production-grade databases with automatic backups and high-availability multi-nodes.

!!! info "Note"
     - The capability to create Choreo-managed databases, vector databases, and cache services is available only for paid Choreo users.
     - Billing for these services will be included in your Choreo subscription, with pricing varying based on the service plan of the resources you create. For more details, see [Choreo Platform Services Billing](../references/choreo-platform-services-billing-and-upgrades.md#platform-service-billing-information).

!!!Tip "Explore the free trial"
    Choreo provides a 7-day free trial for all database types on the 'Hobbyist' service plan, available to free-tier users.

## PostgreSQL on Choreo

PostgreSQL (also known as Postgres), is an open-source object-relational database management system. You can create PostgreSQL databases on Choreo as fully Choreo-managed, flexible SQL databases that are ideal for both structured and unstructured data. If you want to perform an efficient vector similarity search, you can create a PostgreSQL vector database.

- [Create a PostgreSQL database on Choreo](./choreo-managed-postgresql-databases.md)

## MySQL on Choreo

MySQL is a user-friendly, flexible, open-source relational database management system with a well-established history in the SQL database realm. Choreo allows you to swiftly create fully Choreo-managed MySQL databases, enabling rapid setup and utilization.

- [Create a MySQL database on Choreo](./choreo-managed-mysql-databases.md)

## Choreo-Managed Cache

A fully-managed cache compatible with legacy Redis® OSS. A versatile, in-memory NoSQL database that serves as a cache, database, streaming engine, and message broker. Choreo-managed Cache allows you to have fully-managed instances that can be swiftly provisioned and integrated into your applications within minutes.

- [Create a Choreo-managed Cache](./choreo-managed-caches.md)

<span style="font-size: 11px; color:gray;">
 PostgreSQL, MySQL, and Redis® are trademarks and property of their respective owners. All product and service names used in this documentation are for identification purposes only. 
</span>


# Choreo-managed MySQL Databases

MySQL on Choreo offers fully managed, flexible relational databases on AWS, Azure, GCP, and Digital Ocean.

## Create a Choreo-managed MySQL database

Follow the steps below to create a Choreo-managed MySQL database: 

1. From the environment list on the header, located next to the **Deployment Tracks** list, select your **Organization**.
2. In the left navigation menu, click **Dependencies** and then **Databases**.
3. Click **Create** and select **MySQL** as the database type. Provide a display name for this server and follow the instructions.
4. Select your preferred cloud provider from AWS, Azure, GCP, and Digital Ocean.
  - Choreo uses the cloud provider to provision the compute and storage infrastructure for your database.
  - There is no functional difference between databases created on different cloud providers, apart from changes to service plans (and associated costs). 
5. Choose the region for your database.
  - Available regions will depend on the selected cloud provider. Choreo currently supports US and EU regions across all providers.
6. Select the service plan.
  - Service plans vary in the dedicated CPU, memory (RAM), storage space allocated for your database, the backup retention periods, and high-availability configurations for production use cases.

## Connect to your Choreo-managed MySQL database

To connect to your Choreo-managed MySQL database, consider the following guidelines:

- You can use any MySQL driver, ORM, or supported generic SQL library (may depend on the programming language) to connect to the database.
- You can find the connection parameters in the **Overview** section in the Choreo Console under the relevant database.
- MySQL databases accept traffic from the internet by default. You can restrict access to specific IP addresses and CIDR blocks under **Advanced Settings**.

## High Availability and Automatic Backups

The high availability characteristics and the automatic backup retention periods for Choreo-managed MySQL databases vary based on your service plan as explained below:

| Service Plan | High Availability                                                  | Backup Retention Time |
|--------------|--------------------------------------------------------------------|-----------------------|
| Hobbyist     | Single-node with limited availability                              | None                  |
| Startup      | Single-node with limited availability                              | 2 days                |
| Business     | Two-node (primary + standby) with higher availability              | 14 days               |
| Premium      | Three-node (primary + standby + standby) with highest availability | 30 days               |

In general, we recommend service plans for production scenarios for multiple reasons:
- Provides another physical copy of the data in case of hardware, software, or network failures.
- Typically reduces the data loss window in disaster scenarios.
- Provides a quicker time to restore with a controlled failover in case of failures, as the standby is already installed and running.

### Automatic Backups

- Choreo runs full backups daily to automatically back up Choreo-managed MySQL databases and record binary logs continuously.
Choreo encrypts all backups at rest.

- Choreo automatically handles outages and software failures by replacing broken nodes with new ones that resume correctly from the point of failure. The impact of a failure will depend on the number of available standby nodes in the database.

## Connection Limits

The maximum number of simultaneous connections to MySQL databases is fixed for each service plan and depends on how much RAM your service plan offers.

!!! note
    An `extra_connection` with a value of `1` is added for system processes for all MySQL databases, regardless of the service plan.

### For plans under 4 GiB RAM

For plans under 4 GiB of RAM, the number of allowed connections is `75` per GiB:

```
max_connections = 75 x RAM + extra_connection
```

### For plans with over 4 GiB RAM:

For plans with 4 GiB or more RAM, the number of allowed connections is `100` per GiB:

```
max_connections = 100 x RAM + extra_connection
```


# Choreo-Managed PostgreSQL Databases and Vector Databases

PostgreSQL on Choreo offers fully Choreo-managed, efficient object-relational databases on AWS, Azure, GCP, and Digital Ocean. Additionally, Choreo allows you to create fully-managed PostgreSQL vector databases if you want to perform efficient vector similarity search.

## Create a Choreo-managed PostgreSQL database

Follow the steps below to create a Choreo-managed PostgreSQL database: 

1. Sign in to the Choreo Console at [https://console.choreo.dev/](https://console.choreo.dev/).
2. In the header, click the **Organization** list. This opens the organization home page.
3. In the left navigation menu, click **Dependencies** and then **Databases**.
4. Click **Create** and select **PostgreSQL** as the database type. Provide a display name for this server and follow the instructions.
5. Select your preferred cloud provider from AWS, Azure, GCP, or Digital Ocean.
    - The cloud provider is used to provision the compute and storage infrastructure for your database.
    - There is no functional difference between databases created on different cloud providers, apart from changes to service plans (and associated costs). 
6. Choose the region for your database.
   - Available regions will depend on the selected cloud provider. Choreo currently supports US and EU regions across all providers.
7. Select the service plan.
   - Service plans vary in the dedicated CPU, memory (RAM), storage space allocated for your database, the backup retention periods, and high-availability configurations for production use cases.

## Create a Choreo-managed PostgreSQL vector database

Follow the steps below to create a Choreo-managed PostgreSQL vector database: 

1. Sign in to the Choreo Console at [https://console.choreo.dev/](https://console.choreo.dev/).
2. In the header, click the **Organization** list. This opens the organization home page.
3. In the left navigation menu, click **Dependencies** and then **Vector Databases**.
4. Follow steps 4 onwards in the [Create a Choreo-managed PostgreSQL database](#create-a-choreo-managed-postgresql-database) section.

## Connecting to your Choreo-managed PostgreSQL database

To connect to your Choreo-managed PostgreSQL database, consider the following guidelines:

- You can use any PostgreSQL driver, ORM, or supported generic SQL library (may depend on the programming language) to connect to the database.
- The connection parameters can be found in the **Overview** section in the Choreo Console under the relevant database.
- PostgreSQL databases accept traffic from the internet by default. You can restrict access to specific IP addresses and CIDR blocks under **Advanced Settings**.


## High Availability and Automatic Backups

The high availability characteristics and the automatic backup retention periods for Choreo-managed PostgreSQL databases vary based on the selected service plan as shown below.

| Service Plan | High Availability                                                  | Backup Retention Time |
|--------------|--------------------------------------------------------------------|-----------------------|
| Hobbyist     | Single-node with limited availability                              | None                  |
| Startup      | Single-node with limited availability                              | 2 days                |
| Business     | Two-node (primary + standby) with higher availability              | 14 days               |
| Premium      | Three-node (primary + standby + standby) with highest availability | 30 days               |

Service plans with standby nodes are generally recommended for production scenarios for multiple reasons:
- Provides another physical copy of the data in case of hardware, software, or network failures.
- Typically reduces the data loss window in disaster scenarios.
- Provides a quicker time to restore with a controlled failover in case of failures, as the standby is already installed and running.

### Automatic Backups


- Choreo runs full backups daily to automatically back up Choreo-managed PostgreSQL databases and copies the write-ahead logs (WAL)  at 5-minute intervals or for every new file generated.
Choreo encrypts all backups at rest.

- Choreo automatically handles outages and software failures by replacing broken nodes with new ones that resume correctly from the point of failure. The impact of a failure will depend on the number of available standby nodes in the database.

### Failure Recovery

- **Minor failures**: Choreo automatically handles minor failures such as service process crashes or temporary loss of network access in all plans without requiring significant changes to the service deployment. Choreo automatically restores the service to normal operation once Choreo automatically restarts the crashed process or when Choreo restores the network access.

- **Severe failures**: To handle severe failures such as losing a node entirely in case of hardware or severe software problems, requires more drastic recovery measures. The monitoring infrastructure automatically detects a failing node, both when the node starts reporting issues in the self-diagnostics or when it stops communicating. In such cases, the monitoring infrastructure automatically schedules a new replacement node to be created.
> - In the event of database failover, the Service URI of your service remains the same; only the IP address will change to point to the new primary node.
> - Hobbyist and Startup plan provide a single node, and in case of failure, a new node starts up, restores its state from the latest available backup, and resumes serving traffic.
In this plan, as there is just a single node providing the service, the service will become unavailable for the duration of the restoration. In addition, any write operations made since the backup of the latest WAL file will be lost. Typically, this time window is limited to either five minutes of time or one WAL file.

## Connection limits

The following connection limits apply to Choreo-managed PostgreSQL databases based on the selected service plan.

| Service Plan               | Max Connections |
|----------------------------|-----------------|
| Hobbyist                   | 25              |
| Startup/Business/Premium-4 | 100             |
| Business-16                | 400             |
| Premium-8                  | 200             |


 # Add Choreo-Managed Databases and Caches to the Marketplace

When you create a Choreo-managed database or cache, you can add it to the Marketplace, making it available for consumption through a connection.

!!! note 
     To add a Choreo-managed database or cache to the Marketplace, you must import at least one credential for it.

## Step 1: Import credentials

To import credentials, you can either use the default super admin credentials or the credentials you create using the super admin credentials. When you create a database or cache server, super admin credentials are generated by default. You can use these super admin credentials to create new user credentials. The steps to create new user credentials depend on the type of database or cache you are using.

You can use the imported credentials to create a connection. During connection setup, you must select credentials for each database from the list of available credentials.

To import credentials for a database, follow these steps:

1. Sign in to the [Choreo Console](https://console.choreo.dev/).
2. Go to the Choreo Console header and select your organization from the **Organization** list.
3. In the left navigation menu, click **Dependencies** and then click **Databases**.
4. Click on a required database to view its details.
5. Click the **Databases** tab.
6. Click to expand the database for which you want to import credentials, then click **Import Credentials**.
7. In the **Import Credentials** dialog, do one of the following depending on your requirements:

    - Select **Use Created Credentials** and specify the following:
         - A display name for the credentials.
         - The database credentials you created to use when setting up database connections in Choreo. 
         - The environment where you want to use the credentials. 
         
         The steps to create new user credentials depend on the type of database or cache you are using. In general, you must log in to your database server as the super admin using a command-line interface or a database management tool. Then, create new database users with the required permission levels.

    - Select **Use Super Admin Credentials** and specify the following:
         - A display name for the credentials. 
         - The environment where you want to use the credentials.

8. Click **Save**.

!!! tip 
     Choreo allows you to delete imported credentials to prevent their use when establishing new connections. However, deleting credentials will not affect any existing database connections that are already using them.

## Step 2: Add the database or cache to the Marketplace

- On the **Databases** tab, click **+Add to Marketplace** corresponding to the database you want to add. 

Once the database is added to the Marketplace, it can be consumed via a connection. For details on creating a connection to a Choreo-managed database, see [Create a connection to a database](../develop-components/sharing-and-reusing/create-a-connection.md).

!!! note 
     To remove a database or cache that you added to the Marketplace, click the corresponding **Remove from Marketplace**. This action prevents new connections to the removed database, but existing connections remain unaffected.

For details on using a database connection in your component, see [Use a Database Connection in Your Component](../develop-components/sharing-and-reusing/use-a-database-connection-in-your-component.md).


# Choreo-Managed Cache

Fully compatible with legacy Redis® OSS.

Choreo-Managed Cache provides fully-managed in-memory NoSQL databases on AWS, Azure, GCP, and Digital Ocean and can be used as a cache, database, streaming engine, or message broker.

## Create a Choreo-Managed Cache

Follow the steps below to create a Choreo-Managed Cache:

1. Sign in to the Choreo Console at [https://console.choreo.dev/](https://console.choreo.dev).
2. In the header, click the **Organization** list. This opens the organization home page.
3. In the left navigation menu, click **Dependencies** and then click **Databases**.
4. Click **+ Create** and select **Choreo-Managed Cache** as the data store type. Provide a display name for this server and follow the instructions.
5. Select a preferred cloud provider (AWS, Azure, GCP, or Digital Ocean).
    - The cloud provider provisions the compute and storage infrastructure for your data store.
    - The functionality remains the same across cloud providers, though service plans and costs may differ.
6. Select a region for your data store.
    - Available regions depend on the selected cloud provider. Choreo currently supports US and EU regions across all providers.
7. Select a service plan.
    - Service plans vary in terms of dedicated CPU, memory (RAM), and storage space allocated for your data store, as well as high-availability configurations for production use cases.
8. Click **Create**.

## Connect to your Choreo-Managed Cache

To connect to your Choreo-Managed Cache, follow these guidelines:

- Use any legacy Redis® OSS compatible driver (in any programming language) to connect to your Choreo-Managed Cache.
- You can find the connection parameters in the **Overview** section in the Choreo Console under the relevant database. Note that Choreo-Managed Cache enforces TLS.
- Choreo-Managed Cache instances accept traffic from the internet by default. You can restrict access to specific IP addresses and CIDR blocks under **Advanced Settings**.

## High availability and automatic backups

The high availability and the automatic backup retention periods for a Choreo-Managed Cache can vary as follows depending on the service plan you select. 

| Service plan | High availability                                                                                                  | Backup features                          | Backup history |
| ------------ | -------------------------------------------------------------------------------------------------------------------| ---------------------------------------- | -------------- |
| Hobbyist     | Single-node with limited availability.                                                                             | Single backup only for disaster recovery | None           |
| Startup      | Single-node with limited availability.                                                                             | Single backup only for disaster recovery | 1 day          |
| Business     | Two-node (primary + standby) with higher availability (automatic failover if the primary node fails).              | Automatic backups                        | 3 days         |
| Premium      | Three-node (primary + standby + standby) with highest availability (automatic failover if the primary node fails). | Automatic backups                        | 13 days        |

In general, service plans are recommended for production scenarios due to the following reasons:

- Provides another physical copy of the data in case of hardware, software, or network failures.
- Reduces the data loss window in disaster scenarios.
- Ensures quicker restoration with controlled failover in case of failures, as the standby is already installed and running.

### Automatic backups

- Choreo runs full backups daily to automatically backup Choreo-Managed Caches and has write-ahead logs (WAL) copied at 5-minute intervals or for every new file generated.
- Choreo encrypts all backups at rest.
- Choreo automatically handles outages and software failures by replacing broken nodes with new ones that resume correctly from the point of failure. The impact of a failure will depend on the number of available standby nodes in the data store.

### Failure recovery

- **Minor failures**: Choreo automatically handles minor failures such as service process crashes or temporary loss of network access in all plans without requiring significant changes to the service deployment. Choreo automatically restores the service to normal operation once it automatically restarts the crashed process or when it restores the network access.

- **Severe failures**: Failures such as losing a node entirely in case of hardware or severe software problems, require more drastic recovery measures. The monitoring infrastructure automatically detects a failing node when the node starts reporting issues in the self-diagnostics or when it stops communicating. In such cases, the monitoring infrastructure automatically schedules a new replacement node to be created.
     - In the event of a data store failover, the service URI of your service remains the same; only the IP address will change to point to the new primary node.
     - Hobbyist and Startup plans provide a single node, and in case of failure, a new node starts up, restores its state from the latest available backup, and resumes serving traffic.
     - As there is just a single/primary node, the caching service becomes unavailable for the duration of the restoration operation. Therefore, all write operations made since the last backup will be lost.

## Limitations

### Connection limits

The number of simultaneous connections in a Choreo-Managed Cache depends on the total available memory on the server instances.

You can use the following to estimate:

```
max_number_of_connections = 4 x m
```

Here, `m` represents the memory in megabytes, where at least 10,000 connections are available, even on the smallest servers.
For example, on a server with 4GB memory (4,096 MB), the simultaneous connections are:

```
4 x 4096 = 16384 // 16k connections
```

This number is estimated by the exact available memory so it can vary between different plans and cloud providers. To see the exact maximum connections allowed, use the \* redis-cli and info command as follows:

```
echo "info" | redis-cli -u REDIS_URI | grep maxclients
```

### Restricted commands

To maintain the stability and security of a managed environment, Choreo restricts certain commands on Choreo-Managed Cache services.

!!! note "Support for Lua scripts on Choreo-Managed Cache"
     - Choreo-Managed Cache has built-in support for running Lua scripts to perform various actions directly on the server. Scripting is typically controlled using the `EVAL`, `EVALSHA`, and `SCRIPT LOAD` commands.
     - For all newly-created cache instances, `EVAL`, `EVALSHA`, and `SCRIPT LOAD` commands are enabled by default.

The following commands are disabled on Choreo:

- `bgrewriteaof`: Initiates a background append-only file rewrite.
- `cluster`: Manages Caching cluster commands.
- `command`: Provides details about all Caching commands.
- `debug`: Contains sub-commands for debugging Caching.
- `failover`: Manages manual failover of a master to a replica.
- `migrate`: Atomically transfers a key from one caching instance to another.
- `role`: Returns the role of the instance in the context of replication.
- `slaveof`: Makes the server a replica of another instance, or promotes it as master.
- `acl`: Manages caching access control lists.
- `bgsave`: Creates a snapshot of the data set into a dump file.
- `config`: Alters the configuration of a running caching server.
- `lastsave`: Returns the UNIX timestamp of the last successful save to disk.
- `monitor`: Streams back every command processed by the Caching server.
- `replicaof`: Makes the server a replica of another instance.
- `save`: Synchronously saves the dataset to disk.
- `shutdown`: Synchronously saves the dataset to disk and then shuts down the server.

The following `eval` commands are also disabled:

- `eval`: Executes a Lua script server-side.
- `eval_ro`: Read-only variant of the eval command.
- `evalsha`: Executes a script cached on the server side by its SHA1 digest.
- `evalsha_ro`: Read-only variant of the evalsha command.
- `fcall`: Calls a Caching function.
- `fcall_ro`: Read-only variant of the fcall command.
- `function`: Manages Caching functions.
- `script`: Manages the script cache.


# Choreo-Managed Databases, Vector Databases, and Caches

Choreo allows you to create PostgreSQL and MySQL databases as well as Choreo-Managed Cache instances on all major cloud providers (AWS, Azure, GCP, and DigitalOcean) as fully Choreo-managed platform services.
These databases and caches can be seamlessly provisioned to offer persistence and caching capabilities for all your Choreo components. Choreo provides various service plans for each type, ranging from smaller instances for development purposes to production-grade databases with automatic backups and high-availability multi-nodes.

!!! info "Note"
     - The capability to create Choreo-managed databases, vector databases, and cache services is available only for paid Choreo users.
     - Billing for these services will be included in your Choreo subscription, with pricing varying based on the service plan of the resources you create. For more details, see [Choreo Platform Services Billing](../references/choreo-platform-services-billing-and-upgrades.md#platform-service-billing-information).

!!!Tip "Explore the free trial"
    Choreo provides a 7-day free trial for all database types on the 'Hobbyist' service plan, available to free-tier users.

## PostgreSQL on Choreo

PostgreSQL (also known as Postgres), is an open-source object-relational database management system. You can create PostgreSQL databases on Choreo as fully Choreo-managed, flexible SQL databases that are ideal for both structured and unstructured data. If you want to perform an efficient vector similarity search, you can create a PostgreSQL vector database.

- [Create a PostgreSQL database on Choreo](./choreo-managed-postgresql-databases.md)

## MySQL on Choreo

MySQL is a user-friendly, flexible, open-source relational database management system with a well-established history in the SQL database realm. Choreo allows you to swiftly create fully Choreo-managed MySQL databases, enabling rapid setup and utilization.

- [Create a MySQL database on Choreo](./choreo-managed-mysql-databases.md)

## Choreo-Managed Cache

A fully-managed cache compatible with legacy Redis® OSS. A versatile, in-memory NoSQL database that serves as a cache, database, streaming engine, and message broker. Choreo-managed Cache allows you to have fully-managed instances that can be swiftly provisioned and integrated into your applications within minutes.

- [Create a Choreo-managed Cache](./choreo-managed-caches.md)

<span style="font-size: 11px; color:gray;">
 PostgreSQL, MySQL, and Redis® are trademarks and property of their respective owners. All product and service names used in this documentation are for identification purposes only. 
</span>


# Choreo-managed MySQL Databases

MySQL on Choreo offers fully managed, flexible relational databases on AWS, Azure, GCP, and Digital Ocean.

## Create a Choreo-managed MySQL database

Follow the steps below to create a Choreo-managed MySQL database: 

1. From the environment list on the header, located next to the **Deployment Tracks** list, select your **Organization**.
2. In the left navigation menu, click **Dependencies** and then **Databases**.
3. Click **Create** and select **MySQL** as the database type. Provide a display name for this server and follow the instructions.
4. Select your preferred cloud provider from AWS, Azure, GCP, and Digital Ocean.
  - Choreo uses the cloud provider to provision the compute and storage infrastructure for your database.
  - There is no functional difference between databases created on different cloud providers, apart from changes to service plans (and associated costs). 
5. Choose the region for your database.
  - Available regions will depend on the selected cloud provider. Choreo currently supports US and EU regions across all providers.
6. Select the service plan.
  - Service plans vary in the dedicated CPU, memory (RAM), storage space allocated for your database, the backup retention periods, and high-availability configurations for production use cases.

## Connect to your Choreo-managed MySQL database

To connect to your Choreo-managed MySQL database, consider the following guidelines:

- You can use any MySQL driver, ORM, or supported generic SQL library (may depend on the programming language) to connect to the database.
- You can find the connection parameters in the **Overview** section in the Choreo Console under the relevant database.
- MySQL databases accept traffic from the internet by default. You can restrict access to specific IP addresses and CIDR blocks under **Advanced Settings**.

## High Availability and Automatic Backups

The high availability characteristics and the automatic backup retention periods for Choreo-managed MySQL databases vary based on your service plan as explained below:

| Service Plan | High Availability                                                  | Backup Retention Time |
|--------------|--------------------------------------------------------------------|-----------------------|
| Hobbyist     | Single-node with limited availability                              | None                  |
| Startup      | Single-node with limited availability                              | 2 days                |
| Business     | Two-node (primary + standby) with higher availability              | 14 days               |
| Premium      | Three-node (primary + standby + standby) with highest availability | 30 days               |

In general, we recommend service plans for production scenarios for multiple reasons:
- Provides another physical copy of the data in case of hardware, software, or network failures.
- Typically reduces the data loss window in disaster scenarios.
- Provides a quicker time to restore with a controlled failover in case of failures, as the standby is already installed and running.

### Automatic Backups

- Choreo runs full backups daily to automatically back up Choreo-managed MySQL databases and record binary logs continuously.
Choreo encrypts all backups at rest.

- Choreo automatically handles outages and software failures by replacing broken nodes with new ones that resume correctly from the point of failure. The impact of a failure will depend on the number of available standby nodes in the database.

## Connection Limits

The maximum number of simultaneous connections to MySQL databases is fixed for each service plan and depends on how much RAM your service plan offers.

!!! note
    An `extra_connection` with a value of `1` is added for system processes for all MySQL databases, regardless of the service plan.

### For plans under 4 GiB RAM

For plans under 4 GiB of RAM, the number of allowed connections is `75` per GiB:

```
max_connections = 75 x RAM + extra_connection
```

### For plans with over 4 GiB RAM:

For plans with 4 GiB or more RAM, the number of allowed connections is `100` per GiB:

```
max_connections = 100 x RAM + extra_connection
```


# Choreo-Managed PostgreSQL Databases and Vector Databases

PostgreSQL on Choreo offers fully Choreo-managed, efficient object-relational databases on AWS, Azure, GCP, and Digital Ocean. Additionally, Choreo allows you to create fully-managed PostgreSQL vector databases if you want to perform efficient vector similarity search.

## Create a Choreo-managed PostgreSQL database

Follow the steps below to create a Choreo-managed PostgreSQL database: 

1. Sign in to the Choreo Console at [https://console.choreo.dev/](https://console.choreo.dev/).
2. In the header, click the **Organization** list. This opens the organization home page.
3. In the left navigation menu, click **Dependencies** and then **Databases**.
4. Click **Create** and select **PostgreSQL** as the database type. Provide a display name for this server and follow the instructions.
5. Select your preferred cloud provider from AWS, Azure, GCP, or Digital Ocean.
    - The cloud provider is used to provision the compute and storage infrastructure for your database.
    - There is no functional difference between databases created on different cloud providers, apart from changes to service plans (and associated costs). 
6. Choose the region for your database.
   - Available regions will depend on the selected cloud provider. Choreo currently supports US and EU regions across all providers.
7. Select the service plan.
   - Service plans vary in the dedicated CPU, memory (RAM), storage space allocated for your database, the backup retention periods, and high-availability configurations for production use cases.

## Create a Choreo-managed PostgreSQL vector database

Follow the steps below to create a Choreo-managed PostgreSQL vector database: 

1. Sign in to the Choreo Console at [https://console.choreo.dev/](https://console.choreo.dev/).
2. In the header, click the **Organization** list. This opens the organization home page.
3. In the left navigation menu, click **Dependencies** and then **Vector Databases**.
4. Follow steps 4 onwards in the [Create a Choreo-managed PostgreSQL database](#create-a-choreo-managed-postgresql-database) section.

## Connecting to your Choreo-managed PostgreSQL database

To connect to your Choreo-managed PostgreSQL database, consider the following guidelines:

- You can use any PostgreSQL driver, ORM, or supported generic SQL library (may depend on the programming language) to connect to the database.
- The connection parameters can be found in the **Overview** section in the Choreo Console under the relevant database.
- PostgreSQL databases accept traffic from the internet by default. You can restrict access to specific IP addresses and CIDR blocks under **Advanced Settings**.


## High Availability and Automatic Backups

The high availability characteristics and the automatic backup retention periods for Choreo-managed PostgreSQL databases vary based on the selected service plan as shown below.

| Service Plan | High Availability                                                  | Backup Retention Time |
|--------------|--------------------------------------------------------------------|-----------------------|
| Hobbyist     | Single-node with limited availability                              | None                  |
| Startup      | Single-node with limited availability                              | 2 days                |
| Business     | Two-node (primary + standby) with higher availability              | 14 days               |
| Premium      | Three-node (primary + standby + standby) with highest availability | 30 days               |

Service plans with standby nodes are generally recommended for production scenarios for multiple reasons:
- Provides another physical copy of the data in case of hardware, software, or network failures.
- Typically reduces the data loss window in disaster scenarios.
- Provides a quicker time to restore with a controlled failover in case of failures, as the standby is already installed and running.

### Automatic Backups


- Choreo runs full backups daily to automatically back up Choreo-managed PostgreSQL databases and copies the write-ahead logs (WAL)  at 5-minute intervals or for every new file generated.
Choreo encrypts all backups at rest.

- Choreo automatically handles outages and software failures by replacing broken nodes with new ones that resume correctly from the point of failure. The impact of a failure will depend on the number of available standby nodes in the database.

### Failure Recovery

- **Minor failures**: Choreo automatically handles minor failures such as service process crashes or temporary loss of network access in all plans without requiring significant changes to the service deployment. Choreo automatically restores the service to normal operation once Choreo automatically restarts the crashed process or when Choreo restores the network access.

- **Severe failures**: To handle severe failures such as losing a node entirely in case of hardware or severe software problems, requires more drastic recovery measures. The monitoring infrastructure automatically detects a failing node, both when the node starts reporting issues in the self-diagnostics or when it stops communicating. In such cases, the monitoring infrastructure automatically schedules a new replacement node to be created.
> - In the event of database failover, the Service URI of your service remains the same; only the IP address will change to point to the new primary node.
> - Hobbyist and Startup plan provide a single node, and in case of failure, a new node starts up, restores its state from the latest available backup, and resumes serving traffic.
In this plan, as there is just a single node providing the service, the service will become unavailable for the duration of the restoration. In addition, any write operations made since the backup of the latest WAL file will be lost. Typically, this time window is limited to either five minutes of time or one WAL file.

## Connection limits

The following connection limits apply to Choreo-managed PostgreSQL databases based on the selected service plan.

| Service Plan               | Max Connections |
|----------------------------|-----------------|
| Hobbyist                   | 25              |
| Startup/Business/Premium-4 | 100             |
| Business-16                | 400             |
| Premium-8                  | 200             |












